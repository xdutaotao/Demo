TradeDAO_001=select GatherBid,BidStartTime,BidEndTime,sectionID,Name,StartTime,EndTime,ModifyTime, status ,case when status in(0,1) then case when status=1 then '\u6b63\u5e38' when status=0 then '\u65e0\u6548' else '' end else '' end as status from [HJOnline].[dbo].T_A_TradeTime
TradeDAO_002=select t.* from T_A_TradeTime t where t.sectionid = \u003f
TradeDAO_003=insert into T_A_TradeTime (SectionID,Name,StartTime,EndTime,Status,ModifyTime,GatherBid,BidStartTime,BidEndTime) values (\u003f,\u003f,\u003f,\u003f,\u003f,sysdate,\u003f,\u003f,\u003f)
TradeDAO_004=insert into T_A_DaySection (WeekDay,SectionID,Status,ModifyTime) values (\u003f,\u003f,0,sysdate)
TradeDAO_005=update T_A_TradeTime set Name=\u003f,StartTime=\u003f,EndTime=\u003f,Status=\u003f,ModifyTime=sysdate,GatherBid=\u003f,BidStartTime=\u003f,BidEndTime=\u003f where SectionID = \u003f
TradeDAO_006=select b.breedid,b.breedname,c.CommodityID,c.name from T_A_TradeTime tt,T_A_Breed b, T_A_CommodityTradeProp ctp, T_Commodity c where tt.sectionid = ctp.sectionid and tt.sectionid = \u003f and ctp.CommodityID = c.CommodityID and c.breedid = b.breedid
TradeDAO_007=select b.breedid,b.breedname from T_A_TradeTime tt,T_A_Breed b, T_A_BreedTradeProp btp where tt.sectionid = btp.sectionid and tt.sectionid = \u003f and b.breedid = btp.breedid
TradeDAO_008=delete from T_A_TradeTime where sectionID=\u003f
TradeDAO_009=delete from T_A_DaySection where SectionID = \u003f
TradeDAO_010=select to_char(sysdate,'hh24:mi:ss') sysdata from dual
TradeDAO_011=select max(t.sectionid) as id from t_a_Tradetime t where t.sectionid < 
MarketDAO_001=select TradeTmptId from T_A_Market
MarketDAO_002=select count(*) from T_A_Market
StatQueryDAO_001=select * from T_SystemStatus
FirmBanlanceDAO_001=  select t1.*,t2.id as ID,t2.Firmid as FIRMIDFROMS,t2.Balance as BALANCEFROMS,t2.Frozenfunds as FROZENFUNDSFROMS,t2.LastBalance as LASTBALANCEFROMS,t2.CreditDate as CREDITDATEFROMS,t4.id as preSaleID,t4.Firmid as preSaleFIRMIDFROMS,t4.Balance as preSaleBALANCEFROMS,t4.Frozenfunds as preSaleFROZENFUNDSFROMS,t4.LastBalance as preSaleLASTBALANCEFROMS, t4.CreditDate as preSaleCREDITDATEFROMS,t3.FirmName as FIRMNAME  from F_FirmFunds t1 left join S_FIRMFUNDS t2 on   t1.FIRMID = t2.FIRMID left join C_FIRM t3 on t1.FIRMID = t3.FIRMID left join S_PreSale_FirmFunds t4 on t4.FIRMID = t1.FIRMID where 1=1
FirmBanlanceDAO_002=select * from dual
FirmBanlanceDAO_003=select *  from (select z.*,f_balance - l_balance - y_balance balanceSubtract,f_balance + FrozenFunds user_balance from (select f.firmid,(select name from m_firm where firmId = f.firmId) name,f.balance f_balance,nvl(tFirm.Runtimefl,0) Runtimefl,nvl(tFirm.Clearfl,0) Clearfl,nvl(h.todaybalance, 0) l_balance,nvl(e.y_balance, 0) y_balance,nvl(f.lastwarranty, 0) lastwarranty,nvl(-1 * FrozenFunds, 0) FrozenFunds from F_FirmFunds f,t_firm tFirm,(select h1.firmid, h1.todaybalance from f_firmbalance h1 where h1.b_date = (select nvl(max(b_date),to_date('2009-01-01', 'yyyy-MM-dd')) from f_firmbalance)) h,(select d.firmid,0 + nvl(b.c_balance, 0) - nvl(c.d_balance, 0) y_balance from F_FirmFunds d,(select a.firmid, sum(a.amount) c_balance from f_fundflow a where a.oprcode in (select t.summaryno from f_summary t where t.funddcflag = 'C') group by firmid) b,(select a.firmid, sum(a.amount) d_balance from f_fundflow a where a.oprcode in (select t.summaryno from f_summary t  where t.funddcflag = 'D') group by firmid) c where d.firmid = b.firmid(+) and d.firmid = c.firmid(+)) e where f.firmid = h.firmid(+)   and f.firmid = e.firmid(+) and f.firmid = tFirm.firmid(+)) z) t1  where 1 = 1 
FirmBanlanceDAO_004=select FundFlowID,FirmID,(select Summary from F_Summary where SummaryNo=OprCode) OprCode,ContractNo,CommodityID,Amount,Balance,AppendAmount,VoucherNo,CreateTime,B_Date from F_H_FundFlow where 1=1
FirmBanlanceDAO_005=SELECT t1.*, template.TradeType FROM T_Leads t1 LEFT JOIN T_TradeTemplate template ON t1.tradeTmptId \= template.tradeTmptId WHERE id = \u003f
FirmBanlanceDAO_006=select * from T_Enquiry where EnquiryId = \u003f
FirmBanlanceDAO_007=select * from T_Order where OrderId = \u003f
FirmBanlanceDAO_015=select * from T_Delivery where DeliveryID = \u003f
FirmBanlanceDAO_008={call Proc_SP_FundForLeads_New(\u003f,\u003f,\u003f)}
FirmBanlanceDAO_009={call Proc_SP_FundForEnquiry_New(\u003f,\u003f,\u003f)}
FirmBanlanceDAO_010={call Proc_SP_FundForOrderDirect_New(\u003f,\u003f,\u003f)}
FirmBanlanceDAO_011={call Proc_SP_FundForOrderEnquiry_New(\u003f,?,?)}
FirmBanlanceDAO_012={call Proc_SP_FundForOrderSellProc_New(\u003f)}
FirmBanlanceDAO_013={call Proc_SP_CancleLeadsForRefund(\u003f)}
FirmBanlanceDAO_014={call Proc_SP_CancleEnquiryForRefund(\u003f)}
FirmBanlanceDAO_016={call Proc_SP_DeliverySellerForFunds(\u003f)}
FirmBanlanceDAO_017={call Proc_SP_PaymentBuyer(?,\u003f,\u003f,?)}
FirmBanlanceDAO_018={call Proc_SP_DeliveryBuyerForFunds_New(\u003f,\u003f)}
FirmBanlanceDAO_019=update T_Leads set REC_MODIFYBY = \u003f , REC_MODIFYTIME  = \u003f  , LeadsStatus =1 where LeadsStatus = 0
FirmBanlanceDAO_020=update T_Enquiry set REC_MODIFYBY = \u003f , REC_MODIFYTIME  = \u003f  , EnquiryStatus =0 where EnquiryStatus = 1
FirmBanlanceDAO_021=select * from T_Leads lead join T_TradeTemplate tt on tt.TradeTmptId = lead.TradeTmptId and (tt.TradeType = 0 or tt.TradeType = 1) where LeadsStatus = 0
FirmBanlanceDAO_022=select * from T_Enquiry enq join T_Leads lead on lead.id = enq.LeadsID join T_TradeTemplate tt on tt.TradeTmptId = lead.TradeTmptId and (tt.TradeType = 0 or tt.TradeType = 1)  where EnquiryStatus = 1
FirmBanlanceDAO_023={call Proc_SP_ModifyLeads(?,?,?)}
FirmBanlanceDAO_024={call Proc_SP_Advance_AddDepositSeller(?,?,?,?)}
FirmBanlanceDAO_025=SELECT t1.*, t2.DeliveryID, t3.GoodsType, t4.TradeType FROM T_CancelContractDetail t1, T_CancelContract t2, T_Order t3, T_TradeTemplate t4 WHERE t1.ApplyID \= ? AND t1.DISABLED \= 0 AND t2.DISABLED \= 0 AND t1.PayStatus \!\= 0 AND t2.KeyID \= t1.ApplyID AND t2.OrderID \= t3.OrderId AND t3.TradeTmptId \= t4.TradeTmptId
FirmBanlanceDAO_026=UPDATE T_CancelContractDetail SET REC_MODIFYBY \= ?, REC_MODIFYTIME \= GETDATE(), PayStatus \= 0, ReceivedAmount \= ReceivableAmount, ReceivedFreight \= ReceivableFreight, ReceivedTradeFee \= ReceivableTradeFee, ReceivedTradeFeeFunds \= ReceivableTradeFeeFunds, ReceivedTradeFeeCredit \= ReceivableTradeFeeCredit, ReceivedTradeFeeAccountFunds \= ReceivableTradeFeeAccountFunds, PaidAmount \= PayAmount, PaidFreight \= PayFreight, PaidTradeFee \= PayTradeFee, PaidTradeFeeFunds \= PayTradeFeeFunds, PaidTradeFeeCredit \= PayTradeFeeCredit, PaidTradeFeeAccountFunds \= PayTradeFeeAccountFunds, PaidTradeDeposit \= PayTradeDeposit, PaidTradeDepositCredit \= PayTradeDepositCredit, PaidTradeDepositFunds \= PayTradeDepositFunds WHERE KeyID \= ?
FirmBanlanceDAO_027=UPDATE T_CancelContractDetail SET REC_MODIFYBY \= ?, REC_MODIFYTIME \= GETDATE(), PayStatus \= 5, ReceivedAmount \= ReceivableAmount, ReceivedFreight \= ReceivableFreight, ReceivedTradeFee \= ReceivedTradeFee + ReceivableTradeFeeFunds - ReceivedTradeFeeFunds, ReceivedTradeFeeFunds \= ReceivableTradeFeeFunds, PaidAmount \= PayAmount, PaidFreight \= PayFreight, PaidTradeFee \= PaidTradeFee + PayTradeFeeFunds - PaidTradeFeeFunds, PaidTradeFeeFunds \= PayTradeFeeFunds, PaidTradeDeposit \= PaidTradeDeposit + PayTradeDepositFunds - PaidTradeDepositFunds, PaidTradeDepositFunds \= PayTradeDepositFunds WHERE KeyID \= ?
FirmBanlanceDAO_028=UPDATE T_CancelContractDetail SET REC_MODIFYBY \= ?, REC_MODIFYTIME \= GETDATE(), PayStatus \= 5 WHERE KeyID \= ?
#liner select
FirmBanlanceDAO_029=select enq.* from T_Enquiry enq join T_EnquiryExpand_Liner line on line.EnquiryId = enq.EnquiryId where enq.EnquiryStatus = 8 and enq.EnquiryId = \u003f
FirmBanlanceDAO_030=select enq.* from T_Enquiry enq join T_EnquiryExpand_Liner line on line.EnquiryId = enq.EnquiryId where (enq.EnquiryStatus = 1 or enq.EnquiryStatus = 8) and DATEDIFF(MINUTE,line.LinerEffectTIME,getDate()) >= 0
FirmBanlanceDAO_031=select lead.* from T_Leads lead join T_LeadsExpand_Liner line on line.LeadsID = lead.ID where lead.Quantity > 0 and lead.LeadsStatus = 0 and lead.ID = \u003f
FirmBanlanceDAO_032=select lead.* from T_Leads lead join T_LeadsExpand_Liner line on line.LeadsID = lead.ID where lead.LeadsStatus = 0 and DATEDIFF(MINUTE,line.LinerEffectTIME,getDate()) >= 0
#liner pre update
FirmBanlanceDAO_033=update enq set enq.EnquiryStatus=-1 from T_Enquiry enq join T_EnquiryExpand_Liner line on line.EnquiryId = enq.EnquiryId where enq.EnquiryStatus = 8 and enq.EnquiryId = \u003f
FirmBanlanceDAO_034=update enq set enq.EnquiryStatus=-1 from T_Enquiry enq join T_EnquiryExpand_Liner line on line.EnquiryId = enq.EnquiryId where (enq.EnquiryStatus = 1 or enq.EnquiryStatus = 8) and DATEDIFF(MINUTE,line.LinerEffectTIME,getDate()) >= 0
FirmBanlanceDAO_035=update lead set lead.LeadsStatus=-1 from T_Leads lead join T_LeadsExpand_Liner line on line.LeadsID = lead.ID where lead.Quantity > 0 and lead.LeadsStatus = 0 and lead.ID = \u003f
FirmBanlanceDAO_036=update lead set lead.LeadsStatus=-1 from T_Leads lead join T_LeadsExpand_Liner line on line.LeadsID = lead.ID where lead.LeadsStatus = 0 and DATEDIFF(MINUTE,line.LinerEffectTIME,getDate()) >= 0
#liner post update
FirmBanlanceDAO_037=update enq set enq.EnquiryStatus=\u003f  from T_Enquiry enq join T_EnquiryExpand_Liner line on line.EnquiryId = enq.EnquiryId where enq.EnquiryStatus = -1 and enq.EnquiryId = \u003f
FirmBanlanceDAO_039=update lead set lead.LeadsStatus=\u003f from T_Leads lead join T_LeadsExpand_Liner line on line.LeadsID = lead.ID where lead.LeadsStatus = -1 and lead.ID = \u003f
#liner for sp
FirmBanlanceDAO_041={call Proc_SP_ReleaseEnquiry_LLDPE(\u003f)}
FirmBanlanceDAO_042={call Proc_SP_CancleLeadsForRefund_LLDPE(\u003f)}
FirmBanlanceDAO_043={call Proc_SP_ReleaseLeads_LLDPE(\u003f)}




SApplyDAO_001=select t1.*,       t2.Name     as applyerName,       t3.Name     as approverName,       t4.firmName as firmName  from S_APPLY t1  left join M_User t2    on t1.Applyer = t2.UserID  left join M_User t3    on t1.Approver = t3.UserID  left join C_Firm t4    on t1.FirmID = t4.FirmID where 1 = 1
SApplyDAO_002=insert into S_APPLY (ID,ApplyType,FirmID,Amount,Applyer,ApplyTime,Note,DiffType) values (next value for dbo.seq_s_apply,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
SApplyDAO_003=update S_APPLY set Status = \u003f  where ID = \u003f
SApplyDAO_004=select t1.*,t2.firmName as firmName  from S_FIRMFUNDS t1  left join C_Firm t2    on t1.FirmID = t2.FirmID where 1 = 1
SApplyDAO_005=select * from S_FIRMFUNDS where FirmID = \u003f
SApplyDAO_006=insert into S_FUNDFLOW (FundFlowID,FirmID,OperCode,Amount,Balance,Createtime,ObjectID,FlowType) values (next value for dbo.seq_S_FundFlow,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
SApplyDAO_007=update s_firmfunds set Balance = Balance + \u003f, LastBalance = LastBalance + \u003f, CreditDate =\u003f where FirmID = \u003f
SApplyDAO_010=update s_firmfunds set Balance = Balance + \u003f, Frozenfunds= Frozenfunds - \u003f where FirmID = \u003f
SApplyDAO_008=select * from S_APPLY where id = \u003f
SApplyDAO_009=update S_APPLY set  Approver = \u003f, ApproveTime=\u003f where ID = \u003f
SApplyDAO_011=select t1.*, t2.FirmName as firmName,t3.SUMMARY as operName, t3.FUNDDCFLAG from S_FUNDFLOW  t1 left join c_firm t2 on t1.FirmID = t2.FirmID left join F_Summary t3 on t1.OperCode = t3.SUMMARYNO where 1=1
SApplyDAO_012=select * from ( select preSaleFundFlow.FirmID,       preSaleFundFlow.FundFlowID,       preSaleFundFlow.operCode,       preSaleFundFlow.amount,       '-'       as balance,       CONVERT (varchar, preSaleFundFlow.balance) as balanceS,       preSaleFundFlow.createtime,       preSaleFundFlow.objectID,       preSaleFundFlow.flowType,       t2.SUMMARY as operName,       t2.FUNDDCFLAG,       '\u9884\u552E\u6388\u4fe1\u989d\u5ea6'       as accountType from S_PreSale_FundFlow preSaleFundFlow      left join F_Summary t2 on preSaleFundFlow.OperCode = t2.SUMMARYNO union all select t1.FirmID,t1.FundFlowID, t1.operCode, t1.amount, '-' as balance, CONVERT(varchar,t1.balance) as balanceS, t1.createtime, t1.objectID, t1.flowType, t2.SUMMARY as operName, t2.FUNDDCFLAG, '\u73B0\u8D27\u6388\u4fe1\u989d\u5ea6' as accountType from S_FUNDFLOW t1 left join F_Summary t2 on t1.OperCode = t2.SUMMARYNO union all select t3.FirmID,t3.FundFlowID, t3.OPRCODE as operCode, t3.amount, CONVERT(varchar,t3.balance) as balance, '-' as balanceS, t3.createtime, t3.CONTRACTNO as objectID, '1' as flowType, t4.SUMMARY as operName, t4.FUNDDCFLAG, '\u8d44\u91d1\u8d26\u6237' as accountType from F_FUNDFLOW t3 left join F_Summary t4 on t3.OPRCODE = t4.SUMMARYNO) t21 where 1=1 
SApplyDAO_013=update S_APPLY set refuseReason = \u003f where ID = \u003f
SApplyDAO_014=insert into S_PreSale_FundFlow(FundFlowID,FirmID,OperCode,Amount,Balance,Createtime,ObjectID,FlowType) values(next value for dbo.seq_S_PreSale_FundFlow,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,\u003f)
SApplyDAO_015=update S_PreSale_FirmFunds set Balance=Balance+\u003f,LastBalance=LastBalance+\u003f,CreditDate=\u003f where FirmID=\u003f
SApplyDAO_016=select t1.*, t2.FirmName as firmName,t3.SUMMARY as operName, t3.FUNDDCFLAG from S_PreSale_FundFlow  t1 left join c_firm t2 on t1.FirmID = t2.FirmID left join F_Summary t3 on t1.OperCode = t3.SUMMARYNO where 1=1
SApplyDAO_017=select * from S_PreSale_FirmFunds where FirmID = \u003f
SApplyDAO_018=select t1.*,t2.firmName as firmName  from S_PreSale_FirmFunds t1  left join C_Firm t2    on t1.FirmID = t2.FirmID where 1 = 1
#\u4ea4\u6613\u5546\u76f8\u5173#
#FirmDAO_001=SELECT cfa.AppType as appType,cf.FirmID,cf.FirmRegId,cf.FirmName,cf.FullName,cf.FirmType,cf.BusinessType,cf.disabled,cf.FirmStatus,cf.Address,cf.Fax,cf.PostCode,cfd.SettingBankID,cfd.SettingBkBranch,cfd.SettingBkAccount,cfd.Note,cfd.BSEntityName,cfd.BSEntityTelNo,cfd.ContactName,cfd.ContactTelNo,cfd.ContactMobile,cfd.BSLicenseNo,cfd.RegisterCapital,cfd.BSLicense,cfd.TaxRegisterNo,cfd.TaxLicense,cfd.OrganizationCd,cfd.OrgCode,cfd.UnifyLicenseNo,cfd.UnifyLicense,cfd.DGLicenseNo,cfd.DGLicense,cfd.DGLicenseAuth,cfd.TaxNo,cfd.REC_CREATEBY,cfd.REC_CREATETIME,cfd.REC_MODIFYBY,cfd.REC_MODIFYTIME FROM C_Firm cf LEFT JOIN C_FirmDetail cfd ON cf.FirmID = cfd.FirmID LEFT JOIN C_FirmApp cfa ON cfa.FirmID = cf.FirmID where 1=1
#FirmDAO_001=SELECT cf.FirmID,cf.FirmRegId,cf.FirmName,cf.FullName,cf.FirmType,cf.BusinessType,cf.disabled,cf.FirmStatus,cf.Address,cf.Fax,cf.PostCode,cfd.SettingBankID,cfd.SettingBkBranch,cfd.SettingBkAccount,cfd.Note,cfd.BSEntityName,cfd.BSEntityTelNo,cfd.ContactName,cfd.ContactTelNo,cfd.ContactMobile,cfd.BSLicenseNo,cfd.RegisterCapital,cfd.BSLicense,cfd.TaxRegisterNo,cfd.TaxLicense,cfd.OrganizationCd,cfd.OrgCode,cfd.UnifyLicenseNo,cfd.UnifyLicense,cfd.DGLicenseNo,cfd.DGLicense,cfd.DGLicenseAuth,cfd.TaxNo,cfd.REC_CREATEBY,cfd.REC_CREATETIME,cfd.REC_MODIFYBY,cfd.REC_MODIFYTIME ,cad.AddPV AS vatPV,cad.AddCT AS vatCT,cad.AddDT AS vatDT,cad.Address AS vatAddRess,cad.DISABLED AS vatDisabled,cad.ContactName AS vatContactName,cad.ContactTelNo ASvatContactTelNo,vwb1.BankName as settingBankName,vwb2.BankName as vatBankName FROM C_Firm cf LEFT JOIN C_FirmDetail cfd ON cf.FirmID = cfd.FirmID LEFT JOIN C_FirmVATInfo cfv ON cfv.FirmID = cf.FirmID LEFT JOIN C_Address cad ON cad.ID = cfv.VatAddressID LEFT JOIN vw_Bank vwb1 ON vwb1.BankID = cfd.SettingBankID LEFT JOIN vw_Bank vwb2 ON vwb2.BankID = cfv.VatBankID where 1=1#
FirmDAO_001=SELECT * FROM(SELECT cfi.IsSignState, cfi.CustomerName,cfi.SignBankID,vwBank.BankName as signBankName,cfi.DGLicenseAuth as dGLicenseAuth,cfa.AppType as appType,cf.*,cf.REC_CREATEBY AS recCreateBy,cf.REC_MODIFYBY AS recModifyBy,cf.REC_CREATETIME AS recCreateTime,cf.REC_MODIFYTIME AS recModifyTime,vwc.TypeName AS businessTypeText,cfi.ContactName as contactName,dbo.base64_utf8decode(cfi.ContactMobile) as contactMobile,firmSetting1.ID as firmSettingId1,ISNULL(firmSetting1.SettingValue, 'N') as firmSettingValue1,ISNULL(firmSetting1.[DISABLED], -1) as firmSettingDisabled1,firmSetting2.ID as firmSettingId2,ISNULL(firmSetting2.SettingValue, 'N') as firmSettingValue2,ISNULL(firmSetting2.[DISABLED], -1) as firmSettingDisabled2,firmSetting3.ID as firmSettingId3,ISNULL(firmSetting3.SettingValue, 'N') as firmSettingValue3,ISNULL(firmSetting3.[DISABLED], -1) as firmSettingDisabled3 FROM C_Firm cf LEFT JOIN vw_CompanyType vwc ON cf.BusinessType = vwc.ID INNER JOIN C_FirmDetail cfi on cfi.FirmID = cf.FirmID LEFT JOIN C_FirmApp cfa ON cfa.FirmID = cf.FirmID left join C_FirmSetting firmSetting1 on firmSetting1.FirmCode = cf.FirmID and firmSetting1.AppType = 1 and firmSetting1.SettingType = 1 left join C_FirmSetting firmSetting2 on firmSetting2.FirmCode = cf.FirmID and firmSetting2.AppType = 1   and firmSetting2.SettingType = 2 left join C_FirmSetting firmSetting3 on firmSetting3.FirmCode = cf.FirmID and firmSetting3.AppType = 1  and firmSetting3.SettingType = 3 left join HJOnline.dbo.F_Banks vwBank ON vwBank.BankID = cfi.SignBankID WHERE 1=1 AND cfa.AppType IS NULL OR cfa.AppType =1) temp where 1=1  
FirmDAO_002= SELECT cfd.IsSignState,cfd.CustomerName,cfd.SignBankID,vwBank.BankName as signBankName,ffunds.BALANCE as balance,cf.AddressPV,cf.AddressCT,cf.AddressDT,cf.FirmNamePY,cf.FirmID,cf.FirmRegId,cf.FirmName,cf.FullName,cf.FirmType,cf.BusinessType,cf.disabled,cf.FirmStatus,cf.Address,cf.Fax,cf.PostCode,ISNULL(cf.PayType,0) as payType,cf.IsAuthorized,cfd.LicenseDiffer,cfd.SettingBankID,vwb1.BankName as settingBankName,cfd.SettingBkBranch,dbo.base64_utf8decode(cfd.SettingBkAccount) as settingBkAccount,cfd.Note,cfd.BSEntityName,dbo.base64_utf8decode(cfd.BSEntityTelNo) as bSEntityTelNo,cfd.ContactName,dbo.base64_utf8decode(cfd.ContactTelNo) as contactTelNo,dbo.base64_utf8decode(cfd.ContactMobile) as contactMobile,cfd.BSLicenseNo,cfd.RegisterCapital as registerCapiTal,cfd.BSLicense,cfd.TaxRegisterNo,cfd.TaxLicense,cfd.OrganizationCd,cfd.OrgCode,cfd.UnifyLicenseNo,cfd.UnifyLicense,cfd.DGLicenseNo,cfd.DGLicense,cfd.DGLicenseAuth,cfd.TaxNo,cfd.REC_CREATEBY as recCreateBy,cfd.REC_CREATETIME as recCreateTime,cfd.REC_MODIFYBY as recModifyBy,cfd.REC_MODIFYTIME as recModifyTime,cfd.RegDate as regDate,cfd.SubscriptionAmount as subscriptionAmount,cfd.PaidInAmount as paidInAmount,cad.AddPV AS vatPV,cad.AddCT AS vatCT,cad.AddDT AS vatDT,cad.Address AS vatAddress,cad.DISABLED AS vatDisabled,cad.ContactName AS vatContactName,cad.ContactTelNo ASvatContactTelNo,vwb1.BankName as settingBankName,vwb2.BankName as vatBankName,cfv.VatBankID as vatBankID,vwb2.BankName as vatBankName,dbo.base64_utf8decode(cfv.VatBkAccount)as vatBkAccount,cfv.VatBkBranch as vatBkBranch,ISNULL(cf.IsBinding,0) as IsBinding,cfd.IsDanger as isDanger,cf.TradeAuthority as tradeAuthority,cfd.DGExpireDate  FROM C_Firm cf LEFT JOIN C_FirmDetail cfd ON cf.FirmID = cfd.FirmID LEFT JOIN C_FirmVATInfo cfv ON cfv.FirmID = cf.FirmID LEFT JOIN C_Address cad ON cad.ID = cfv.VatAddressID LEFT JOIN vw_Bank vwb1 ON vwb1.BankID = cfd.SettingBankID LEFT JOIN vw_Bank vwb2 ON vwb2.BankID = cfv.VatBankID LEFT JOIN F_FirmFunds ffunds ON ffunds.FIRMID = cf.FirmID left join HJOnline.dbo.F_Banks vwBank ON vwBank.BankID = cfd.SignBankID where cf.FirmID =\u003f
FirmDAO_003=UPDATE C_Firm SET FirmName = \u003f,FullName = \u003f,FirmType = \u003f,BusinessType = \u003f,Address = \u003f,Fax = \u003f,PostCode = \u003f,DISABLED =\u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME =  GETDATE(),AddressPV =\u003f,AddressCT=\u003f,AddressDT=\u003f ,FirmNamePY=\u003f ,IsBinding=\u003f,PayType=\u003f,TradeAuthority = \u003f,IsAuthorized=\u003f WHERE FirmID =\u003f
FirmDAO_004=UPDATE C_FirmDetail SET SettingBankID =\u003f,SettingBkBranch =\u003f,SettingBkAccount =dbo.base64_utf8encode(\u003f),Note =\u003f,BSEntityName =\u003f,BSEntityTelNo =dbo.base64_utf8encode(\u003f),ContactName =\u003f,ContactTelNo =dbo.base64_utf8encode(\u003f),ContactMobile =dbo.base64_utf8encode(\u003f),BSLicenseNo =\u003f,RegisterCapital =\u003f,BSLicense =\u003f,TaxRegisterNo =\u003f,TaxLicense=\u003f,OrganizationCd =\u003f,OrgCode =\u003f,UnifyLicenseNo =\u003f,UnifyLicense =\u003f,DGLicenseNo =\u003f,DGLicense =\u003f,DGLicenseAuth =\u003f,TaxNo =\u003f,REC_MODIFYBY =\u003f,REC_MODIFYTIME =  GETDATE(),LicenseDiffer=\u003f,IsDanger=\u003f,DGExpireDate = \u003f,CustomerName=\u003f  WHERE FirmID =\u003f
FirmDAO_005=INSERT INTO C_Firm (FirmID, FirmRegId,FirmName, FullName, FirmType, BusinessType, FirmStatus, Address, Fax, PostCode, DISABLED,REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME,FirmNamePY,AddressPV,AddressCT,AddressDT,IsBinding,PayType,TradeAuthority,IsAuthorized) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f) 
FirmDAO_006=INSERT INTO C_FirmDetail (FirmID,SettingBankID,SettingBkBranch,SettingBkAccount,Note,BSEntityName,BSEntityTelNo,ContactName,ContactTelNo,ContactMobile,BSLicenseNo,RegisterCapital,BSLicense,TaxRegisterNo,TaxLicense,OrganizationCd,OrgCode,UnifyLicenseNo,UnifyLicense,DGLicenseNo,DGLicense,DGLicenseAuth,TaxNo,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,IsDanger,LicenseDiffer,ContactEmail,DGExpireDate,IsSignState,CustomerName ) VALUES(\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,dbo.base64_utf8encode(\u003f),dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
FirmDAO_007 =SELECT  FirmRegId,FirmName,FullName,FirmType,BusinessType,DISABLED,FirmStatus,AddressPV,AddressCT,AddressDT,Address,Fax,PostCode,ContactName,dbo.base64_utf8decode(ContactTelNo) as contactTelNo,dbo.base64_utf8decode(ContactMobile) as contactMobile,LicenseDiffer,BSLicense,TaxLicense,OrgCode,UnifyLicense,DGLicense,SettingBankID,SettingBkBranch,dbo.base64_utf8decode(SettingBkAccount) as settingBkAccount,VatBankID,VatBkBranch,dbo.base64_utf8decode(VatBkAccount) as vatBkAccount,VatPV,VatCT,VatDT,VatAddress,TaxNo,dbo.base64_utf8decode(VatContactTelNo) as vatContactTelNo,RecPV,RecCT,RecDT,RecAddress,RecContactName,dbo.base64_utf8decode(RecContactTelNo) as recContactTelNo,RequestUserId,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,IsBinding,RejectReason,FirmID,TradeAuthority,IsDanger,BSLicenseNo,OrganizationCd,RegisterCapital,BSEntityName,BSEntityTelNo,DGExpireDate,ContactEmail,UnifyLicenseNo,DGLicenseNo,TaxRegisterNo,DGLicenseAuth FROM C_FirmRegister where 1=1
FirmDAO_008 =SELECT cf.FirmRegId,cf.FirmName,cf.FullName,cf.FirmType,cf.BusinessType,cf.DISABLED,cf.FirmStatus,cf.AddressPV,cantonP1.FullName as addressPVName,cf.AddressCT,cantonC1.FullName as addressCTName,cf.AddressDT,cantonD1.FullName as addressDTName,cf.Address,cf.Fax,cf.PostCode,cf.ContactName,dbo.base64_utf8decode(ContactTelNo) as contactTelNo,dbo.base64_utf8decode(ContactMobile) as contactMobile,cf.LicenseDiffer,cf.BSLicense,cf.TaxLicense,cf.OrgCode,cf.UnifyLicense,cf.DGLicense,cf.SettingBankID,cf.SettingBkBranch,dbo.base64_utf8decode(SettingBkAccount) as settingBkAccount,cf.VatBankID,cf.VatBkBranch,dbo.base64_utf8decode(VatBkAccount) as vatBkAccount,cf.VatPV,cantonP2.FullName as vatPVName,cf.VatCT,cantonC2.FullName as vatCTName,cf.VatDT,cantonD2.FullName as vatDTName,cf.VatAddress,cf.TaxNo,dbo.base64_utf8decode(VatContactTelNo) as vatContactTelNo,cf.RecPV,cantonP3.FullName as recPVName,cf.RecCT,cantonC3.FullName as recCTName,cf.RecDT,cantonD3.FullName as recDTName,cf.RecAddress,cf.RecContactName,dbo.base64_utf8decode(RecContactTelNo) as recContactTelNo,cf.RequestUserId,cf.REC_CREATEBY,cf.REC_CREATETIME,cf.REC_MODIFYBY,cf.REC_MODIFYTIME,cf.IsBinding,cf.RejectReason,vb.BankName as settingBankName,cf.IsBinding,vb_1.BankName as vatBankName,cf.FirmID,cf.TradeAuthority,cf.IsDanger,cf.BSLicenseNo,cf.OrganizationCd,cf.RegisterCapital,cf.BSEntityName,dbo.base64_utf8decode(cf.BSEntityTelNo) as bSEntityTelNo,cf.DGExpireDate,cf.ContactEmail,cf.UnifyLicenseNo,cf.DGLicenseNo,cf.TaxRegisterNo,cf.DGLicenseAuth FROM C_FirmRegister cf LEFT JOIN VW_Bank vb ON vb.BankID = cf.SettingBankID LEFT JOIN VW_Bank vb_1 ON vb_1.BankID = cf.VatBankID LEFT JOIN VW_Canton cantonP1 on cantonP1.ID =  cf.AddressPV and cantonP1.TreeLevel = 2 LEFT JOIN VW_Canton cantonC1 on cantonC1.ID =  cf.AddressCT and cantonC1.TreeLevel = 3 LEFT JOIN VW_Canton cantonD1 on cantonD1.ID =  cf.AddressDT and cantonD1.TreeLevel = 4 LEFT JOIN VW_Canton cantonP2 on cantonP2.ID =  cf.VatPV and cantonP2.TreeLevel = 2 LEFT JOIN VW_Canton cantonC2 on cantonC2.ID =  cf.VatCT and cantonC2.TreeLevel = 3 LEFT JOIN VW_Canton cantonD2 on cantonD2.ID =  cf.VatDT and cantonD2.TreeLevel = 4 LEFT JOIN VW_Canton cantonP3 on cantonP3.ID =  cf.VatPV and cantonP3.TreeLevel = 2 LEFT JOIN VW_Canton cantonC3 on cantonC3.ID =  cf.VatCT and cantonC3.TreeLevel = 3 LEFT JOIN VW_Canton cantonD3 on cantonD3.ID =  cf.VatDT and cantonD3.TreeLevel = 4 where cf.FirmRegId = \u003f
FirmDAO_009 =INSERT INTO C_Address (AddPV,AddCT,AddDT,Address,DISABLED,ContactName,ContactTelNo,CreateTime,UpdateTime)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),GETDATE(),GETDATE())
FirmDAO_010 =INSERT INTO C_FirmInvoice(FirmID,AddressID,AddressType)VALUES(\u003f,\u003f,\u003f)
FirmDAO_011 =INSERT INTO C_FirmVATInfo(FirmID,VatBkAccount,VatBankID,VatBkBranch,VatAddressID)VALUES(\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f)
FirmDAO_012 =UPDATE C_FirmRegister SET FirmStatus =2 where FirmRegId =\u003f and FirmStatus != 2
FirmDAO_013 =SELECT cfi.FirmID,cfi.AddressID,cfi.AddressType, cad.AddPV AS recPV,cad.AddCT AS recCT,cad.AddDT AS recDT,cad.Address AS recAddress,cad.DISABLED AS recDisabled,cad.ContactName AS recContactName,cad.ContactTelNo AS recContactTelNo FROM C_FirmInvoice cfi LEFT JOIN C_Address cad ON cad.ID = cfi.AddressID where cfi.FirmID =\u003f
FirmDAO_014 =UPDATE C_FirmVATInfo SET VatBkAccount =dbo.base64_utf8encode(\u003f),VatBankID =\u003f,VatBkBranch =\u003f,VatAddressID=\u003f  where FirmID =\u003f
FirmDAO_015 =UPDATE C_Address SET AddPV =\u003f,AddCT =\u003f,AddDT =\u003f ,Address =\u003f,ContactName =\u003f,ContactTelNo =dbo.base64_utf8encode(\u003f),CreateTime =getDate(),UpdateTime =getDate() where ID =\u003f
FirmDAO_016 = SELECT * FROM C_FirmVATInfo where FirmID = \u003f
FirmDAO_017 = UPDATE C_Firm SET DISABLED =\u003f where FirmID =\u003f
FirmDAO_018 = UPDATE C_FirmRegister SET FirmStatus=4,RejectReason = \u003f  where FirmRegId =\u003f
FirmDAO_019 = SELECT cf.*,cfa.AppType FROM C_Firm  cf left JOIN C_FirmApp cfa ON cfa.FirmID = cf.FirmID where  cf.FirmName =\u003f
FirmDAO_020 = SELECT *\u3000FROM A_FirmTmptRlsp where FirmID =\u003f
FirmDAO_021 = INSERT INTO A_FirmTmptRlsp(FirmID,TradeTmptId,Enabled,IsRealName) VALUES(\u003f,\u003f,\u003f,\u003f)
FirmDAO_022 = DELETE FROM A_FirmTmptRlsp where FirmID =\u003f
FirmDAO_023 = SELECT * FROM C_Trader where TraderID=\u003f
FirmDAO_024 = SELECT COUNT(*) FROM C_Trader WHERE FirmID = \u003f;
FirmDAO_025 = SELECT * FROM C_Firm where FullName =\u003f
FirmDAO_026 = SELECT cad.ID as id,cfv.VatBankID,dbo.base64_utf8decode(cfv.VatBkAccount) as vatBkAccount,cfv.VatAddressID,cfv.VatBkBranch,cad.AddPV as vatPV,cad.AddCT as vatCT ,cad.AddDT as vatDT,cad.Address as vatAddress,cad.ContactName as vatContactName,dbo.base64_utf8decode(cad.ContactTelNo) as vatContactTelNo FROM C_FirmVATInfo cfv INNER JOIN C_Address cad ON cad.ID = cfv.VatAddressID  where cfv.FirmID=\u003f
FirmDAO_027 = update C_FirmVATInfo set VatBkAccount=dbo.base64_utf8encode(\u003f),VatBankID=\u003f,VatBkBranch=\u003f,VatAddressID=\u003f where FirmID=\u003f
FirmDAO_028 = DELETE FROM C_FirmVATInfo WHERE FirmID =\u003f
FirmDAO_029 = update C_FirmRegister set FirmStatus=\u003f,FirmName =\u003f,FullName=\u003f,FirmType=\u003f,BusinessType=\u003f,AddressPV=\u003f,AddressCT=\u003f,AddressDT=\u003f,Address=\u003f,Fax=\u003f,PostCode=\u003f,ContactName=\u003f,ContactTelNo=dbo.base64_utf8encode(\u003f),ContactMobile=dbo.base64_utf8encode(\u003f),LicenseDiffer=\u003f,BSLicense=\u003f,TaxLicense=\u003f,OrgCode=\u003f,UnifyLicense=\u003f,DGLicense=\u003f,SettingBankID=\u003f,SettingBkBranch=\u003f,SettingBkAccount=dbo.base64_utf8encode(\u003f),VatBankID=\u003f,VatBkBranch=\u003f,VatBkAccount=dbo.base64_utf8encode(\u003f),VatPV=\u003f,VatCT=\u003f,VatDT=\u003f,VatAddress=\u003f,TaxNo=\u003f,VatContactTelNo=dbo.base64_utf8encode(\u003f),RecPV=\u003f,RecCT=\u003f,RecDT=\u003f,RecAddRess=\u003f,RecContactName=dbo.base64_utf8encode(\u003f),RecContactTelNo=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f,IsBinding=\u003f,RejectReason=\u003f,FirmID=\u003f,TradeAuthority=\u003f,IsDanger=\u003f,BSLicenseNo=\u003f,OrganizationCd=\u003f,RegisterCapital=\u003f,BSEntityName=\u003f,BSEntityTelNo=dbo.base64_utf8encode(\u003f),DGExpireDate=\u003f,ContactEmail=\u003f,UnifyLicenseNo=\u003f,DGLicenseNo=\u003f,TaxRegisterNo=\u003f,DGLicenseAuth=\u003f where FirmRegId =\u003f
FirmDAO_030 = SELECT ca.ID as recAddressID,cf.AddressType as addressType,ca.UpdateTime as updateTime,ca.AddPV as recPV,ca.AddCT as recCT,ca.AddDT as recDT,ca.Address as recAddress,ca.DISABLED as disabled,ca.ContactName as recContactName,dbo.base64_utf8decode(ca.ContactTelNo) as recContactTelNo,wcp.ShortName as recPVName,wcc.ShortName as recCTName,wcd.ShortName as recDTName from C_FirmInvoice cf INNER JOIN C_Address ca ON cf.AddressID = ca.ID LEFT JOIN VW_Canton wcp ON wcp.ID = ca.AddPV LEFT JOIN VW_Canton wcc ON wcc.ID = ca.AddCT LEFT JOIN VW_Canton wcd ON wcd.ID = ca.AddDT where cf.FirmID =\u003f 
FirmDAO_031 = INSERT INTO C_Address(AddPV,AddCT,AddDT,Address,DISABLED,ContactName,ContactTelNo,CreateTime,UpdateTime)VALUES(\u003f,\u003f,\u003f,\u003f,0,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f)
FirmDAO_032 = SELECT ca.ID as recAddressID,cf.AddressType as addressType,ca.AddPV as recPV,ca.AddCT as recCT,ca.AddDT as recDT,ca.Address as recAddress,ca.ContactName as recContactName,dbo.base64_utf8decode(ca.ContactTelNo) as recContactTelNo,wcp.ShortName as recPVName,wcc.ShortName as recCTName,wcd.ShortName as recDTName from C_FirmInvoice cf INNER JOIN C_Address ca ON cf.AddressID = ca.ID LEFT JOIN VW_Canton wcp ON wcp.ID = ca.AddPV LEFT JOIN VW_Canton wcc ON wcc.ID = ca.AddCT LEFT JOIN VW_Canton wcd ON wcd.ID = ca.AddDT where cf.AddressID =\u003f 
FirmDAO_033 = update C_Address set AddPV=\u003f,AddCT=\u003f,AddDT=\u003f,Address=\u003f,ContactName=\u003f,ContactTelNo=dbo.base64_utf8encode(\u003f),UpdateTime=\u003f where ID =\u003f
FirmDAO_034 = INSERT INTO C_FirmApp(FirmID,AppType,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
FirmDAO_035 = SELECT * FROM C_FirmApp where FirmID =\u003f and AppType=\u003f
FirmDAO_036 = insert into C_FirmRegister(FirmRegId,FirmName,FullName,FirmType,BusinessType,DISABLED,FirmStatus,AddressPV,AddressCT,AddressDT,Address,Fax,PostCode,ContactName,ContactTelNo,ContactMobile,LicenseDiffer,BSLicense,TaxLicense,OrgCode,UnifyLicense,DGLicense,SettingBankID,SettingBkBranch,SettingBkAccount,VatBankID,VatBkBranch,VatBkAccount,VatPV,VatCT,VatDT,VatAddress,TaxNo,VatContactTelNo,RecPV,RecCT,RecDT,RecAddress,RecContactName,RecContactTelNo,RequestUserId,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,IsBinding,RejectReason,FirmID,TradeAuthority,IsDanger,BSLicenseNo,OrganizationCd,RegisterCapital,BSEntityName,BSEntityTelNo,DGExpireDate,ContactEmail,UnifyLicenseNo,DGLicenseNo,TaxRegisterNo,DGLicenseAuth) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
FirmDAO_037 = insert into C_FirmRegTmptRlsp (TradeTmptId,FirmRegId,Enabled,IsRealName) VALUES (\u003f,\u003f,\u003f,\u003f)
FirmDAO_038 = select * from C_FirmRegTmptRlsp where FirmRegId = \u003f
FirmDAO_039 = delete from C_FirmRegTmptRlsp where FirmRegId = \u003f
FirmDAO_040 = update C_Firm set FirmStatus = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = \u003f where FirmID = \u003f
FirmDAO_041 = insert into C_FirmSetting (FirmCode,SettingType,SettingValue,AppType,Remark,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
FirmDAO_042 = delete from C_FirmSetting where ID = \u003f
FirmDAO_043 = update C_FirmSetting set Remark = \u003f,DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate()  where ID = \u003f
FirmDAO_044 = SELECT * FROM ( SELECT t1.FirmID, isnull(t5.guapan, 0) AS stock_sell, isnull(t6.guapan, 0) AS advance_sell, t1.FirmName, isnull(t3.stock_saleMoney, 0) AS stock_saleMoney, isnull(t3.stock_saleVolume, 0) AS stock_saleVolume, isnull(t3.stock_undeliveryQuantity, 0) AS stock_undeliveryQuantity, isnull(t4.advance_saleMoney, 0) AS advance_saleMoney, isnull(t4.advance_saleVolume, 0) AS advance_saleVolume, isnull(t4.advance_undeliveryQuantity, 0) AS advance_undeliveryQuantity FROM C_Firm t1 LEFT JOIN ( SELECT tod.SellFirmId, SUM (tod.Quantity * tod.TradeUnitNumber) AS stock_saleVolume, SUM (tod.Amount) AS stock_saleMoney, SUM (tod.TotalQuantity - ISNULL(tod.DeliveryQuantity, 0) * tod.TradeUnitNumber + ISNULL(td.DeliveryWeight, 0)) AS stock_undeliveryQuantity FROM T_Order tod LEFT JOIN (SELECT de.OrderID, SUM(de.DeliveryWeight) AS DeliveryWeight FROM T_Delivery de WHERE(de.DeliveryStatus < 30 OR de.DeliveryStatus IS NULL) AND de.ConfirmReceive \= 0 GROUP BY de.OrderID) td ON td.OrderID \= tod.OrderId WHERE tod.GoodsType \= 0 AND tod.TradeStatus < 25 AND tod.TradeStatus \!\= - 1 GROUP BY tod.SellFirmId ) t3 ON t1.FirmID \= t3.SellFirmId LEFT JOIN ( SELECT tod.SellFirmId, SUM (tod.Quantity * tod.TradeUnitNumber) AS advance_saleVolume, SUM (tod.Amount) AS advance_saleMoney, SUM (tod.TotalQuantity - ISNULL(tod.DeliveryQuantity, 0) * tod.TradeUnitNumber + ISNULL(td.DeliveryWeight, 0)) AS advance_undeliveryQuantity FROM T_Order tod LEFT JOIN (SELECT de.OrderID, SUM(de.DeliveryWeight) AS DeliveryWeight FROM T_Delivery de WHERE(de.DeliveryStatus < 30 OR de.DeliveryStatus IS NULL) AND de.ConfirmReceive \= 0 GROUP BY de.OrderID) td ON td.OrderID = tod.OrderId WHERE tod.GoodsType = 1 AND tod.TradeStatus < 25 AND tod.TradeStatus != - 1 GROUP BY tod.SellFirmId ) t4 ON t1.FirmID = t4.SellFirmId LEFT JOIN (SELECT ts.FirmId, SUM(ts.Quantity * ts.TradeUnitNumber) AS guapan FROM T_Leads ts LEFT JOIN T_TradeTemplate trade ON ts.TradeTmptId = trade.TradeTmptId WHERE trade.TradeType = '0' AND ts.LeadsStatus = '0' GROUP BY ts.FirmId) t5 ON t5.FirmId = t1.FirmID LEFT JOIN (SELECT ts.FirmId, SUM(ts.Quantity * ts.TradeUnitNumber) AS guapan FROM T_Leads ts LEFT JOIN T_TradeTemplate trade ON ts.TradeTmptId = trade.TradeTmptId WHERE trade.TradeType = '1' AND ts.LeadsStatus = '0' GROUP BY ts.FirmId) t6 ON t6.FirmId = t1.FirmID WHERE t1.TradeAuthority IN (0, 2) AND t1.[DISABLED] = 0 AND t1.[FirmStatus] = 2 ) temp WHERE 1 = 1
FirmDAO_045 = SELECT * from T_FirmPositionLimit where FirmID =\u003f 
FirmDAO_046 = INSERT INTO T_FirmPositionLimit (FirmID,GoodsType,PositionLimitType,PositionLimitValue,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,PositionDesc)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f);
FirmDAO_047 = SELECT t.FirmID,t.FirmName,max(CASE t.PositionDesc WHEN 0 THEN showPositionLimitType ELSE '' END) show_stock_positionLimitValue,max(CASE t.PositionDesc WHEN 0 THEN positionLimitType ELSE '' END) stock_positionLimitType,max(CASE t.PositionDesc WHEN 0 THEN LeadsWeight ELSE 0 END) stock_sell,MAX ( CASE t.PositionDesc WHEN 0 THEN orderWeight ELSE 0 END ) stock_undeliveryQuantity, MAX ( CASE t.PositionDesc WHEN 0 THEN orderMoney ELSE 0 END ) stock_saleMoney, MAX ( CASE t.PositionDesc WHEN 1 THEN showPositionLimitType ELSE '' END ) show_advance_positionLimitValue, MAX ( CASE t.PositionDesc WHEN 1 THEN positionLimitType ELSE '' END ) advance_positionLimitType, MAX ( CASE t.PositionDesc WHEN 1 THEN LeadsWeight ELSE 0 END ) advance_sell, MAX ( CASE t.PositionDesc WHEN 1 THEN orderWeight ELSE 0 END ) advance_undeliveryQuantity, MAX ( CASE t.PositionDesc WHEN 1 THEN orderMoney ELSE 0 END ) advance_saleMoney, MAX ( CASE t.PositionDesc WHEN 2 THEN showPositionLimitType ELSE '' END ) show_future_positionLimitValue, MAX ( CASE t.PositionDesc WHEN 2 THEN positionLimitType ELSE '' END ) future_positionLimitType, MAX ( CASE t.PositionDesc WHEN 2 THEN LeadsWeight ELSE 0 END ) future_sell, MAX ( CASE t.PositionDesc WHEN 2 THEN orderWeight ELSE 0 END ) future_undeliveryQuantity, MAX ( CASE t.PositionDesc WHEN 2 THEN orderMoney ELSE 0 END ) future_saleMoney FROM ( SELECT t1.FirmID, t2.FirmName, CASE WHEN t1.PositionLimitType = 0 THEN CONCAT ( Convert(decimal(18,2),t1.PositionLimitValue), '(\u5143)' ) WHEN t1.PositionLimitType = 1 THEN CONCAT ( Convert(decimal(18,4),t1.PositionLimitValue), '(\u5428)' ) END AS showPositionLimitType, t1.PositionLimitType, t1.PositionDesc, t3.LeadsWeight, t4.orderWeight, t4.orderMoney FROM (( SELECT ttt.FirmID, NULL AS 'PositionLimitType', NULL AS 'PositionLimitValue', ttt.PositionDesc FROM ( SELECT t1.FirmID, t3.TradeType AS 'PositionDesc' FROM HJOnline.dbo.C_Firm t1, ( SELECT t.TradeType FROM T_TradeTemplate t WHERE t.DISABLED = 0 ) t3 WHERE t1.[DISABLED] = 0 AND t1.FirmStatus = 2 AND t1.TradeAuthority IN (0, 2) EXCEPT SELECT t.FirmID, t.PositionDesc FROM T_FirmPositionLimit t WHERE t.DISABLED = 0 ) AS ttt ) UNION SELECT t1.FirmID, t1.PositionLimitType, t1.PositionLimitValue, t1.PositionDesc FROM HJOnline.dbo.T_FirmPositionLimit t1 WHERE t1.[DISABLED] = 0 ) t1 JOIN C_Firm t2 ON t1.FirmID = t2.FirmID LEFT JOIN ( SELECT t1.FirmId, t2.TradeType, SUM (( t1.Quantity + t1.LockQuantity ) * t1.TradeUnitNumber ) AS LeadsWeight FROM HJOnline.dbo.T_Leads t1 INNER JOIN HJOnline.dbo.T_TradeTemplate t2 ON t1.TradeTmptId = t2.TradeTmptId WHERE t1.[DISABLED] = 0 AND t1.LeadsStatus = 0 AND t2.TradeType = 0 GROUP BY t1.FirmId, t2.TradeType ) t3 ON t1.FirmID = t3.FirmId AND t1.PositionDesc = t3.TradeType LEFT JOIN ( SELECT t1.SellFirmId, t2.TradeType, SUM (t1.TotalQuantity) AS orderWeight, SUM (t1.Amount) AS orderMoney FROM HJOnline.dbo.T_Order t1 INNER JOIN HJOnline.dbo.T_TradeTemplate t2 ON t1.TradeTmptId = t2.TradeTmptId WHERE t1.[DISABLED] = 0 AND t1.tradestatus < 25 AND t1.tradestatus > 0 AND t2.TradeType = 0 GROUP BY t1.SellFirmId, t2.TradeType ) t4 ON t1.FirmID = t4.SellFirmId AND t1.PositionDesc = t3.TradeType ) AS t WHERE 1 = 1
ShopDAO_001 = select * from (SELECT s.ID,s.ShopName,s.Sort,s.Logo,s.Introduction,s.Remark,s.DISABLED,shopFirm.FirmID,f.FirmName,CASE (SELECT count(1) from C_Shop_Firm t where t.IsMainFirm = 0 and t.ShopID = s.ID) WHEN 0 THEN 0 ELSE 1 END as isHaveRelationFirm from C_Shop s left join C_Shop_Firm shopFirm  on shopFirm.ShopID = s.ID and shopFirm.IsMainFirm = 1 LEFT JOIN C_Firm f ON shopFirm.FirmID=f.FirmID) temp where 1=1
ShopDAO_002 = INSERT into C_Shop(ShopName,Sort,Logo,Introduction,Remark,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
ShopDAO_003 = UPDATE C_Shop SET ShopName=\u003f,Sort=\u003f,Logo=\u003f,Introduction=\u003f,Remark=\u003f,DISABLED=\u003f,REC_CREATEBY=\u003f,REC_CREATETIME=getDate(),REC_MODIFYBY=\u003f,REC_MODIFYTIME=getDate() WHERE ID=\u003f
ShopDAO_004 = SELECT s.*,f.FirmName from C_Shop s LEFT JOIN C_Firm f ON s.FirmID=f.FirmID WHERE s.ID=\u003f
ShopDAO_005 = select firm.FirmID,firm.FirmName from C_Firm  firm where firm.FirmID not in(SELECT shopFirm.FirmID from C_Shop_Firm shopFirm left join C_Shop shop on shop.ID = shopFirm.ShopID) 
ShopDAO_006 = update C_Shop SET DISABLED=\u003f WHERE ID=\u003f
ShopFirmDAO_001 = INSERT INTO C_Shop_Firm(ShopID,FirmID,IsMainFirm,Remark,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
ShopFirmDAO_002 = SELECT count(1) FROM C_Shop_Firm where FirmID = \u003f
ShopFirmDAO_003 = delete C_Shop_Firm  where ShopID = \u003f and IsMainFirm = \u003f
ShopFirmDAO_004 = select shopFirm.FirmID as firmID,firm.FirmName as firmName,shopFirm.IsMainFirm as isMainFirm from C_Shop_Firm shopFirm LEFT JOIN C_Firm firm on shopFirm.FirmID = firm.FirmID where 1=1
#\u4ea4\u6613\u5458\u76f8\u5173#
TraderDAO_001 = SELECT ct.*,dbo.base64_utf8decode(cu.Mobile) as mobile,cf.FirmName as firmName,isnull(cu.UserName,'') as userName FROM\u3000C_Trader ct left join c_firm cf on ct.firmid=cf.firmid LEFT JOIN C_User cu ON ct.UserCode = cu.UserCode\u3000where 1=1
TraderDAO_002 = SELECT * FROM\u3000C_User\u3000where UserCode =\u003f
TraderDAO_003 = INSERT INTO C_Trader (TraderID,TraderName,TraderPassword,ForceChangePwd,DISABLED,FirmID,FirmType,UserCode,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
TraderDAO_004 = UPDATE C_Trader SET TraderName=\u003f,DISABLED=\u003f,FirmType=\u003f,UserCode=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME = getDate() where TraderID=\u003f
TraderDAO_005 = UPDATE C_Trader SET DISABLED=1 where TraderID=\u003f
TraderDAO_006 = UPDATE C_Trader SET DISABLED=0 where TraderID=\u003f
TraderDAO_007 = SELECT ct.*,dbo.base64_utf8decode(cu.Mobile) as mobile,cu.LastLoginTime AS lastLoginTime FROM C_Trader ct INNER JOIN C_User cu ON cu.UserCode = ct.UserCode where ct.TraderID=\u003f
TraderDAO_008 = UPDATE C_Trader SET TraderName='',UserCode=\u003f where TraderID=\u003f
TraderDAO_009 = SELECT TradeTmptId FROM A_TraderTmptRlsp where TraderID =\u003f
TraderDAO_010 = INSERT INTO A_TraderTmptRlsp(TradeTmptId,TraderID,Enabled)VALUES(\u003f,\u003f,\u003f)
TraderDAO_011 = DELETE FROM A_TraderTmptRlsp WHERE TraderID=\u003f
TraderDAO_012= update c_user  set userType=\u003f where userCode=\u003f
TraderDAO_013= SELECT * FROM C_Trader where UserCode=\u003f
TraderDAO_014= SELECT ct.*,dbo.base64_utf8decode(cu.Mobile) as mobile,cf.FirmName as firmName, isnull(cu.UserName,'') as userName FROM\u3000C_Trader ct left join c_firm cf on ct.FirmID=cf.FirmID LEFT JOIN C_User cu ON ct.UserCode = cu.UserCode where ct.FirmID=\u003f
TraderDAO_015 = SELECT ct.*, cf.FirmName AS firmName, dbo.base64_utf8decode(cu.Mobile) AS mobile, cu.LastLoginTime AS lastLoginTime FROM C_Trader ct LEFT JOIN C_User cu ON cu.UserCode = ct.UserCode LEFT JOIN C_Firm cf ON cf.FirmID = ct.FirmID WHERE ct.TraderID=\u003f
TraderDAO_016 = SELECT * FROM C_Trader where FirmID=\u003f
TraderDAO_017 = INSERT INTO T_CSRemindRemark(RelationID,RemarkType,Remark,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f) 
TraderDAO_018 = SELECT * FROM T_CSRemindRemark remark WHERE remark.RelationID = \u003f and  remark.RemarkType = \u003f order by REC_MODIFYTIME DESC
TraderDAO_019 = select specialOprDetail.ID as specialOprDetailID,delivery.OrderID as orderId,delivery.DeliveryID as deliveryId,specialOprDetail.FirmID as firmId,firm.FirmName as firmName,firmfunds.BALANCE as balance,firmfunds.FROZENFUNDS as frozenfunds,specialOprDetail.Amount as amount,specialOpr.OprType as oprType,CASE specialOpr.OprType   WHEN 1 THEN sellTrader.TraderName   WHEN 3 THEN sellTrader.TraderName   ELSE buyTrader.TraderName END as contactName, CASE specialOpr.OprType   WHEN 1 THEN dbo.base64_utf8decode(sellUsers.Mobile)   WHEN 3 THEN dbo.base64_utf8decode(sellUsers.Mobile)   ELSE dbo.base64_utf8decode(buyUsers.Mobile) END as contactMobile, CASE specialOpr.OprType   WHEN 1 THEN sellUsers.UserEmail   WHEN 3 THEN sellUsers.UserEmail   ELSE buyUsers.UserEmail END as contactEmail,orders.GoodsType AS goodsType ,crmBr.BrandName AS brandName from T_SpecialOprDetail specialOprDetail LEFT join T_SpecialOpr specialOpr on specialOpr.RelationType = 3 and specialOprDetail.SpecialOprID =   specialOpr.ID inner join C_Firm firm on firm.FirmID = specialOprDetail.FirmID inner join F_FIRMFUNDS firmfunds on firmfunds.FIRMID =  specialOprDetail.FirmID inner join T_Delivery delivery on delivery.DeliveryID =  specialOpr.RelationID inner join T_Order orders on orders.OrderId = delivery.OrderID inner join C_Trader buyTrader on buyTrader.TraderID = orders.BuyTraderId inner join C_Trader sellTrader on sellTrader.TraderID = orders.SellTraderId inner join C_User buyUsers on buyUsers.UserCode = buyTrader.UserCode inner join C_User sellUsers on sellUsers.UserCode = sellTrader.UserCode LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID where specialOprDetail.PayType = 1 and specialOprDetail.Status = 1
TraderDAO_020 = update  C_Trader SET TraderStatus = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate(),FrozenRemark = \u003f   WHERE TraderID = \u003f
TraderDAO_021 = delete from T_FirmSpecialFee  where FirmID = \u003f and TradeTmptId = \u003f
TraderDAO_022 = SELECT ID AS categoryId FROM VW_Crm_CategorySpecial where DISABLED = 0
TraderDAO_023 = SELECT te.*,tw.WHAddress as whAddress,vs.Name as sourcePlaceName,CAST(crmCat.CategoryName AS VARCHAR)+'-'+CAST(crmBr.BrandName  AS VARCHAR) AS goodName FROM T_Enquiry te LEFT JOIN VW_Crm_SourcePlace  vs ON vs.ID = te.SourcePlaceID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = te.BrandID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = crmBr.CategoryLeafID LEFT JOIN T_WareHouseAddress tw ON tw.Id = te.AddressID where te.EnquiryId =\u003f
TraderDAO_024 = select * FROM (SELECT trader.*,dbo.base64_utf8decode(users.Mobile) as mobile,users.UserName as userName,firm.FirmName AS firmName FROM C_Trader trader  LEFT JOIN  C_Firm firm ON firm.FirmID = trader.FirmID  LEFT JOIN  C_User users ON users.UserCode = trader.UserCode where trader.DISABLED = 0 ) temp where 1=1
TraderDAO_025 = SELECT * from (SELECT cu.UserName as userName,cu.UserCode as userCode,0 as id, dbo.base64_utf8decode(cu.Mobile) as moreMobile,cu.REC_CREATEBY as moreREC_CREATEBY, cu.REC_CREATETIME as moreREC_CREATETIME,0 as isOpt  from C_User cu UNION ALL select cu.UserName as userName, cus.UserCode as userCode, cus.ID as id, dbo.base64_utf8decode(cus.MoreMobile) as moreMobile, cus.REC_CREATEBY as moreREC_CREATEBY, cus.REC_CREATETIME as moreREC_CREATETIME,1 as isOpt from C_User cu  left join C_User_SendMobile cus on cus.UserCode = cu.UserCode where cus.DISABLED = 0) temp where 1=1 
TraderDAO_026 = select count(*) from C_User_SendMobile where DISABLED = 0 and UserCode = \u003f
TraderDAO_027 = insert into C_User_SendMobile(UserCode,MoreMobile,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) values(\u003f,dbo.base64_utf8encode(\u003f),0,\u003f,getDate(),\u003f,getDate())
TraderDAO_028 = update C_User_SendMobile set MoreMobile = dbo.base64_utf8encode(\u003f),REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where ID = \u003f
TraderDAO_029 = update C_User_SendMobile set DISABLED = 1 where ID = \u003f
TraderDAO_030 = select count(*) from C_User_SendMobile where DISABLED=0 and MoreMobile = dbo.base64_utf8encode(\u003f) AND UserCode = \u003f
TraderDAO_031 = delete from T_FirmSpecialMargin  where FirmID = \u003f and TradeTmptId = \u003f
#\u7528\u6237\u76f8\u5173#
UserDAO_001 = SELECT cua.AppType AS resource,cu.UserCode,cu.RegisterAppType,cu.UserName,cu.UserEmail,dbo.base64_utf8decode(cu.Mobile) AS Mobile,cu.DISABLED,cu.UserType,cu.REC_CREATETIME as recCreateTime,ct.TraderID,ct.TraderName,ct.FirmID,cu.useravailable,userErrorPsw.Id as userErrorPswId,userErrorPsw.ErrorNums as userErrorPswErrorNums  FROM C_User cu LEFT JOIN C_Trader ct ON ct.UserCode = cu.UserCode LEFT JOIN C_UserErrorPsw userErrorPsw on userErrorPsw.UserCode = cu.UserCode  and convert(char(10),userErrorPsw.InputDate,120) = convert(char(10),GETDATE(),120) INNER JOIN C_UserApp cua ON cua.UserCode = cu.UserCode where 1=1
UserDAO_002 = SELECT cu.UserCode,cu.UserName,dbo.base64_utf8decode(cu.Mobile) AS Mobile,cu.DISABLED,cu.UserType,cu.REC_CREATETIME as recCreateTime,cu.LastLoginTime,cu.REC_CREATEBY as recCreateBy,cu.useravailable FROM C_User cu  FROM C_User cu where cu.UserCode =\u003f
UserDAO_003 = INSERT INTO C_User (UserCode,UserName,UserPassword,Mobile,DISABLED,UserType,LastLoginTime,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,Salt)VALUES(\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,getDate(),\u003f,getDate(),\u003f,getDate(),\u003f)
UserDAO_004 = UPDATE C_User SET USERAVAILABLE = 1 where  DISABLED=0 AND USERAVAILABLE = 0 AND UserCode =\u003f
UserDAO_005 = UPDATE C_User SET USERAVAILABLE = 0  where DISABLED=0 AND USERAVAILABLE = 1 and UserCode =\u003f
UserDAO_006 = select * from C_User where Mobile =dbo.base64_utf8encode(\u003f) and DISABLED = 0
UserDAO_007 = select * from (select cusers.UserCode As userCode,cusers.UserName As userName,dbo.base64_utf8decode(cusers.Mobile) As mobile,cusers.REC_CREATETIME as createTime,ISNULL(cusInfoMaintain.UserStatus,-1) as userStatus,cusInfoMaintain.REC_MODIFYTIME as lastMaintainTime,ISNULL(cusInfoMaintain.MaintainStatus,-1) as maintainStatus,cusInfoCSCfg.UserID as cusUserId,muser.Name as cusUserName,cusers.UserType as userType	from C_User cusers left join C_CusInfoMaintain cusInfoMaintain on cusInfoMaintain.UserCode = cusers.UserCode left join C_CusInfoCSCfg cusInfoCSCfg on cusInfoCSCfg.UserCode = cusers.UserCode left join M_User muser on muser.UserID = cusInfoCSCfg.UserID	where cusers.DISABLED = 0 and  cusers.UserAvailable = 0 and (select count(1) from C_FirmRegister firmRegister where firmRegister.RequestUserId = cusers.UserCode) = 0 and (select count(1) from C_Trader trader where trader.UserCode = cusers.UserCode) = 0) tmp where 1=1 
UserDAO_008 = select cuser.UserName as userName,dbo.base64_utf8decode(cuser.Mobile) As mobile,dbo.base64_utf8decode(maintain.ContactTelNo) AS contactTelNo,maintain.ID,maintain.UserCode,maintain.FirmName,maintain.ContactTelNo,maintain.BusinessType,maintain.Fax,maintain.AddressPV,maintain.AddressCT,maintain.AddressDT,maintain.Address,maintain.PostCode,maintain.Remark,ISNULL(maintain.UserSource,-1) as UserSource,maintain.OtherRemark,ISNULL(maintain.UserStatus,-1) as UserStatus,ISNULL(maintain.MaintainStatus,-1) as MaintainStatus,ISNULL(maintain.IsDanger,-1) as IsDanger,ISNULL(maintain.TradeAuthority,-1) as TradeAuthority,ISNULL(maintain.DISABLED,-1) as DISABLED,maintain.REC_CREATEBY,maintain.REC_CREATETIME,maintain.REC_MODIFYBY,maintain.REC_MODIFYTIME from C_User cuser left join C_CusInfoMaintain	maintain on cuser.UserCode = maintain.UserCode where cuser.UserCode = \u003f
UserDAO_009 = insert into C_CusInfoMaintain (UserCode,FirmName,ContactTelNo,BusinessType,Fax,AddressPV,AddressCT,AddressDT,Address,PostCode,Remark,UserSource,OtherRemark,UserStatus,MaintainStatus,IsDanger,TradeAuthority,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
UserDAO_010 = update C_CusInfoMaintain SET FirmName = \u003f,ContactTelNo = dbo.base64_utf8encode(\u003f),BusinessType = \u003f,Fax = \u003f,AddressPV = \u003f,AddressCT = \u003f,AddressDT = \u003f,Address = \u003f,PostCode = \u003f,Remark = \u003f,UserSource = \u003f,OtherRemark = \u003f,UserStatus = \u003f,MaintainStatus = \u003f,IsDanger = \u003f,TradeAuthority = \u003f,DISABLED = \u003f,REC_MODIFYBY  = \u003f,REC_MODIFYTIME = \u003f where UserCode =  \u003f
UserDAO_011 = select Count(1) from C_CusInfoMaintain where UserCode =  \u003f 
UserDAO_012 = UPDATE  C_UserErrorPsw SET ErrorNums = 0  WHERE Id =  \u003f
CusInfoDao_001=INSERT INTO C_CusInfoCSCfg (UserCode,UserID,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
CusInfoDao_002=SELECT * FROM C_CusInfoCSCfg WHERE UserCode=\u003f
CusInfoDao_003=UPDATE C_CusInfoCSCfg SET UserID=\u003f,REC_MODIFYBY=\u003f WHERE UserCode=\u003f
BankDAO_001=select t.* from f_banks t where 1=1
BankDAO_002=select t.* from f_banks t where t.bankId=\u003f
BankDAO_003=update f_banks  set bankname=\u003f,begintime=\u003f,endtime=\u003f,maxpersgltransmoney=\u003f,maxpertransmoney=\u003f,maxpertranscount=\u003f,maxauditmoney=\u003f,control=\u003f where bankId=\u003f and validFlag=0
BankDAO_004=update f_banks  set validflag=1 where bankId=\u003f and validFlag=0
BankDAO_005=update f_banks set validflag=0 where bankId=\u003f and validFlag=1
BankDAO_006=insert into f_banks (bankId,bankName,begintime,endtime,maxpersgltransmoney,maxpertransmoney,maxpertranscount,maxauditmoney,control,validFlag) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,0)
LogDAO_001=insert into EndLog (Date, [Level], Message, Exception, UserID, AppName, IPAddress) values (getDate(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
LogDAO_002=insert into BusinessEndLog (Date, Type, Message, UserID, AppName, IPAddress, Status) values (getDate(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
LogDAO_003=insert into ServiceOpeLog (OpeDate, ServiceName, MethodName, AppName, Result, Comment) values (getDate(),\u003f,\u003f,\u003f,\u003f,\u003f)
CommonDAO_001=select t.id as value,t.FullName as text from vw_canton t where t.TreeLevel=\u003f
CommonDAO_002=select t.id as value,t.FullName as text from vw_canton t where t.ParentID=\u003f
CommonDAO_003=select t.id as value,t.TypeName as text from vw_CompanyType t 
CommonDAO_004=select t.BankID as value,t.BankName as text from vw_Bank t 
#CommonDAO_004=select TOP 20 t.BankID as value,t.BankName as text from vw_Bank t 
CommonDAO_005=select cu.UserCode as value,dbo.base64_utf8decode(cu.Mobile) as text,cu.UserName as name  from C_User cu WHERE DISABLED=0 and UserAvailable = 0
CommonDAO_006=select TOP 10 cf.FirmID as value,cf.FirmName as text from C_Firm cf  LEFT JOIN C_FirmApp cfa ON cfa.FirmID = cf.FirmID  WHERE cf.DISABLED = 0 
CommonDAO_007=select fv.CODE as value,fv.NAME as text,fv.SUMMARYNO as sUMMARYNO from F_VoucherModel fv ORDER BY CAST(fv.SUMMARYNO as INT) ASC
CommonDAO_008=SELECT id as tagID,tagValue as text FROM I_InfoTag where  tagTypeDiff =\u003f
CommonDAO_009={call Proc_SP_GetTradeTmpFeeInfo_Trade(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)}
CommonDAO_010={call Proc_SP_GetTradeTmpFeeInfo_Receive(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)}
CommonDAO_011={\u003f=call Proc_SP_GetTradeTmpRole_Firm(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)}
CommonDAO_012={\u003f=call Proc_SP_GetTradeTmpRole_Trader(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)}
CommonDAO_013=select t.TradeTmptId as value,t.TradeTmptName as text from T_TradeTemplate t where t.DISABLED=0
CommonDAO_014 = select t.TradeTmptId as value,t.TradeTmptName as text from T_TradeTemplate t INNER JOIN A_FirmTmptRlsp f ON f.TradeTmptId = t.TradeTmptId where t.DISABLED=0 and f.FirmID = \u003f
CommonDAO_015 = select cu.UserCode as value,dbo.base64_utf8decode(cu.Mobile) as text,cu.UserName as name  from C_User cu INNER JOIN C_UserApp cua ON cua.UserCode = cu.UserCode WHERE cua.AppType=1 and cu.DISABLED=0 and cu.UserCode not IN (SELECT UserCode FROM C_Trader WHERE UserCode IS NOT NULL AND UserCode !='') and UserAvailable = 0 
CommonDAO_016 = select fs.SUMMARYNO as value,fs.SUMMARY as text,fs.SUMMARYNO as sUMMARYNO from F_Summary fs where fs.accCode is not null and ltrim(rtrim(fs.accCode)) \!\= ''ORDER BY CAST(fs.SUMMARYNO as INT) ASC
CommonDAO_017=select vb.BankID as value,vb.BankName as text from F_AssignedBank fa left join  VW_Bank vb on fa.BankID=vb.BankID where fa.AssignedBankFg=1 order by fa.BankID asc
CommonDAO_018=select TOP 30 vm_c.ID as tagID,vm_c.CategoryName as text from VW_Crm_CategorySpecial vm_c where vm_c.DISABLED = 0
CommonDAO_019=SELECT vm_b.ID as tagID,vm_b.BrandName as text FROM VW_Crm_Brand vm_b LEFT JOIN VW_Crm_CategorySpecial vm_c ON vm_c.ID = vm_b.CategoryLeafID where vm_c.ID =\u003f and vm_b.DISABLED = 0
CommonDAO_020 = select TOP 10 cf.FirmID as value,cf.FirmName as text from C_Firm cf WHERE DISABLED = 0 AND cf.FirmID IN(SELECT FirmID from A_FirmTmptRlsp)
CommonDAO_021=select categorySpecial.* from VW_Crm_CategorySpecial categorySpecial where categorySpecial.DISABLED = 0 and categorySpecial.ID not in(SELECT DISTINCT ISNULL(tp.CategoryId,-1) from T_TemplatePrivilege tp where tp.PRIVILEGECODE_B = 1 and  tp.PRIVILEGECODE_S = 1 and tp.TradeTmptId = \u003f) 
CommonDAO_022=select category.CategoryName as categoryLeafName,brand.* from VW_Crm_Brand brand LEFT JOIN VW_Crm_CategorySpecial category ON category.ID = brand.CategoryLeafID where brand.DISABLED = 0 and brand.CategoryLeafID = \u003f and  brand.ID not in(SELECT DISTINCT ISNULL(tp.BrandId,-1) from T_TemplatePrivilege tp where tp.PRIVILEGECODE_B = 1 and  tp.PRIVILEGECODE_S = 1 and tp.TradeTmptId = \u003f)
CommonDAO_023=select * from VW_Crm_CategorySpecial vm_c where vm_c.DISABLED = 0 and vm_c.type = \u003f
#CommonDAO_024 = SELECT CAST(vw1.FullName AS VARCHAR)+'-'+CAST(vw2.FullName AS VARCHAR)+'-'+CAST(vw3.FullName AS VARCHAR)+'-'+CAST(wha.WHAddress AS VARCHAR)  as text,wha.Id as value  FROM T_WareHouseAddress  wha INNER JOIN VW_Canton vw1 ON wha.AddPV = vw1.ID INNER JOIN VW_Canton vw2 ON wha.AddCT = vw2.ID INNER JOIN VW_Canton vw3 ON wha.AddDT = vw3.ID where wha.WHGroupID in (\u003f)
CommonDAO_024 = SELECT DISTINCT temp.value,text FROM (SELECT CAST(vw1.FullName AS VARCHAR)+'-'+CAST(vw2.FullName AS VARCHAR)+'-'+CAST(vw3.FullName AS VARCHAR)+'-'+CAST(wha.WHAddress AS VARCHAR(90))  as text,wha.Id as value FROM T_WareHouseAddress  wha INNER JOIN VW_Canton vw1 ON wha.AddPV = vw1.ID INNER JOIN VW_Canton vw2 ON wha.AddCT = vw2.ID INNER JOIN VW_Canton vw3 ON wha.AddDT = vw3.ID WHERE wha.WHGroupID in(\u003f) ) temp INNER JOIN T_WHAddrTemplateRlsp whatr ON whatr.WareHouseAddressID = temp.value WHERE whatr.TradeTmptId =\u003f
CommonDAO_025 =select t.FutureContractCode as value,t.FutureContractName as text from C_FutureContract t where DISABLED=0
CommonDAO_026 = select t.CategoryId,c.CategoryName,t.BrandId,b.BrandName,t.SourcePlaceId ,s.Name as sourcePlaceName,t.TradeUnitNumber from T_TemplatePrivilege t join VW_Crm_CategorySpecial c on t.CategoryId = c.ID join VW_Crm_Brand b on t.BrandId \= b.ID join VW_Crm_SourcePlace s on t.SourcePlaceId = s.ID where 1=1 
CommonDAO_027=SELECT * FROM C_Dictionary where 1\=1
CommonDAO_028={call Proc_SP_GetTradeTmpFeeInfo_Trade_LLDPE(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)}
CommonDAO_029 = select t.CategoryId,c.CategoryName,t.BrandId,b.BrandName from T_TemplatePrivilege t join VW_Crm_CategorySpecial c on t.CategoryId = c.ID join VW_Crm_Brand b on t.BrandId \= b.ID join VW_Crm_SourcePlace s on t.SourcePlaceId = s.ID where 1=1


#\u8d22\u52a1\u51ed\u8bc1#
VoucherDAO_001 = select fv.*,cf.FirmName,cf.FirmNamePY,t2.amounts as money from F_Voucher fv inner join (select z.VOUCHERNO,case when z.creditamount>0 then z.creditamount else z.debitamount end as amounts from (select b.VOUCHERNO, b.creditamount,b.debitamount,ROW_NUMBER() over (partition by b.VOUCHERNO order by b.VOUCHERNO) as nums from F_Voucherentry b) z where z.nums=1) t2 on fv.VOUCHERNO = t2.VOUCHERNO  LEFT JOIN C_Firm cf ON cf.FirmID = fv.FirmID where 1=1
VoucherDAO_002 = select fv.*,cf.FirmName,cf.FirmNamePY,t2.amounts as money from F_Voucher fv inner join (select z.VOUCHERNO,case when z.creditamount>0 then z.creditamount else z.debitamount end as amounts from (select b.VOUCHERNO, b.creditamount,b.debitamount,ROW_NUMBER() over (partition by b.VOUCHERNO order by b.VOUCHERNO) as nums from F_Voucherentry b) z where z.nums=1) t2 on fv.VOUCHERNO = t2.VOUCHERNO  LEFT JOIN C_Firm cf ON cf.FirmID = fv.FirmID WHERE 1=1 and fv.STATUS = 0
VoucherDAO_003 = select fv.*,cf.FirmName,cf.FirmNamePY,t2.amounts as money from F_Voucher fv inner join (select z.VOUCHERNO,case when z.creditamount>0 then z.creditamount else z.debitamount end as amounts from (select b.VOUCHERNO, b.creditamount,b.debitamount,ROW_NUMBER() over (partition by b.VOUCHERNO order by b.VOUCHERNO) as nums from F_Voucherentry b) z where z.nums=1) t2 on fv.VOUCHERNO = t2.VOUCHERNO  LEFT JOIN C_Firm cf ON cf.FirmID = fv.FirmID WHERE 1=1 and fv.STATUS in(0,1)
VoucherDAO_004 = select fv.*,cf.FirmName,cf.FirmNamePY,t2.amounts as money from F_Voucher fv inner join (select z.VOUCHERNO,case when z.creditamount>0 then z.creditamount else z.debitamount end as amounts from (select b.VOUCHERNO, b.creditamount,b.debitamount,ROW_NUMBER() over (partition by b.VOUCHERNO order by b.VOUCHERNO) as nums from F_Voucherentry b) z where z.nums=1) t2 on fv.VOUCHERNO = t2.VOUCHERNO  LEFT JOIN C_Firm cf ON cf.FirmID = fv.FirmID WHERE 1=1 and fv.VOUCHERNO = \u003f 
VoucherDAO_005 = DELETE FROM F_Voucher   where  STATUS = 1
VoucherDAO_006 = DELETE FROM F_Voucherentry where VOUCHERNO = \u003f
VoucherDAO_007 = UPDATE F_Voucher SET STATUS = 3 where VOUCHERNO = \u003f
VoucherDAO_008 = SELECT\u3000fv.* from F_VoucherModel fv where fv.CODE = \u003f 
VoucherDAO_009 = UPDATE F_Voucher SET NOTE =\u003f where VOUCHERNO = \u003f
VoucherDAO_010 = SELECT * FROM F_Voucher where STATUS != 1
VoucherDAO_011=insert into F_PAYMENT_LOG (ID,CALLER,CALLTIME,PAYCOUNT,STATUS,NOTE) values(?,?,systimestamp,?,?,?)
VoucherDAO_012=insert into F_PAYMENT_LOG_DETAIL (id,detailid,vouchermodelid,money,contractno,firmid,note,inputuser,status,errortype,errormsg,starttime) values (?,?,?,?,?,?,?,?,?,?,?,systimestamp)
VoucherDAO_013=select SEQ_F_PAYMENT_LOG.nextval from dual
VoucherDAO_014=update F_PAYMENT_LOG set STATUS \= ? where ID \= ?
VoucherDAO_015=update F_PAYMENT_LOG set note \= ? where ID \= ?
VoucherDAO_016=update F_PAYMENT_LOG_DETAIL set STATUS \= ? where ID \= ? and DETAILID \= ?
VoucherDAO_017=update F_PAYMENT_LOG_DETAIL set ERRORTYPE \= ?, ERRORMSG \= ?  where ID \= ? and DETAILID \= ?
VoucherDAO_018=update F_PAYMENT_LOG set endtime \= systimestamp where ID \= ?
VoucherDAO_019=update F_PAYMENT_LOG_DETAIL set endtime \= systimestamp where ID \= ? and DETAILID \= ?
VoucherDAO_020=select * from f_payment_log where id \= ?
VoucherDAO_021=select * from f_payment_log_detail where id \= ?
VoucherDAO_022=update F_PAYMENT_LOG set ISCOMPENSATE \= ? where ID \= ?
#\u54a8\u8be2\u7ba1\u7406\u76f8\u5173#
InfoMgrDAO_001 = SELECT iqt.id,iqt.title,iqt.infoKeyword,iqt.infoLinkId,iqt.infoStatus,iqt.postTime,iqt.REC_CREATEBY,iqt.REC_CREATETIME,iqt.REC_MODIFYBY,iqt.REC_MODIFYTIME FROM I_Quotation iqt LEFT JOIN  I_QtContent iqc ON iqt.id = iqc.QuotationId WHERE iqt.id IN (SELECT QuotationId FROM I_QtRelation WHERE relationType = 3 
InfoMgrDAO_002 = SELECT TOP 1 iqt.id,iqt.title,iqt.infoKeyword,iqt.infoLinkId,iqt.infoStatus,iqt.postTime,iqt.REC_CREATEBY AS rECCREATEBY,iqt.REC_CREATETIME AS rECCREATETIME,iqt.REC_MODIFYBY AS rECMODIFYBY,iqt.REC_MODIFYTIME AS rECMODIFYTIME,iqc.infoContent FROM I_Quotation iqt LEFT JOIN  I_QtContent iqc ON iqt.id = iqc.QuotationId where iqt.id = \u003f
InfoMgrDAO_003 = SELECT  iif.tagValue as tagValues  FROM I_Quotation iqt LEFT JOIN I_QtRelation iqr ON iqr.QuotationId = iqt.id LEFT JOIN I_InfoTag iif ON iif.id = iqr.relationId WHERE iqr.relationType = 2 and iif.tagTypeDiff=\u003f and iqt.id =\u003f  
InfoMgrDAO_004 = SELECT  iif.catogoryName FROM I_Quotation iqt LEFT JOIN I_QtRelation iqr ON iqr.QuotationId = iqt.id LEFT JOIN I_InfoCatogory iif ON iif.id = iqr.relationId WHERE iqr.relationType = 3 and iqt.id =\u003f
InfoMgrDAO_005 = INSERT INTO I_Quotation(title,infoKeyword,infoLinkId,infoStatus,postTime,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE()) SELECT @@IDENTITY AS returnName  
InfoMgrDAO_006 = INSERT INTO I_QtRelation(QuotationId,relationId,relationType)VALUES(\u003f,\u003f,\u003f);
InfoMgrDAO_007 = UPDATE I_Quotation SET title =\u003f,infoKeyword =\u003f,infoLinkId =\u003f,infoStatus =\u003f,postTime =\u003f,REC_MODIFYBY =\u003f,REC_MODIFYTIME = GETDATE() where id =\u003f
InfoMgrDAO_008 = INSERT INTO I_QtContent(QuotationId,infoContent,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE());
InfoMgrDAO_009 = UPDATE I_QtContent SET infoContent =\u003f,REC_MODIFYBY =\u003f,REC_MODIFYTIME = GETDATE() where QuotationId =\u003f
InfoMgrDAO_010 = UPDATE I_QtRelation SET relationId =\u003f where QuotationId =\u003f and relationType =\u003f
InfoMgrDAO_011 = UPDATE I_Quotation SET infoStatus = 0  where id = \u003f
InfoMgrDAO_012 = SELECT relationId FROM I_QtRelation iqr LEFT JOIN I_InfoTag iit ON iit.id = iqr.relationId where iqr.QuotationId =\u003f and iqr.relationType =\u003f and iit.tagTypeDiff = \u003f
InfoMgrDAO_013 = delete  FROM I_QtRelation where QuotationId =\u003f and relationType = \u003f
InfoMgrDAO_014 = SELECT *\u3000FROM I_InfoCatogory where parentId = \u003f and catogorySts = 1
InfoMgrDAO_015 = SELECT *\u3000FROM I_InfoCatogory where id = \u003f and catogorySts = 1
#\u5e7f\u544a\u76f8\u5173#
InfoMgrDAO_016 = SELECT id,catogoryName\u3000 FROM I_InfoCatogory where id in 
InfoMgrDAO_017 = SELECT iqt.*,iif.catogoryName  as adverName FROM I_Quotation iqt INNER JOIN I_QtRelation iqr ON iqr.QuotationId = iqt.id INNER JOIN I_InfoCatogory iif ON iif.id = iqr.relationId WHERE iqr.relationType = 3 
InfoMgrDAO_018 = INSERT INTO I_Quotation(title,infoKeyword,infoLinkId,infoStatus,postTime,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,infoOrder)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f) SELECT @@IDENTITY AS returnName
InfoMgrDAO_019 = UPDATE I_Quotation SET title=\u003f,infoLinkId=\u003f,infoStatus=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f,infoOrder=\u003f where id=\u003f
InfoMgrDAO_020 = SELECT iqt.*,iif.catogoryName as adverName,iif.id as adverCatogoryID FROM I_Quotation iqt INNER JOIN I_QtRelation iqr ON iqr.QuotationId = iqt.id INNER JOIN I_InfoCatogory iif ON iif.id = iqr.relationId WHERE iqr.relationType = 3 and  iqt.id = \u003f
InfoMgrDAO_021 = SELECT relationId FROM I_QtRelation where QuotationId =\u003f and relationType =\u003f
InfoMgrDAO_022 = SELECT * FROM I_InfoCatogory where 1=1  and catogorySts = 1 
InfoMgrDAO_023 = SELECT * FROM (SELECT iqt.id, iqt.title, iqt.infoKeyword, iqt.infoLinkId, iqt.infoStatus, iqt.postTime, iqt.REC_CREATEBY, iqt.REC_CREATETIME, iqt.REC_MODIFYBY, iqt.REC_MODIFYTIME, infoCatogory.CatogoryName AS infoCatogorys, iqr.relationType AS relationType FROM I_Quotation iqt LEFT JOIN I_QtContent iqc ON iqt.id = iqc.QuotationId LEFT JOIN I_QtRelation iqr ON iqr.QuotationId = iqt.id LEFT JOIN I_InfoCatogory infoCatogory ON infoCatogory.id = iqr.relationId) info WHERE 1=1 AND info.relationType=3
InfoOraDAO_001=select * from (select *from (select a.tradetime,a.commodityid,c.name as commodityName,a.price,  a.quantity,  c.contractfactor,  a.quantity*c.contractfactor as totalquantity,   nvl(c.manufacturers,' ') as manufacturers,  nvl(c.propertiesorigin,' ') as propertiesorigin,  m.breedname from T_H_Trade a, t_commodity c, t_a_breed m where m.breedid = c.breedid and a.commodityid = c.commodityid) union select *   from (select a.tradetime,  a.commodityid,  c.name,  a.price,  a.quantity,  c.contractfactor,  a.quantity*c.contractfactor as totalquantity,    nvl(c.manufacturers,' ') as manufacturers,  nvl(c.propertiesorigin,' ') as propertiesorigin,  m.breedname from T_Trade a, t_commodity c, t_a_breed m where m.breedid = c.breedid  and a.commodityid = c.commodityid)) t21 where 1=1
QueDAO_001=select t.id, t.mqType, t.mqDeliverydate, t.mqPrice, t.mqWave, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from I_MarketQuo t where 1=1
QueDAO_002=select t.id, t.mqType, t.mqDeliverydate, t.mqPrice, t.mqWave, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from I_MarketQuo t where t.id=\u003f
QueDAO_003=select t.id, t.mqType, t.mqDeliverydate, t.mqPrice, t.mqWave, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from I_MarketQuo t where t.REC_MODIFYTIME>=\u003f and t.REC_MODIFYTIME<=\u003f
QueDAO_004=insert into I_MarketQuo (mqType, mqDeliverydate, mqPrice, mqWave, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
QueDAO_005=update I_MarketQuo set mqType=\u003f,mqDeliverydate=\u003f,mqPrice=\u003f,mqWave=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=getDate() where id=\u003f
QueDAO_006=delete from I_MarketQuo where id=\u003f
CtgDAO_001=select t.id, t.parentId, t.catogoryName, t.catogorySts, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from I_InfoCatogory t where 1=1 and t.catogorySts=1 order by t.parentId
CtgDAO_002=select t.id, t.parentId, t.catogoryName, t.catogorySts, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from I_InfoCatogory t where t.id=\u003f and t.catogorySts=1
CtgDAO_003=insert into I_InfoCatogory (parentId, catogoryName, catogorySts, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate()) select @@identity
CtgDAO_004=update I_InfoCatogory set parentId=\u003f,catogoryName=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=getDate() where id=\u003f
CtgDAO_005=update I_InfoCatogory set catogorySts=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=getDate() where id=\u003f
ScemQuoDAO_001=select t.id, t.sqDate, t.sqProduct, t.sqRank, t.sqNo, t.sqType, t.sqFactory, t.sqTag, t.sqArea, t.sqMinPrice, t.sqMaxPrice, t.sqDropRange, t.sqUpRange, t.REC_CREATEBY, t.REC_CREATETIME from I_ScemQuo t where 1=1
ScemQuoDAO_002=select count(t.sqDate) from I_ScemQuo t where t.sqDate <= \u003f and t.sqTag = \u003f
ScemQuoDAO_003=delete from I_ScemQuo where sqDate <= \u003f and sqTag = \u003f
ScemQuoDAO_004=delete from I_ScemQuoHistory where sqDate = \u003f and sqTag = \u003f
ScemQuoDAO_005=insert into I_ScemQuo(sqDate,sqProduct,sqRank,sqNo,sqType,sqFactory,sqTag,sqArea,sqMinPrice,sqMaxPrice,sqDropRange,sqUpRange,REC_CREATEBY,REC_CREATETIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate())
ScemQuoDAO_006=insert into I_ScemQuoHistory(sqDate,sqProduct,sqRank,sqNo,sqType,sqFactory,sqTag,sqArea,sqMinPrice,sqMaxPrice,sqDropRange,sqUpRange,REC_CREATEBY,REC_CREATETIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate())
ScemQuoDAO_007=select count(*) from I_ScemQuo where sqTag = \u003f
ScemQuoDAO_008=select t.id, t.sqDate, t.sqProduct, t.sqRank, t.sqNo, t.sqType, t.sqFactory, t.sqTag, t.sqArea, t.sqMinPrice, t.sqMaxPrice, t.sqDropRange, t.sqUpRange, t.REC_CREATEBY, t.REC_CREATETIME from I_ScemQuo t where t.id=\u003f
ScemQuoDAO_009=update I_ScemQuo set sqMinPrice=\u003f, sqMaxPrice=\u003f, sqDropRange=\u003f, sqUpRange=\u003f, REC_CREATEBY=\u003f, REC_CREATETIME=getDate() where id=\u003f
ScemQuoDAO_010=select s.* from I_ScemQuo s, I_ScemQuoHistory h where s.sqDate=h.sqDate and s.sqProduct=h.sqProduct and s.sqRank=h.sqRank and s.sqNo=h.sqNo and s.sqType=h.sqType and s.sqFactory=h.sqFactory and s.sqTag=h.sqTag and s.sqArea=h.sqArea and s.sqMinPrice=h.sqMinPrice and s.sqMaxPrice=h.sqMaxPrice and s.sqDropRange=h.sqDropRange and s.sqUpRange=h.sqUpRange and s.REC_CREATEBY=h.REC_CREATEBY and h.id=\u003f
ScemQuoHistoryDAO_001=select t.id, t.sqDate, t.sqProduct, t.sqRank, t.sqNo, t.sqType, t.sqFactory, t.sqTag, t.sqArea, t.sqMinPrice, t.sqMaxPrice, t.sqDropRange, t.sqUpRange, t.REC_CREATEBY, t.REC_CREATETIME from I_ScemQuoHistory t where 1=1
ScemQuoHistoryDAO_002=select t.id, t.sqDate, t.sqProduct, t.sqRank, t.sqNo, t.sqType, t.sqFactory, t.sqTag, t.sqArea, t.sqMinPrice, t.sqMaxPrice, t.sqDropRange, t.sqUpRange, t.REC_CREATEBY, t.REC_CREATETIME from I_ScemQuoHistory t where t.id=\u003f
ScemQuoHistoryDAO_003=update I_ScemQuoHistory set sqMinPrice=\u003f, sqMaxPrice=\u003f, sqDropRange=\u003f, sqUpRange=\u003f, REC_CREATEBY=\u003f, REC_CREATETIME=getDate() where id=\u003f
TradeTemplateDAO_001=select t.TradeTmptId, t.TradeTmptName, t.Authority_B, t.Authority_S, t.FEEALGR, t.FEERATE_B, t.FEERATE_S, t.SETTLEFEEALGR, t.SETTLEFEERATE_B, t.SETTLEFEERATE_S, t.MARGINALGR, t.MARGINRATE_B, t.MARGINRATE_S, t.SETTLEMARGINALGR_B, t.SETTLEMARGINRATE_B, t.SETTLEMARGINALGR_S, t.SETTLEMARGINRATE_S, t.PAYOUTALGR, t.PAYOUTRATE, t.StartTime, t.EndTime, t.RunType, t.DISABLED, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME, t.PublishDiff,t.TradeType,t.LatestDeliveryType,t.LatestDeliveryDay,t.SellerLateFeeType,t.SellerLateFee,t.BuyerLateFeeType,t.BuyerLateFee,t.SellerBreakPromiseType,t.SellerBreakPromise,t.BuyerBreakPromiseType,t.BuyerBreakPromise,t.BuyerBreakProFeeTypeT0,t.BuyerBreakProFeeT0,t.BuyerRecBreakProFeeT0Type,t.BuyerRecBreakProFeeT0,t.BuyerBreakProFeeTNType,t.BuyerBreakProFeeTN,t.BuyerRecBreakProFeeTNType,t.BuyerRecBreakProFeeTN,t.SellerBreakProFeeT0Type,t.SellerBreakProFeeT0,t.SellerRecBreakProFeeT0Type,t.SellerRecBreakProFeeT0,t.SellerBreakProFeeTNType,t.SellerBreakProFeeTN,t.SellerRecBreakProFeeTNType,t.SellerRecBreakProFeeTN,t.IsSinopecExtend,t.BuyerBreakPromiseTypeExtend,t.BuyerBreakPromiseExtend,t.BuyerReceiptUploadType,t.BuyerReceiptUpload,t.SellerSinopecDistributionType,t.SellerSinopecDistribution from T_TradeTemplate t where 1=1
TradeTemplateDAO_002=select t.TradeTmptId, t.TradeTmptName, t.Authority_B, t.Authority_S, t.FEEALGR, t.FEERATE_B, t.FEERATE_S, t.SETTLEFEEALGR, t.SETTLEFEERATE_B, t.SETTLEFEERATE_S, t.MARGINALGR, t.MARGINRATE_B, t.MARGINRATE_S, t.SETTLEMARGINALGR_B, t.SETTLEMARGINRATE_B, t.SETTLEMARGINALGR_S, t.SETTLEMARGINRATE_S, t.PAYOUTALGR, t.PAYOUTRATE, t.StartTime, t.EndTime, t.RunType, t.DISABLED, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME, t.PublishDiff,t.TradeType,t.LatestDeliveryType,t.LatestDeliveryDay,t.SellerLateFeeType,t.SellerLateFee,t.BuyerLateFeeType,t.BuyerLateFee,t.SellerBreakPromiseType,t.SellerBreakPromise,t.BuyerBreakPromiseType,t.BuyerBreakPromise,t.BuyerBreakProFeeTypeT0,t.BuyerBreakProFeeT0,t.BuyerRecBreakProFeeT0Type,t.BuyerRecBreakProFeeT0,t.BuyerBreakProFeeTNType,t.BuyerBreakProFeeTN,t.BuyerRecBreakProFeeTNType,t.BuyerRecBreakProFeeTN,t.SellerBreakProFeeT0Type,t.SellerBreakProFeeT0,t.SellerRecBreakProFeeT0Type,t.SellerRecBreakProFeeT0,t.SellerBreakProFeeTNType,t.SellerBreakProFeeTN,t.SellerRecBreakProFeeTNType,t.SellerRecBreakProFeeTN,t.IsSinopecExtend,t.BuyerBreakPromiseTypeExtend,t.BuyerBreakPromiseExtend,t.BuyerReceiptUploadType,t.BuyerReceiptUpload,t.SellerSinopecDistributionType,t.SellerSinopecDistribution from T_TradeTemplate t where t.TradeTmptId=\u003f
TradeTemplateDAO_003=insert into T_TradeTemplate (TradeTmptId, TradeTmptName, Authority_B, Authority_S, FEEALGR, FEERATE_B, FEERATE_S, SETTLEFEEALGR, SETTLEFEERATE_B, SETTLEFEERATE_S, MARGINALGR, MARGINRATE_B, MARGINRATE_S, SETTLEMARGINALGR_B, SETTLEMARGINRATE_B, SETTLEMARGINALGR_S, SETTLEMARGINRATE_S, PAYOUTALGR, PAYOUTRATE, StartTime, EndTime, RunType, DISABLED, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME, PublishDiff,TradeType,LatestDeliveryType,LatestDeliveryDay,SellerLateFeeType,SellerLateFee,BuyerLateFeeType,BuyerLateFee,SellerBreakPromiseType,SellerBreakPromise,BuyerBreakPromiseType,BuyerBreakPromise,BuyerBreakProFeeTypeT0,BuyerBreakProFeeT0,BuyerRecBreakProFeeT0Type,BuyerRecBreakProFeeT0,BuyerBreakProFeeTNType,BuyerBreakProFeeTN,BuyerRecBreakProFeeTNType,BuyerRecBreakProFeeTN,SellerBreakProFeeT0Type,SellerBreakProFeeT0,SellerRecBreakProFeeT0Type,SellerRecBreakProFeeT0,SellerBreakProFeeTNType,SellerBreakProFeeTN,SellerRecBreakProFeeTNType,SellerRecBreakProFeeTN) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
TradeTemplateDAO_004=update T_TradeTemplate set TradeTmptName=\u003f, Authority_B=\u003f, Authority_S=\u003f, FEEALGR=\u003f, FEERATE_B=\u003f, FEERATE_S=\u003f, SETTLEFEEALGR=\u003f, SETTLEFEERATE_B=\u003f, SETTLEFEERATE_S=\u003f, MARGINALGR=\u003f, MARGINRATE_B=\u003f, MARGINRATE_S=\u003f, SETTLEMARGINALGR_B=\u003f, SETTLEMARGINRATE_B=\u003f, SETTLEMARGINALGR_S=\u003f, SETTLEMARGINRATE_S=\u003f, PAYOUTALGR=\u003f, PAYOUTRATE=\u003f, StartTime=\u003f, EndTime=\u003f, RunType=\u003f, DISABLED=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate(), PublishDiff=\u003f,TradeType= \u003f,LatestDeliveryType= \u003f,LatestDeliveryDay= \u003f,SellerLateFeeType= \u003f,SellerLateFee= \u003f,BuyerLateFeeType= \u003f,BuyerLateFee= \u003f,SellerBreakPromiseType= \u003f,SellerBreakPromise= \u003f,BuyerBreakPromiseType= \u003f,BuyerBreakPromise= \u003f,BuyerBreakProFeeTypeT0= \u003f,BuyerBreakProFeeT0= \u003f,BuyerRecBreakProFeeT0Type= \u003f,BuyerRecBreakProFeeT0= \u003f,BuyerBreakProFeeTNType= \u003f,BuyerBreakProFeeTN= \u003f,BuyerRecBreakProFeeTNType= \u003f,BuyerRecBreakProFeeTN= \u003f,SellerBreakProFeeT0Type= \u003f,SellerBreakProFeeT0= \u003f,SellerRecBreakProFeeT0Type= \u003f,SellerRecBreakProFeeT0= \u003f,SellerBreakProFeeTNType= \u003f,SellerBreakProFeeTN= \u003f,SellerRecBreakProFeeTNType= \u003f,SellerRecBreakProFeeTN= \u003f,IsSinopecExtend= \u003f,BuyerBreakPromiseTypeExtend= \u003f,BuyerBreakPromiseExtend= \u003f,BuyerReceiptUploadType= \u003f,BuyerReceiptUpload= \u003f,SellerSinopecDistributionType= \u003f,SellerSinopecDistribution= \u003f where TradeTmptId=\u003f
TradeTemplateDAO_005=select t.id, t.TradeTmptId, t.TradeDirector, t.SetALGR, t.SetAmount, t.AddSetALGR, t.AddSetAmount, t.DISABLED, t.REC_CREATEBY, t.REC_CREATETIME,t.REC_MODIFYBY, t.REC_MODIFYTIME,\nt2.ValueID as ExpandSetType, t3.ValueID as DeliveryDay\n  from T_TradeTemplateSpecialTradeDeposit t, C_Dictionary t2, C_Dictionary t3\n where t.DISABLED \= 0\nand t2.DISABLED \= 0\nand t3.DISABLED \= 0\n   AND t.TradeTmptId \= ?\n   and t2.DictID \= t.ExpandSetType\nand t3.DictID \= t.DeliveryDay
TradeTemplateDAO_006=update T_TradeTemplateSpecialTradeDeposit set SetALGR=\u003f,SetAmount=\u003f,AddSetALGR=\u003f,AddSetAmount=\u003f,REC_MODIFYBY =\u003f,REC_MODIFYTIME=getDate()  where DISABLED = 0 and ID=\u003f
 
TradeTimeDAO_001=select t.SectionId, t.SectionName, t.StartTime, t.EndTime, t.Status, t.Remarks, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_TradeTime t where 1=1
TradeTimeDAO_002=select t.SectionId, t.SectionName, t.StartTime, t.EndTime, t.Status, t.Remarks, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_TradeTime t where t.SectionId=\u003f
TradeTimeDAO_003=insert into T_TradeTime (SectionName, StartTime, EndTime, Status, Remarks, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
TradeTimeDAO_004=update T_TradeTime set SectionName=\u003f, StartTime=\u003f, EndTime=\u003f, Status=\u003f, Remarks=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate() where SectionId=\u003f
TradeTimeDAO_005=delete from T_TradeTime where SectionId=\u003f
NotTradeDay_001=select * from t_nottradeday t where t.id=\u003f
NotTradeDay_002=update t_notTradeDay set week=\u003f,day=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GetDate() where id=\u003f
TmptSectionRlspDAO_001=select t.TradeTmptId, t.SectionId, t.Enabled from A_TmptSectionRlsp t where 1=1
TmptSectionRlspDAO_002=select count(*) as isHave from A_TmptSectionRlsp where SectionId=\u003f and Enabled='Y'
TmptSectionRlspDAO_003=select count(*) as isHave from A_TmptSectionRlsp where SectionId=\u003f and Enabled='N'
TmptSectionRlspDAO_004=update A_TmptSectionRlsp set Enabled=\u003f where TradeTmptId=\u003f and SectionId=\u003f
TmptSectionRlspDAO_005=delete from A_TmptSectionRlsp where SectionId=\u003f and Enabled='N'
TmptSectionRlspDAO_006=delete from A_TmptSectionRlsp where TradeTmptId=\u003f and SectionId=\u003f
TmptSectionRlspDAO_007=insert into A_TmptSectionRlsp (TradeTmptId, SectionId, Enabled) values (\u003f,\u003f,\u003f)
TmptSectionRlspDAO_008=select count(*) as isHave from A_TmptSectionRlsp where TradeTmptId=\u003f and Enabled='Y'
TmptSectionRlspDAO_009=select count(*) as isHave from A_TmptSectionRlsp where TradeTmptId=\u003f and Enabled='N'
FirmSpecialFeeDAO_001=select t.* ,cf.FirmName as firmName,vm_c.CategoryName as categoryName,vm_b.BrandName as brandName from T_FirmSpecialFee t LEFT JOIN C_Firm cf on cf.FirmID = t.FirmID LEFT JOIN VW_Crm_CategorySpecial vm_c ON vm_c.ID = t.CategoryId LEFT JOIN VW_Crm_Brand vm_b ON vm_b.ID = t.BrandId where 1=1
FirmSpecialFeeDAO_002=select t.Id, t.FirmID, t.CategoryId,categorySpecial.CategoryName as categoryName, t.BrandId, t.TradeTmptId, t.FEEALGR, t.FEERATE_B, t.FEERATE_S, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_FirmSpecialFee t LEFT JOIN VW_Crm_CategorySpecial categorySpecial ON categorySpecial.ID = t.CategoryId where t.Id=\u003f
FirmSpecialFeeDAO_003=insert into T_FirmSpecialFee (FirmID, CategoryId, BrandId, TradeTmptId, FEEALGR, FEERATE_B, FEERATE_S, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
FirmSpecialFeeDAO_004=update T_FirmSpecialFee set FEEALGR=\u003f, FEERATE_B=\u003f, FEERATE_S=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate() where Id=\u003f
FirmSpecialFeeDAO_005=delete from T_FirmSpecialFee 
FirmSpecialMarginDAO_001=select t.*,cf.FirmName as firmName,vm_c.CategoryName as categoryName,vm_b.BrandName as brandName from T_FirmSpecialMargin t LEFT JOIN C_Firm cf on cf.FirmID = t.FirmID LEFT JOIN VW_Crm_CategorySpecial vm_c ON vm_c.ID = t.CategoryId LEFT JOIN VW_Crm_Brand vm_b ON vm_b.ID = t.BrandId where 1=1 
FirmSpecialMarginDAO_002=select t.Id, t.FirmID, t.CategoryId, t.BrandId, t.TradeTmptId, t.MARGINALGR, t.MARGINRATE_B, t.MARGINRATE_S, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_FirmSpecialMargin t where t.Id=\u003f
FirmSpecialMarginDAO_003=insert into T_FirmSpecialMargin (FirmID, CategoryId, BrandId, TradeTmptId, MARGINALGR, MARGINRATE_B, MARGINRATE_S, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
FirmSpecialMarginDAO_004=update T_FirmSpecialMargin set MARGINALGR=\u003f, MARGINRATE_B=\u003f, MARGINRATE_S=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate() where Id=\u003f
FirmSpecialMarginDAO_005=delete from T_FirmSpecialMargin
FirmSpecialSettleFeeDAO_001=select t.*,cf.FirmName as firmName,vm_c.CategoryName as categoryName,vm_b.BrandName as brandName  from T_FirmSpecialSettleFee t LEFT JOIN C_Firm cf on cf.FirmID = t.FirmID LEFT JOIN VW_Crm_CategorySpecial vm_c ON vm_c.ID = t.CategoryId LEFT JOIN VW_Crm_Brand vm_b ON vm_b.ID = t.BrandId where 1=1
FirmSpecialSettleFeeDAO_002=select t.Id, t.FirmID, t.CategoryId, t.BrandId, t.TradeTmptId, t.SETTLEFEEALGR, t.SETTLEFEERATE_B, t.SETTLEFEERATE_S, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_FirmSpecialSettleFee t where t.Id=\u003f
FirmSpecialSettleFeeDAO_003=insert into T_FirmSpecialSettleFee (FirmID, CategoryId, BrandId, TradeTmptId, SETTLEFEEALGR, SETTLEFEERATE_B, SETTLEFEERATE_S, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
FirmSpecialSettleFeeDAO_004=update T_FirmSpecialSettleFee set SETTLEFEEALGR=\u003f, SETTLEFEERATE_B=\u003f, SETTLEFEERATE_S=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate()  where Id=\u003f
FirmSpecialSettleFeeDAO_005=delete from T_FirmSpecialSettleFee 
FirmSpecialSettleMarginDAO_001=select t.*,cf.FirmName as firmName,vm_c.CategoryName as categoryName,vm_b.BrandName as brandName   from T_FirmSpecialSettleMargin t LEFT JOIN C_Firm cf on cf.FirmID = t.FirmID LEFT JOIN VW_Crm_CategorySpecial vm_c ON vm_c.ID = t.CategoryId LEFT JOIN VW_Crm_Brand vm_b ON vm_b.ID = t.BrandId where 1=1
FirmSpecialSettleMarginDAO_002=select t.Id, t.FirmID, t.CategoryId, t.BrandId, t.TradeTmptId, t.SETTLEMARGINALGR_B, t.SETTLEMARGINRATE_B, t.SETTLEMARGINALGR_S, t.SETTLEMARGINRATE_S, t.PAYOUTALGR, t.PAYOUTRATE, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_FirmSpecialSettleMargin t where t.Id=\u003f
FirmSpecialSettleMarginDAO_003=insert into T_FirmSpecialSettleMargin (FirmID, CategoryId, BrandId, TradeTmptId, SETTLEMARGINALGR_B, SETTLEMARGINRATE_B, SETTLEMARGINALGR_S, SETTLEMARGINRATE_S, PAYOUTALGR, PAYOUTRATE, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
FirmSpecialSettleMarginDAO_004=update T_FirmSpecialSettleMargin set SETTLEMARGINALGR_B=\u003f, SETTLEMARGINRATE_B=\u003f, SETTLEMARGINALGR_S=\u003f, SETTLEMARGINRATE_S=\u003f, PAYOUTALGR=\u003f, PAYOUTRATE=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate() where Id=\u003f
FirmSpecialSettleMarginDAO_005=delete from T_FirmSpecialSettleMargin 
TemplatePrivilegeDAO_001=SELECT * FROM (select t.Id, t.TradeTmptId,tradeTemplate.TradeTmptName as tradeTmptName,t.CategoryId,categorySpecial.CategoryName as categoryName,t.BrandId,brand.BrandName as brandName,t.PRIVILEGECODE_B, t.PRIVILEGECODE_S from T_TemplatePrivilege t left join VW_Crm_CategorySpecial categorySpecial ON categorySpecial.ID = t.CategoryId left join VW_Crm_Brand brand ON brand.ID = t.BrandId left join T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId = t.TradeTmptId) temp where 1=1
TemplatePrivilegeDAO_002=select t.Id, t.TradeTmptId,tradeTemplate.TradeTmptName as tradeTmptName,t.CategoryId,categorySpecial.CategoryName as categoryName,t.BrandId,brand.BrandName as brandName,t.PRIVILEGECODE_B, t.PRIVILEGECODE_S from T_TemplatePrivilege t left join VW_Crm_CategorySpecial categorySpecial ON categorySpecial.ID = t.CategoryId left join VW_Crm_Brand brand ON brand.ID = t.BrandId left join T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId = t.TradeTmptId where t.Id=\u003f
TemplatePrivilegeDAO_003=insert into T_TemplatePrivilege (TradeTmptId, CategoryId, BrandId, PRIVILEGECODE_B, PRIVILEGECODE_S) values (\u003f,\u003f,\u003f,\u003f,\u003f)
TemplatePrivilegeDAO_004=update T_TemplatePrivilege set TradeTmptId=\u003f, CategoryId=\u003f, BrandId=\u003f, PRIVILEGECODE_B=\u003f, PRIVILEGECODE_S=\u003f where Id=\u003f
TemplatePrivilegeDAO_005=delete from T_TemplatePrivilege where Id=\u003f
TemplatePrivilegeDAO_006=delete from T_TemplatePrivilege where TradeTmptId=\u003f and CategoryId = \u003f
FirmPrivilegeDAO_001=SELECT * FROM(select t.Id, t.TradeTmptId,tradeTemplate.TradeTmptName as tradeTmptName, t.FirmID,firm.FirmName as firmName, t.CategoryId,categorySpecial.CategoryName as categoryName, t.BrandId,brand.BrandName as brandName, t.PRIVILEGECODE_B, t.PRIVILEGECODE_S from T_FirmPrivilege t left join VW_Crm_CategorySpecial categorySpecial ON categorySpecial.ID = t.CategoryId left join VW_Crm_Brand brand ON brand.ID = t.BrandId left join T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId = t.TradeTmptId LEFT JOIN C_Firm firm ON firm.FirmID = t.FirmID) temp where 1=1
FirmPrivilegeDAO_002=select t.Id, t.TradeTmptId,tradeTemplate.TradeTmptName as tradeTmptName, t.FirmID,firm.FirmName as firmName, t.CategoryId,categorySpecial.CategoryName as categoryName, t.BrandId,brand.BrandName as brandName, t.PRIVILEGECODE_B, t.PRIVILEGECODE_S from T_FirmPrivilege t left join VW_Crm_CategorySpecial categorySpecial ON categorySpecial.ID = t.CategoryId left join VW_Crm_Brand brand ON brand.ID = t.BrandId left join T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId = t.TradeTmptId LEFT JOIN C_Firm firm ON firm.FirmID = t.FirmID where t.Id=\u003f
FirmPrivilegeDAO_003=insert into T_FirmPrivilege (TradeTmptId, FirmID, CategoryId, BrandId, PRIVILEGECODE_B, PRIVILEGECODE_S) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
FirmPrivilegeDAO_004=update T_FirmPrivilege set TradeTmptId=\u003f, FirmID=\u003f, CategoryId=\u003f, BrandId=\u003f, PRIVILEGECODE_B=\u003f, PRIVILEGECODE_S=\u003f where Id=\u003f
FirmPrivilegeDAO_005=delete from T_FirmPrivilege where Id=\u003f
FirmPrivilegeDAO_006=delete from T_FirmPrivilege where FirmID=\u003f
FirmPrivilegeDAO_007=delete from T_FirmPrivilege where FirmID=\u003f and TradeTmptId=\u003f and CategoryId = \u003f
FirmPrivilegeDAO_008=select count(*) from T_FirmPrivilege a where a.TradeTmptId = \u003f and a.FirmID = \u003f and a.CategoryId = \u003f and a.BrandId = \u003f
TraderPrivilegeDAO_001=select t.Id, t.TradeTmptId, t.TraderID, t.CategoryId, t.BrandId, t.PRIVILEGECODE_B, t.PRIVILEGECODE_S from T_TraderPrivilege t where 1=1
TraderPrivilegeDAO_002=select t.Id, t.TradeTmptId, t.TraderID, t.CategoryId, t.BrandId, t.PRIVILEGECODE_B, t.PRIVILEGECODE_S from T_TraderPrivilege t where t.Id=\u003f
TraderPrivilegeDAO_003=insert into T_TraderPrivilege (TradeTmptId, TraderID, CategoryId, BrandId, PRIVILEGECODE_B, PRIVILEGECODE_S) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
TraderPrivilegeDAO_004=update T_TraderPrivilege set TradeTmptId=\u003f, TraderID=\u003f, CategoryId=\u003f, BrandId=\u003f, PRIVILEGECODE_B=\u003f, PRIVILEGECODE_S=\u003f where Id=\u003f
TraderPrivilegeDAO_005=delete from T_TraderPrivilege where Id=\u003f
#\u8d44\u91d1\u6d41\u6c34\u76f8\u5173#
FundFlowDAO_001 = SELECT fff.*,cf.FirmName as firmName,fs.SUMMARY as summary FROM F_FundFlow fff INNER JOIN C_Firm cf ON cf.FirmID = fff.FIRMID INNER JOIN F_Voucher fv ON fv.VOUCHERNO = fff.VOUCHERNO INNER JOIN F_Summary fs ON fs.SUMMARYNO = fv.SUMMARYNO WHERE 1=1
LeadsDAO_001=select CAST(cargo.CargoAgentSimpleName as VARCHAR)+'-'+ CAST(cargo.CargoLinkName as VARCHAR)+'-'+ CAST(cargo.CargoLinkMobile as VARCHAR) as cargoAgentDetail,t.*,t2.FirmName as firmName,t3.CategoryName as categoryLeafName,t4.BrandName as brandName,t6.pvName + t6.ctName + t6.dtName + t6.Address as addressName,       t7.Name as deliveryPlaceName ,t8.Name as sourcePlaceName   from T_Leads t  left join C_Firm t2    on t.FirmId = t2.FirmID  left join VW_Crm_CategorySpecial t3    on t.CategoryLeafID = t3.ID left join VW_Crm_Brand t4    on t.BrandID = t4.ID left join (select t11.id,                    t11.Address,                    t12.ShortName as pvName,                    t13.ShortName as ctName,                    t14.ShortName as dtName               from C_Address t11               left join vw_Canton t12                 on t11.AddPV = t12.ID               left join vw_Canton t13                 on t11.AddCT = t13.ID               left join vw_Canton t14                 on t11.AddDT = t14.ID) t6    on t.AddressID = t6.ID  left join VW_Crm_DeliveryPlace t7 on t.DeliveryPlaceId = t7.ID left join VW_Crm_SourcePlace t8 on t.SourcePlaceID=t8.ID   LEFT JOIN T_CargoAgent cargo ON t.CargoAgentID = cargo.ID  where t.id=\u003f
LeadsDAO_002=SELECT * FROM ( SELECT CAST ( cargo.CargoAgentSimpleName AS VARCHAR ) + '-' + CAST ( cargo.CargoLinkName AS VARCHAR ) + '-' + CAST ( cargo.CargoLinkMobile AS VARCHAR ) AS cargoAgentDetail, t.LeadsCode AS leads_serviceNm, t.TraderId AS tradeID, t.*, t3.CategoryName AS categoryLeafName, t4.BrandName AS brandName, t2.FirmName AS firmName, CAST (t3.CategoryName AS VARCHAR) + '-' + CAST (t4.BrandName AS VARCHAR) AS goodName, t6.pvName + t6.ctName + t6.dtName + t6.Address AS addressName, t7.Name AS deliveryPlaceName, t8.Name AS sourcePlaceName, t9.TradeTmptName AS tradeTmptName, t9.TradeType,t10.LinerType as linerType FROM T_Leads t LEFT JOIN C_Firm t2 ON t.FirmId = t2.FirmID LEFT JOIN VW_Crm_CategorySpecial t3 ON t.CategoryLeafID = t3.ID LEFT JOIN VW_Crm_Brand t4 ON t.BrandID = t4.ID LEFT JOIN ( SELECT t11.id, t11.Address, t12.ShortName AS pvName, t13.ShortName AS ctName, t14.ShortName AS dtName FROM C_Address t11 LEFT JOIN vw_Canton t12 ON t11.AddPV = t12.ID LEFT JOIN vw_Canton t13 ON t11.AddCT = t13.ID LEFT JOIN vw_Canton t14 ON t11.AddDT = t14.ID ) t6 ON t.AddressID = t6.ID LEFT JOIN VW_Crm_DeliveryPlace t7 ON t.DeliveryPlaceId = t7.ID LEFT JOIN VW_Crm_SourcePlace t8 ON t.SourcePlaceID = t8.ID LEFT JOIN T_TradeTemplate t9 ON t.TradeTmptId = t9.TradeTmptId LEFT JOIN T_CargoAgent cargo ON t.CargoAgentID = cargo.ID LEFT JOIN T_LeadsExpand_Liner t10 ON t.ID = t10.LeadsID WHERE t.PaymentStatus != 0 ) TEMP WHERE 1 = 1
LeadsDAO_003=SELECT templatePrice.*,logisticsTemplatePrice.Price as templatePrice from T_Leads_TemplatePrice templatePrice LEFT JOIN T_LogisticsTemplatePrice logisticsTemplatePrice on logisticsTemplatePrice.ID = templatePrice.TemplatePriceID where templatePrice.LeadsID = \u003f
LeadsDAO_004=SELECT * FROM ( SELECT t.LeadsCode AS leadsCode, t.GoodsType AS goodsType, CAST(t4.BrandName AS VARCHAR) AS brand, CAST(t3.CategoryName AS VARCHAR) AS categoryLeafName, CAST(t3.CategoryName AS VARCHAR) + '-' + CAST(t4.BrandName AS VARCHAR) AS goodsName, t8.NAME AS sourcePlaceName, (t.Quantity + t.DealtQuantity) * t.TradeUnitNumber AS totalQuantity, t.Quantity * t.TradeUnitNumber AS availableQuantity, t.price AS price, t.SettlementMethod AS settlementMethod, t.DeliveryEndDate AS settlementDate, t7. NAME AS deliveryPlaceName, t2.FirmName AS firmName, t.firmid AS firmCode, t.TraderId AS traderCode, t.UserCode AS userCode, t5.UserName AS userName, t.REC_CREATETIME AS createTime, t.LeadsStatus AS leadsStatus FROM T_Leads t LEFT JOIN C_Firm t2 ON t.FirmId = t2.FirmID LEFT JOIN VW_Crm_CategorySpecial t3 ON t.CategoryLeafID = t3.ID LEFT JOIN VW_Crm_Brand t4 ON t.BrandID = t4.ID LEFT JOIN C_USER t5 ON t5.UserCode = t.UserCode LEFT JOIN VW_Crm_DeliveryPlace t7 ON t.DeliveryPlaceId = t7.ID LEFT JOIN VW_Crm_SourcePlace t8 ON t.SourcePlaceID = t8.ID ) TEMP WHERE 1 = 1 and leadsCode is not null 

LeadsDAO_005 = {call Proc_SP_GetLeadsList_LLDPE(?,?,?,?,?,?,?)}
# liner
LeadsDAO_006=select  tEnquiry.EnquiryId as enqid, tEnquiry.EnquiryStatus as enqsts,tEnquiry.Quantity as enqqnt, tEnquiryExpand.id as enqexpid, tEnquiryExpand.LinerEffectTime as enqexpTime, tLeads.ID as leadid, tLeads.LeadsStatus as leadsts,tLeads.Quantity as leadqnt, tLeadsExpand.id as leadexpid, tLeadsExpand.LinerEffectTime as leadexpTime,tLeadsExpand.RiseMoney as risemoney from T_Enquiry tEnquiry left join T_EnquiryExpand_Liner tEnquiryExpand on tEnquiryExpand.EnquiryId = tEnquiry.EnquiryId left join T_Leads tLeads on tLeads.ID = tEnquiry.LeadsID and tLeads.LeadsStatus=0 left join T_LeadsExpand_Liner tLeadsExpand on tLeadsExpand.LeadsID = tEnquiry.LeadsID where tEnquiry.EnquiryStatus=1 and tEnquiry.EnquiryId = \u003f
LeadsDAO_007=update T_Leads set Quantity=Quantity-\u003f, LockQuantity=LockQuantity+\u003f where ID = \u003f
LeadsDAO_008=update T_Enquiry set EnquiryStatus=8 where EnquiryId=\u003f
LeadsDAO_009=update T_EnquiryExpand_Liner set LeadsRiseMoney=\u003f where ID=\u003f

OrderDAO_001=SELECT CAST ( cargo.CargoAgentSimpleName AS VARCHAR ) + '-' + CAST ( cargo.CargoLinkName AS VARCHAR ) + '-' + CAST ( cargo.CargoLinkMobile AS VARCHAR ) AS cargoAgentDetail, t1.*, leads.TmpDepositAlgr, leads.TmpDepositRate, leads.DeliveryStartDate AS leadsDeliveryStartDate, leads.DeliveryEndDate AS leadsDeliveryEndDate, leads.DepositAlgr AS leadsDepositAlgr, leads.DepositRate AS leadsDepositRate, leads.IsRealName AS isRealName, sourcePlace.Name AS sourcePlaceName, leads.ConformProduct AS conformProduct, leads.ExtraLogisticsCost AS extraLogisticsCost, wareHouse.WHAddress AS wHAddress, leads.PettyCost, leads.PettyFloor, leads.PettyCeiling, CAST (t4.CategoryName AS VARCHAR) + '/' + CAST (t5.BrandName AS VARCHAR) AS goodName, isNull(t2.FirmName, '') AS sellFirmName, isNull(t3.FirmName, '') AS buyFirmName, isNull(t4.CategoryName, '') AS categoryLeafName, isNull(t5.BrandName, '') AS brandName, isNull( t6.pvName + t6.ctName + t6.dtName + t6.Address, '' ) AS addressName, isNull(t7.Name, '') AS deliveryPlaceName, isNull(t8.sumSellD, 0) AS sumSellD, isNull(t8.sumBuyD, 0) AS sumBuyD, isNull(t9.sumSellD2, 0) AS sumSellD2, isNull(t9.sumBuyD2, 0) AS sumBuyD2,isNull(fee.freight, 0) As freight,template.TradeTmptName,template.TradeType FROM T_Order t1 LEFT JOIN C_Firm t2 ON t1.SellFirmId \= t2.FirmID LEFT JOIN C_Firm t3 ON t1.BuyFirmId \= t3.FirmID LEFT JOIN VW_Crm_CategorySpecial t4 ON t1.CategoryLeafID \= t4.ID LEFT JOIN VW_Crm_Brand t5 ON t1.BrandID \= t5.ID LEFT JOIN T_WareHouseAddress wareHouse ON wareHouse.ID\=t1.AddressID LEFT JOIN VW_Canton canton1 ON wareHouse.AddPV \= canton1.ID LEFT JOIN VW_Canton canton2 ON wareHouse.AddCT \= canton2.ID LEFT JOIN VW_Canton canton3 ON wareHouse.AddDT \= canton3.ID LEFT JOIN ( SELECT t11.id, t11.Address, t12.ShortName AS pvName, t13.ShortName AS ctName, t14.ShortName AS dtName FROM C_Address t11 LEFT JOIN vw_Canton t12 ON t11.AddPV \= t12.ID LEFT JOIN vw_Canton t13 ON t11.AddCT \= t13.ID LEFT JOIN vw_Canton t14 ON t11.AddDT \= t14.ID) t6 ON t1.AddressID \= t6.ID LEFT JOIN VW_Crm_DeliveryPlace t7 ON t1.DeliveryPlaceId \= t7.ID LEFT JOIN ( SELECT OrderID, SUM (SellTakenSSDeposit) AS sumSellD, SUM (TakenBSDeposit) AS sumBuyD FROM T_Delivery WHERE ProcessStatus \= 0 GROUP BY OrderID) t8 ON t1.OrderId \= t8.OrderID LEFT JOIN ( SELECT OrderID, SUM (SellTakenSSDeposit) AS sumSellD2, SUM (TakenBSDeposit) AS sumBuyD2 FROM T_Delivery WHERE ProcessStatus \= 1 GROUP BY OrderID) t9 ON t1.OrderId \= t9.OrderID LEFT JOIN T_Leads leads ON leads.ID \= t1.LeadsID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID \= leads.SourcePlaceID LEFT JOIN T_CargoAgent cargo ON t1.CargoAgentID \= cargo.ID LEFT JOIN (SELECT OrderID,SUM (BuyShouldPayFreight) AS freight FROM T_DeliveryFreightFee GROUP BY OrderID) fee ON t1.OrderId \= fee.OrderID LEFT JOIN T_TradeTemplate template ON t1.tradeTmptId \= template.tradeTmptId WHERE t1.OrderId = \u003f
OrderDAO_002 = SELECT * FROM ( SELECT * FROM ( SELECT t1.TradeUnitNumber * ISNULL(t1.DeliveryQuantity, 0) AS orderTotalDeliveryQuantity, t1.*, leads.IsRealName AS isRealName, sourcePlace.Name AS sourcePlaceName, leads.ConformProduct AS conformProduct, leads.ExtraLogisticsCost AS extraLogisticsCost, leads.WHAddress AS wHAddress, leads.WHGruopName AS leadsWHGroup, leads.StoreHouseFN AS leadsStoreHouseFN, PettyCost, leads.PettyFloor, leads.PettyCeiling, buyerTrader.TraderName AS buyTraderName, dbo.base64_utf8decode (buyerUser.Mobile) AS buyTraderTelPhone, buyerUser.Rec_Createby AS buyCreateby, sellerTrader.TraderName AS sellTraderName, dbo.base64_utf8decode (sellerUser.Mobile) AS sellTraderTelPhone, sellerUser.Rec_Createby AS sellCreateby, t1.DeliveryEndDate AS delievryDate, isNull(t2.FirmName, '') AS sellFirmName, isNull(t3.FirmName, '') AS buyFirmName, CAST (t4.CategoryName AS VARCHAR) + '/' + CAST (t5.BrandName AS VARCHAR) AS goodName, isNull( t6.pvName + t6.ctName + t6.dtName + t6.Address, '' ) AS addressName, isNull(t7.Name, '') AS deliveryPlaceName, isNull(t8.sumSellD, 0) AS sumSellD, isNull(t8.sumSellDC, 0) AS sumSellDC, isNull(t8.sumBuyD, 0) AS sumBuyD, isNull(t9.sumDeliveryQuantity2, 0) AS sumDeliveryQuantity2, isNull(t9.sumSellD2, 0) AS sumSellD2, isNull(t9.sumBuyD2, 0) AS sumBuyD2, leads.LeadsCode AS leads_serviceNm, generateLabel \= CASE WHEN too.ID IS NOT NULL THEN 1 ELSE 0 END, t10.LogisticsType, tradeTemplate.TradeTmptName, tradeTemplate.TradeType FROM T_Order t1 LEFT JOIN T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId \= t1.TradeTmptId INNER JOIN C_Firm t2 ON t1.SellFirmId \= t2.FirmID INNER JOIN C_Firm t3 ON t1.BuyFirmId \= t3.FirmID LEFT JOIN VW_Crm_CategorySpecial t4 ON t1.CategoryLeafID \= t4.ID LEFT JOIN VW_Crm_Brand t5 ON t1.BrandID \= t5.ID LEFT JOIN ( SELECT t11.id, t11.Address, t12.ShortName AS pvName, t13.ShortName AS ctName, t14.ShortName AS dtName FROM C_Address t11 LEFT JOIN vw_Canton t12 ON t11.AddPV \= t12.ID LEFT JOIN vw_Canton t13 ON t11.AddCT \= t13.ID LEFT JOIN vw_Canton t14 ON t11.AddDT \= t14.ID ) t6 ON t1.AddressID \= t6.ID LEFT JOIN VW_Crm_DeliveryPlace t7 ON t1.DeliveryPlaceId \= t7.ID LEFT JOIN ( SELECT OrderID, SUM (SellTakenSSDeposit) AS sumSellD, SUM (SellCreditDeposit) AS sumSellDC, SUM (TakenBSDeposit) AS sumBuyD FROM T_Delivery WHERE ProcessStatus \= 0 GROUP BY OrderID ) t8 ON t1.OrderId \= t8.OrderID LEFT JOIN ( SELECT OrderID, SUM (DeliveryQuantity) AS sumDeliveryQuantity2, SUM (SellTakenSSDeposit) AS sumSellD2, SUM (TakenBSDeposit) AS sumBuyD2 FROM T_Delivery WHERE ProcessStatus \= 1 GROUP BY OrderID ) t9 ON t1.OrderId \= t9.OrderID LEFT JOIN C_Trader buyerTrader ON buyerTrader.TraderID \= t1.BuyTraderId LEFT JOIN C_User buyerUser ON buyerUser.UserCode \= buyerTrader.UserCode LEFT JOIN C_Trader sellerTrader ON sellerTrader.TraderID \= t1.SellTraderId LEFT JOIN C_User sellerUser ON sellerUser.UserCode \= sellerTrader.UserCode INNER JOIN T_Leads leads ON leads.ID \= t1.LeadsID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID \= leads.SourcePlaceID LEFT JOIN T_Order_OprRecord too ON t1.OrderId \= too.OrderID LEFT JOIN ( SELECT t1.CategoryLeafID, t1.BrandID, t1.SourcePlaceID, t3.LogisticsType FROM T_LogisticsTemplateCategory t1, T_LogisticsTemplate t2, T_LogisticsCompany t3 WHERE t1.TemplateID \= t2.ID AND t2.LogisticsID \= t3.ID AND t1.DISABLED \= 0 AND t2.DISABLED \= 0 AND t3.DISABLED \= 0 ) t10 ON t1.CategoryLeafID \= t10.CategoryLeafID AND t1.BrandID \= t10.BrandID AND t1.SourcePlaceID \= t10.SourcePlaceID ) t21 WHERE 1 \= 1 AND t21.TradeStatus \!\= - 1 ) temp WHERE 1 \= 1
OrderDAO_003=select * from(select * from (select t1.*, t1.DeliveryEndDate as delievryDate,isNull(t2.FirmName,'') as sellFirmName, CAST(t4.CategoryName AS VARCHAR)+'-'+CAST(t5.BrandName  AS VARCHAR) AS goodName ,isNull(t3.FirmName,'') as buyFirmName, isNull(t4.CategoryName,'') as categoryLeafName, isNull(t5.BrandName,'') as brandName, isNull(t6.pvName + t6.ctName + t6.dtName + t6.Address,'') as addressName, isNull(t7.Name,'') as deliveryPlaceName, isNull(t8.sumSellD,0) as sumSellD, isNull(t8.sumBuyD,0) as sumBuyD, isNull(t9.sumSellD2,0) as sumSellD2, isNull(t9.sumBuyD2,0) as sumBuyD2 from T_Order t1 left join C_Firm t2 on t1.SellFirmId = t2.FirmID left join C_Firm t3 on t1.BuyFirmId = t3.FirmID left join VW_Crm_CategorySpecial t4 on t1.CategoryLeafID = t4.ID left join VW_Crm_Brand t5 on t1.BrandID = t5.ID left join (select t11.id, t11.Address, t12.ShortName as pvName, t13.ShortName as ctName, t14.ShortName as dtName from C_Address t11 left join vw_Canton t12 on t11.AddPV = t12.ID left join vw_Canton t13 on t11.AddCT = t13.ID left join vw_Canton t14 on t11.AddDT = t14.ID) t6 on t1.AddressID = t6.ID left join VW_Crm_DeliveryPlace t7 on t1.DeliveryPlaceId = t7.ID left join (select OrderID, sum(SellTakenSSDeposit) as sumSellD, sum(TakenBSDeposit) as sumBuyD from T_Delivery where ProcessStatus = 0 group by OrderID) t8 on t1.OrderId = t8.OrderID left join (select OrderID, sum(SellTakenSSDeposit) as sumSellD2, sum(TakenBSDeposit) as sumBuyD2 from T_Delivery where ProcessStatus = 1 group by OrderID) t9 on t1.OrderId = t9.OrderID) t21 where 1 = 1 and t21.sellCreditFee != 0 and t21.TradeStatus != -1)temp where 1=1
OrderDAO_004 = UPDATE T_Order SET SellCreditFee=\u003f,SellTakenTradeFee=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where OrderId=\u003f
OrderDAO_005 = SELECT ISNULL(SUM(DeliveryQuantity), 0)as remainQiamtity from T_Delivery WHERE OrderID =\u003f
OrderDAO_005_1 = SELECT SUM(DeliveryQuantity) as remainQiamtity from T_Delivery WHERE OrderID =\u003f  and ProcessStatus = 1 
OrderDAO_006 = SELECT od.*, cf1.FirmName AS sellFirmName, cf2.FirmName AS buyFirmName, CAST ( crmCat.CategoryName AS VARCHAR ) + '-' + CAST (crmBr.BrandName AS VARCHAR) AS goodName, template.TradeType FROM T_Order od LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID \= od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID \= od.BrandID LEFT JOIN C_Firm cf1 ON cf1.FirmID \= od.SellFirmId LEFT JOIN C_Firm cf2 ON cf2.FirmID \= od.BuyFirmId LEFT JOIN T_TradeTemplate template ON od.tradeTmptId \= template.tradeTmptId WHERE od.OrderId =\u003f
OrderDAO_007 = INSERT INTO T_Delivery(DeliveryID,OrderID,LeadsID,DISABLED,DeliveryFirmId,DeliveryTraderId,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,DeliveryQuantity,TakenQuantity,Money,TakenMoney,PayedMoney,OverloadFee,Price,SellSettleDeposit,SellTakenSSDeposit,SellCreditDeposit,TakenBSFee,TakenBSDeposit,SellPenalty,TakenSellPenalty,BuyPenalty,TakenBuyPenalty,DeliveryType,DeliveryAttID,DeliveryStatus,ProcessInstanceID,ProcessStatus,ViolationStatus,LogisticsStatus,DeliveryComment,PaidSellPenalty,PaidBuyPenalty,TailAdjustStatus,TailAdjustPID,ShouldPaySellPenalty,ShouldPayBuyPenalty,deliveryOrderFileID)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)										
OrderDAO_008 = SELECT * FROM T_Delivery WHERE OrderID =\u003f
OrderDAO_009 = UPDATE T_Order SET TradeStatus=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f,SellTradeDeposit=0,SellTakenTradeDeposit=0,SellCreditDeposit=0,BuyTakenTradeDeposit=0 where OrderId=\u003f
OrderDAO_010 = select isnull(sum(t.Amount),0) as dayAmount from T_Order t where Convert(varchar(10),t.REC_CREATETIME,120) = Convert(varchar(10),getDate(),120)
OrderDAO_011 = select Convert(varchar(10),t.REC_CREATETIME,120) as day ,isnull(sum(t.TotalQuantity),0) as tons from T_Order t where Convert(varchar(10),t.REC_CREATETIME,120) between \u003f and \u003f group by Convert(varchar(10),t.REC_CREATETIME,120) order by day asc
OrderDAO_012 = update T_Order set DeliveryQuantity = (SELECT DeliveryQuantity FROM T_Order WHERE OrderId=\u003f)-\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f where OrderId =\u003f
OrderDAO_013 = select max(t.TradeTmptId) as tradeTmptId, max(t.TradeTmptName) as tradeTmptName, isNull(sum(o.Amount),0) as amount from T_TradeTemplate t left join T_Order o on o.TradeTmptId=t.TradeTmptId where 1=1
OrderDAO_014 = update T_Order SET DeliveryQuantity=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f where OrderId=\u003f
OrderDAO_015 = SELECT cf.FirmID,cf.FirmName,tor.row as orderNum,tor.totalMoney,ff.BALANCE as usableMoney,detail.ContactName as contactName,dbo.base64_utf8decode(detail.ContactMobile) as contactMobile,detail.ContactEmail as contactEmail FROM C_Firm cf INNER  JOIN  (SELECT BuyFirmId,COUNT(BuyFirmId)as row,SUM(Amount)+SUM(BuyTradeFee) as totalMoney  FROM T_Order 
OrderDAO_016 = SELECT tor.OrderId,tor.BuyUserCode as buyUserCode ,cu.UserName as buyUserName,tor.TradeDate,temp.totalMoney from  T_Order tor  LEFT  JOIN C_User cu ON cu.UserCode = tor.BuyUserCode INNER JOIN (SELECT OrderId,SUM(Amount)+SUM(BuyTradeFee) as totalMoney FROM T_Order WHERE BuyFirmId =\u003f GROUP BY OrderId)temp ON temp.OrderId = tor.OrderId WHERE tor.BuyFirmId =\u003f
OrderDAO_017 = SELECT * from (SELECT orders.*,leads.IsRealName as isRealName,trader.FirmType as buyTraderType,orders.DeliveryStartDate as DelievryDate,ISNULL((select SUM(delivery.DeliveryQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId group by delivery.OrderID), 0) AS processSuccessDeliveryQuantity,dbo.base64_utf8decode(users.Mobile) AS buyTraderMobile,trader.TraderName AS buyTraderName,CAST(crmCat.CategoryName AS VARCHAR)+'/'+CAST(brand.BrandName AS VARCHAR) as goodName,brand.BrandName AS brandName,firm1.FirmName AS sellFirmName,firm2.FirmName AS buyFirmName FROM T_Order orders LEFT JOIN VW_Crm_Brand brand ON brand.ID = orders.BrandID INNER JOIN C_Firm firm1 ON firm1.FirmID = orders.SellFirmId INNER JOIN C_Firm firm2 ON firm2.FirmID = orders.BuyFirmId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID INNER JOIN C_Trader trader ON trader.TraderID = orders.BuyTraderId LEFT JOIN C_User users ON  users.UserCode = trader.UserCode LEFT JOIN T_Leads leads ON leads.ID = orders.LeadsID WHERE orders.TradeStatus <> -1)  temp where temp.quantity > temp.processSuccessDeliveryQuantity 
OrderDAO_018 = SELECT orders.OrderId,orders.IsDisplayOrder,orders.IsSendOutMoneyCus,orders.IsSendOutMoneyRisk,ISNULL(orders.IsUseSellCoupon,0) as IsUseSellCoupon,ISNULL(orders.SellCouponTradeFee,0) as SellCouponTradeFee,orders.IsGoodsController,orders.IsPaySellerMoney,orders.GetGoodsControllerDate,orders.PaidAmount,ISNULL(deliveryFreightFeeTemp.ShouldPaySellPenalty, 0) as shouldPaySellPenalty,ISNULL(deliveryFreightFeeTemp.paidSellFreight, 0) as paidSellFreight,ISNULL(deliveryFreightFeeTemp.OverloadFreight, 0) as overloadFreight,orders.SettlementMethod,orders.SellArrivalTime,orders.TradeTmptId,orders.GoodsType,tradeTemplate.TradeTmptName as tradeTmptName,tradeTemplate.TradeType,orders.Price,orders.Quantity,orders.TotalQuantity,orders.SellTradeFee,orders.SellTakenTradeFee,orders.SellTakenTradeDeposit,orders.SellCreditDeposit,orders.DeliveryEndDate as delievryDate,orders.TradeStatus,ISNULL(orders.PaidSellAmount,0) as paidSellAmount,tradeTemplate.SellerLateFeeType,ISNULL(tradeTemplate.SellerLateFee,0) as sellerLateFee,ISNULL(orders.ReceivableSellLateFee,0) as receivableSellLateFee,ISNULL(orders.ReceivedSellLateFee,0) as receivedSellLateFee,(select count(1) from T_Delivery delivery where delivery.OrderID \= orders.OrderId) as deliveryNum,orders.TradeDate,orders.PaymentStatus,sellFirm.FirmID as sellFirmId,sellFirm.FirmName as sellFirmName, crmCat.CategoryName as categoryName,crmBr.BrandName as brandName,(select ISNULL(sum(delivery.DeliveryQuantity),0)*orders.TradeUnitNumber from T_Delivery delivery where delivery.OrderID \= orders.OrderId and delivery.DeliveryStatus in (60,65)) as violationWeight,(SELECT ISNULL(sum(a.DeliveryQuantity), 0)*orders.TradeUnitNumber From T_Delivery a where a.OrderID \= orders.OrderId) as allDeliveryWeight,(SELECT ISNULL(sum(b.DeliveryQuantity), 0)*orders.TradeUnitNumber From T_Delivery b where b.DeliveryStatus not in (60,65,70) and b.OrderID \= orders.OrderId) as normalDeliveryWeight,(SELECT ISNULL(sum(c.DeliveryQuantity), 0)*orders.TradeUnitNumber From T_Delivery c where ISNULL(c.isGetSinopecNumber,0) \= 1 and c.DeliveryStatus not in (60,65,70) and c.OrderID \= orders.OrderId) as logisticsMarkDeliveryWeight,(SELECT ISNULL(SUM(cc.Weight), 0) FROM T_CancelContract cc WHERE cc.OrderID \= orders.OrderID AND cc.DISABLED \= 0 AND cc.ApplyStatus \= 10 AND cc.KeyID in (select ApplyID from (select ccd.ApplyID as ApplyID, count(*) as cnt from T_CancelContractDetail ccd where ccd.DISABLED \= 0 and ccd.PayStatus \= 0 GROUP BY ccd.ApplyID) t where t.cnt \= 2)) AS canceledTotalWeight, (SELECT ISNULL(SUM(cc.Weight), 0) FROM T_CancelContract cc WHERE cc.OrderID \= orders.OrderID AND cc.DISABLED \= 0 AND (cc.ApplyStatus < 10 or cc.KeyID not in (select ApplyID from (select ccd.ApplyID as ApplyID, count(*) as cnt from T_CancelContractDetail ccd where ccd.DISABLED \= 0 and ccd.PayStatus \= 0 GROUP BY ccd.ApplyID) t where t.cnt \= 2))) AS cancelingTotalWeight, (select ISNULL(sum(ccd.ReceivedTradeFee), 0) FROM T_CancelContract cc, T_CancelContractDetail ccd WHERE cc.OrderID \= orders.OrderID AND cc.DISABLED \= 0 AND ccd.DISABLED \= 0 AND cc.KeyID \= ccd.ApplyID AND ccd.TradeRole \= 0 AND ccd.PayStatus \= 0 AND cc.ApplyStatus >\= 10) AS canceledTotalReceivedTradeFee FROM T_Order orders LEFT JOIN T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId \= orders.TradeTmptId INNER JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId INNER JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID INNER JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID LEFT JOIN (SELECT deliveryFreightFee.OrderID,SUM(ISNULL(deliveryFreightFee.ShouldPaySellPenalty,0)) as ShouldPaySellPenalty,sum(ISNULL(deliveryFreightFee.PaidSellFreight,0)) as PaidSellFreight,sum(ISNULL(deliveryFreightFee.OverloadFreight, 0)) as OverloadFreight FROM T_DeliveryFreightFee deliveryFreightFee where deliveryFreightFee.DISABLED = 0 GROUP BY deliveryFreightFee.OrderID) deliveryFreightFeeTemp ON deliveryFreightFeeTemp.OrderID = orders.OrderId  WHERE 1=1 and orders.TradeStatus != -1
OrderDAO_019 = SELECT orders.OrderId,orders.IsDisplayOrder,ISNULL(orders.IsUseSellCoupon,0) as IsUseSellCoupon,ISNULL(orders.SellCouponTradeFee,0) as SellCouponTradeFee,orders.IsGoodsController,orders.GetGoodsControllerDate,orders.PaidAmount,ISNULL(deliveryFreightFeeTemp.ShouldPaySellPenalty, 0) as shouldPaySellPenalty,ISNULL(deliveryFreightFeeTemp.paidSellFreight, 0) as paidSellFreight,ISNULL(deliveryFreightFeeTemp.OverloadFreight, 0) as overloadFreight,orders.SettlementMethod,orders.SellArrivalTime,orders.TradeTmptId,orders.GoodsType,tradeTemplate.TradeTmptName as tradeTmptName,tradeTemplate.TradeType,orders.Price,orders.Quantity,orders.TotalQuantity,orders.SellTradeFee,orders.SellTakenTradeFee,orders.SellTakenTradeDeposit,orders.SellCreditDeposit,orders.DeliveryEndDate as delievryDate,orders.TradeStatus,ISNULL(orders.PaidSellAmount,0) as paidSellAmount,tradeTemplate.SellerLateFeeType,ISNULL(tradeTemplate.SellerLateFee,0) as sellerLateFee,ISNULL(orders.ReceivableSellLateFee,0) as receivableSellLateFee,ISNULL(orders.ReceivedSellLateFee,0) as receivedSellLateFee,(select count(1) from T_Delivery delivery where delivery.OrderID = orders.OrderId) as deliveryNum,orders.TradeDate,orders.PaymentStatus,sellFirm.FirmID as sellFirmId,sellFirm.FirmName as sellFirmName, crmCat.CategoryName as categoryName,crmBr.BrandName as brandName,(select ISNULL(sum(delivery.DeliveryQuantity),0)*orders.TradeUnitNumber from T_Delivery delivery where delivery.OrderID = orders.OrderId and delivery.DeliveryStatus in (60,65)) as violationWeight,(SELECT ISNULL(sum(a.DeliveryQuantity), 0)*orders.TradeUnitNumber From T_Delivery a where a.OrderID = orders.OrderId) as allDeliveryWeight,(SELECT ISNULL(sum(b.DeliveryQuantity), 0)*orders.TradeUnitNumber From T_Delivery b where b.DeliveryStatus not in (60,65,70) and b.OrderID = orders.OrderId) as normalDeliveryWeight,(SELECT ISNULL(sum(c.DeliveryQuantity), 0)*orders.TradeUnitNumber From T_Delivery c where ISNULL(c.isGetSinopecNumber,0) = 1 and c.DeliveryStatus not in (60,65,70) and c.OrderID = orders.OrderId) as logisticsMarkDeliveryWeight,(SELECT ISNULL(SUM(cc.Weight), 0) FROM T_CancelContract cc WHERE cc.OrderID = orders.OrderID AND cc.DISABLED = 0 AND cc.ApplyStatus = 10 AND cc.KeyID in (select ApplyID from (select ccd.ApplyID as ApplyID, count(*) as cnt from T_CancelContractDetail ccd where ccd.DISABLED = 0 and ccd.PayStatus = 0 GROUP BY ccd.ApplyID) t where t.cnt = 2)) AS canceledTotalWeight, (SELECT ISNULL(SUM(cc.Weight), 0) FROM T_CancelContract cc WHERE cc.OrderID = orders.OrderID AND cc.DISABLED = 0 AND (cc.ApplyStatus < 10 or cc.KeyID not in (select ApplyID from (select ccd.ApplyID as ApplyID, count(*) as cnt from T_CancelContractDetail ccd where ccd.DISABLED = 0 and ccd.PayStatus = 0 GROUP BY ccd.ApplyID) t where t.cnt = 2))) AS cancelingTotalWeight, (select ISNULL(sum(ccd.ReceivedTradeFee), 0) FROM T_CancelContract cc, T_CancelContractDetail ccd WHERE cc.OrderID = orders.OrderID AND cc.DISABLED = 0 AND ccd.DISABLED = 0 AND cc.KeyID = ccd.ApplyID AND ccd.TradeRole = 0 AND ccd.PayStatus = 0 AND cc.ApplyStatus >= 10) AS canceledTotalReceivedTradeFee FROM T_Order orders LEFT JOIN T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId = orders.TradeTmptId  INNER JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId INNER JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID INNER JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID LEFT JOIN (SELECT deliveryFreightFee.OrderID,SUM(ISNULL(deliveryFreightFee.ShouldPaySellPenalty,0)) as ShouldPaySellPenalty,sum(ISNULL(deliveryFreightFee.PaidSellFreight,0)) as PaidSellFreight,sum(ISNULL(deliveryFreightFee.OverloadFreight, 0)) as OverloadFreight FROM T_DeliveryFreightFee deliveryFreightFee where deliveryFreightFee.DISABLED = 0 GROUP BY deliveryFreightFee.OrderID) deliveryFreightFeeTemp ON deliveryFreightFeeTemp.OrderID = orders.OrderId  WHERE orders.TradeStatus != -1 and orders.OrderId = ?  
OrderDAO_020 = update T_Order set PaymentStatus = 10,SellTakenTradeFee = \u003f, PaidSellAmount = \u003f,ReceivedSellLateFee = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate(),PaymentTime = getDate() WHERE OrderId = \u003f and PaymentStatus = 5
OrderDAO_021 = update T_Order set PaymentStatus = 5,ReceivableSellLateFee = \u003f,REC_MODIFYBY = \u003f,IsUseSellCoupon = \u003f,REC_MODIFYTIME = getDate() WHERE OrderId = \u003f and PaymentStatus = 0
OrderDAO_022 = update T_Order set Remarks = \u003f, PaymentStatus = 15,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() WHERE  OrderId = \u003f
OrderDAO_023 = SELECT tor.OrderId, tor.GoodsType, crmCat.CategoryName AS categoryLeafName, crmBr.BrandName AS brandName, tor.DeliveryPlaceId, isNull(t7.Name, '') AS deliveryPlaceName, tor.AddressID, tor.TotalQuantity, tor.SellArrivalTime, tor.TradeDate, (tor.Amount + tor.BuyTradeFee) AS totalMoney, ( tor.Amount + tor.BuyTradeFee - ISNULL(tor.BuyTakenTradeDeposit, 0)) AS notPaidMoney FROM T_Order tor LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID \= tor.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID \= tor.BrandID LEFT JOIN VW_Crm_DeliveryPlace t7 ON tor.DeliveryPlaceId \= t7.ID LEFT JOIN T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId \= tor.TradeTmptId WHERE tor.BuyTraderId \= ? AND ( tor.Amount + tor.BuyTradeFee - ISNULL(tor.BuyTakenTradeDeposit, 0)) > 0 AND ( tor.TradeStatus \= 1 AND tor.SellArrivalTime IS NULL AND tradeTemplate.TradeType <> 1 ) UNION ALL SELECT tor.OrderId, tor.GoodsType, crmCat.CategoryName AS categoryLeafName, crmBr.BrandName AS brandName, tor.DeliveryPlaceId, isNull(t7.Name, '') AS deliveryPlaceName, tor.AddressID, tor.TotalQuantity, tor.SellArrivalTime, tor.TradeDate, (tor.Amount + tor.BuyTradeFee) AS totalMoney, ( tor.Amount + tor.BuyTradeFee - ISNULL(tor.BuyTakenTradeDeposit, 0)) AS notPaidMoney FROM T_Order tor LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID \= tor.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID \= tor.BrandID LEFT JOIN VW_Crm_DeliveryPlace t7 ON tor.DeliveryPlaceId \= t7.ID LEFT JOIN T_TradeTemplate tradeTemplate ON tradeTemplate.TradeTmptId \= tor.TradeTmptId WHERE tor.BuyTraderId \= ? AND ( tor.Amount + tor.BuyTradeFee - ISNULL(tor.BuyTakenTradeDeposit, 0)) > 0 AND ( tor.TradeStatus \= 1 AND tor.SellArrivalTime IS NOT NULL AND tradeTemplate.TradeType \= 1 )
OrderDAO_024 = update T_Order SET SellTakenTradeDeposit = \u003f ,SellCreditDeposit = \u003f,REC_MODIFYBY = \u003f ,REC_MODIFYTIME = GETDATE() where OrderId = \u003f
OrderDAO_025 = update T_Order SET ReceivableBuyLateFee = \u003f,ReceivedBuyLateFee = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where OrderId = \u003f
OrderDAO_026 = update T_Order SET ReceivableSellLateFee = \u003f,ReceivedSellLateFee = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where OrderId = \u003f
OrderDAO_027 = update T_Order SET IsGoodsController = \u003f,GetGoodsControllerDate  = getDate(),REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where OrderId = \u003f
OrderDAO_028 = INSERT INTO T_OrderSinopec(REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,OrderID,FileID,FileStatus,UploadType)VALUES(\u003f,GETDATE(),\u003f,GETDATE(),\u003f,\u003f,\u003f,\u003f)
OrderDAO_029 = select FileID as fileID,ID as id from T_OrderSinopec where OrderID =\u003f and UploadType =\u003f
OrderDAO_030 = update T_OrderSinopec set REC_MODIFYBY= \u003f,REC_MODIFYTIME= GETDATE() where ID = \u003f
OrderDAO_031 = select * from T_OrderSinopec where OrderID=\u003f and FileID=\u003f and UploadType=\u003f
OrderDAO_032 = INSERT INTO T_BreachContractApply(ID,OrderID,DeliveryID,DISABLED,Origin,Reson,Quantity,Status,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,HistoryDeliveryID,BreachType)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f,\u003f)
OrderDAO_033 = update T_Order set SellCouponTradeFee = \u003f, REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where OrderId = \u003f
OrderDAO_034 = update T_Order set IsDisplayOrder = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where OrderId = \u003f
OrderDAO_035 = SELECT * from (SELECT orders.*,leads.IsRealName as isRealName,trader.FirmType as buyTraderType,orders.DeliveryStartDate as DelievryDate,ISNULL((select SUM(delivery.DeliveryQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId group by delivery.OrderID), 0) AS processSuccessDeliveryQuantity,dbo.base64_utf8decode(users.Mobile) AS buyTraderMobile,trader.TraderName AS buyTraderName,CAST(crmCat.CategoryName AS VARCHAR)+'/'+CAST(brand.BrandName AS VARCHAR) as goodName,brand.BrandName AS brandName,firm1.FirmName AS sellFirmName,firm2.FirmName AS buyFirmName FROM T_Order orders LEFT JOIN VW_Crm_Brand brand ON brand.ID = orders.BrandID INNER JOIN C_Firm firm1 ON firm1.FirmID = orders.SellFirmId INNER JOIN C_Firm firm2 ON firm2.FirmID = orders.BuyFirmId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID INNER JOIN C_Trader trader ON trader.TraderID = orders.BuyTraderId LEFT JOIN C_User users ON  users.UserCode = trader.UserCode LEFT JOIN T_Leads leads ON leads.ID = orders.LeadsID WHERE orders.TradeStatus <> -1)  temp where 1=1
OrderDAO_036 = SELECT CAST ( cargo.CargoAgentSimpleName AS VARCHAR ) + '-' + CAST ( cargo.CargoLinkName AS VARCHAR ) + '-' + CAST ( cargo.CargoLinkMobile AS VARCHAR ) AS cargoAgentDetail, t1.*, leads.TmpDepositAlgr, leads.TmpDepositRate, leads.DeliveryStartDate AS leadsDeliveryStartDate, leads.DeliveryEndDate AS leadsDeliveryEndDate, leads.DepositAlgr AS leadsDepositAlgr, leads.DepositRate AS leadsDepositRate, leads.IsRealName AS isRealName, isNull(sourcePlace.Name, '') AS sourcePlaceName, leads.ConformProduct AS conformProduct, leads.ExtraLogisticsCost AS extraLogisticsCost, leads.WHAddress, leads.WHGruopName AS leadsWHGroup, leads.StoreHouseFN AS leadsStoreHouseFN, leads.PettyCost, leads.PettyFloor, leads.PettyCeiling, CAST (t4.CategoryName AS VARCHAR) + '/' + CAST (t5.BrandName AS VARCHAR) AS goodName, isNull(t2.FirmName, '') AS sellFirmName, isNull(t3.FirmName, '') AS buyFirmName, isNull(t4.CategoryName, '') AS categoryLeafName, isNull(t5.BrandName, '') AS brandName, isNull( t6.pvName + t6.ctName + t6.dtName + t6.Address, '' ) AS addressName, isNull(t7.Name, '') AS deliveryPlaceName, isNull(t8.sumSellD, 0) AS sumSellD, isNull(t8.sumBuyD, 0) AS sumBuyD, isNull(t9.sumSellD2, 0) AS sumSellD2, isNull(t9.sumBuyD2, 0) AS sumBuyD2, isNull(fee.freight, 0) AS freight, ISNULL(t10.FreightFee, 0) AS FreightFee, ISNULL(t10.SmallFee, 0) AS SmallFee, isNull(t11.LogiisticsName, '') AS LogiisticsName, isNull(t11.AddressDetail, '') AS AddressDetail, template.TradeType FROM T_Order t1 LEFT JOIN C_Firm t2 ON t1.SellFirmId \= t2.FirmID LEFT JOIN C_Firm t3 ON t1.BuyFirmId \= t3.FirmID LEFT JOIN VW_Crm_CategorySpecial t4 ON t1.CategoryLeafID \= t4.ID LEFT JOIN VW_Crm_Brand t5 ON t1.BrandID \= t5.ID LEFT JOIN ( SELECT t11.id, t11.Address, t12.ShortName AS pvName, t13.ShortName AS ctName, t14.ShortName AS dtName FROM C_Address t11 LEFT JOIN vw_Canton t12 ON t11.AddPV \= t12.ID LEFT JOIN vw_Canton t13 ON t11.AddCT \= t13.ID LEFT JOIN vw_Canton t14 ON t11.AddDT \= t14.ID ) t6 ON t1.AddressID \= t6.ID LEFT JOIN VW_Crm_DeliveryPlace t7 ON t1.DeliveryPlaceId \= t7.ID LEFT JOIN ( SELECT OrderID, SUM (SellTakenSSDeposit) AS sumSellD, SUM (TakenBSDeposit) AS sumBuyD FROM T_Delivery WHERE ProcessStatus \= 0 GROUP BY OrderID ) t8 ON t1.OrderId \= t8.OrderID LEFT JOIN ( SELECT OrderID, SUM (SellTakenSSDeposit) AS sumSellD2, SUM (TakenBSDeposit) AS sumBuyD2 FROM T_Delivery WHERE ProcessStatus \= 1 GROUP BY OrderID ) t9 ON t1.OrderId \= t9.OrderID LEFT JOIN T_Leads leads ON leads.ID \= t1.LeadsID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID \= leads.SourcePlaceID LEFT JOIN T_CargoAgent cargo ON t1.CargoAgentID \= cargo.ID LEFT JOIN ( SELECT OrderID, SUM (BuyShouldPayFreight) AS freight FROM T_DeliveryFreightFee GROUP BY OrderID ) fee ON t1.OrderId \= fee.OrderID LEFT JOIN ( SELECT t2.OrderID, SUM (t1.FreightFee) AS FreightFee, SUM (t1.SmallFee) AS SmallFee FROM T_DelDistributionDetail t1 INNER JOIN T_Delivery t2 ON t1.DeliveryID \= t2.DeliveryID INNER JOIN T_DeliveryFreightFee t3 ON t1.DeliveryID \= t3.DeliveryID GROUP BY t2.OrderID ) t10 ON t1.OrderId \= t10.OrderID LEFT JOIN ( SELECT t1.orderid, t2.LogiisticsName, t2.AddressDetail FROM ( SELECT main.orderid, main.DeliveryID FROM T_Delivery main WHERE main.DeliveryID \= ( SELECT TOP 1 DeliveryID FROM T_Delivery WHERE orderid \= main.orderid AND disabled \= 0 )) t1, T_DelDistributionDetail t2 WHERE t1.DeliveryID \= t2.DeliveryID AND t2.DISABLED \= 0 ) t11 ON t1.OrderId \= t11.OrderID LEFT JOIN T_TradeTemplate template ON t1.TradeTmptId \= template.TradeTmptId WHERE 1 \= 1
OrderDAO_037 = INSERT INTO T_Order_OprRecord(OrderId, OprTime, OprBy, OprType) VALUES (\u003f, getDate(), \u003f, \u003f)
OrderDAO_038 = SELECT * FROM T_Order_OprRecord where OrderID = \u003f and OprType = \u003f
OrderDAO_039=SELECT * FROM ( SELECT t1.*, t2.TradeTmptId, t2.TradeDate, t2.BuyFirmId, t2.SellFirmId, t3.FirmName AS BuyFirmName, t4.FirmName AS SellFirmName, t5.PayStatus AS PayStatus_post, t6.PayStatus AS PayStatus_get FROM T_CancelContract t1, T_Order t2, C_Firm t3, C_Firm t4, T_CancelContractDetail t5, T_CancelContractDetail t6 WHERE t1.OrderID \= t2.OrderId AND t2.BuyFirmId \= t3.FirmID AND t2.SellFirmId \= t4.FirmID AND t1.KeyID \= t5.ApplyID AND t1.KeyID \= t6.ApplyID AND t5.DetailType \= 0 AND t6.DetailType \= 1 AND t1.DISABLED \= 0 AND t5.DISABLED \= 0 AND t6.DISABLED \= 0 ) temp WHERE 1 \= 1
OrderDAO_040=SELECT t1.*, t2.KeyID AS KeyID_post, t2.ApplyID AS ApplyID_post, t2.DISABLED AS DISABLED_post, t2.REC_CREATEBY AS REC_CREATEBY_post, t2.REC_CREATETIME AS REC_CREATETIME_post, t2.REC_MODIFYBY AS REC_MODIFYBY_post, t2.REC_MODIFYTIME AS REC_MODIFYTIME_post, t2.DetailType AS DetailType_post, t2.TradeRole AS TradeRole_post, t2.FirmID AS FirmID_post, t2.TraderID AS TraderID_post, t2.TraderName AS TraderName_post, t2.UserCode AS UserCode_post, t2.ReceivableAmount AS ReceivableAmount_post, t2.ReceivedAmount AS ReceivedAmount_post, t2.ReceivableFreight AS ReceivableFreight_post, t2.ReceivedFreight AS ReceivedFreight_post, t2.ReceivableTradeFee AS ReceivableTradeFee_post, t2.ReceivedTradeFee AS ReceivedTradeFee_post, t2.ReceivableTradeFeeFunds AS ReceivableTradeFeeFunds_post, t2.ReceivedTradeFeeFunds AS ReceivedTradeFeeFunds_post, t2.ReceivableTradeFeeCredit AS ReceivableTradeFeeCredit_post, t2.ReceivedTradeFeeCredit AS ReceivedTradeFeeCredit_post, t2.ReceivableTradeFeeAccountFunds AS ReceivableTradeFeeAccountFunds_post, t2.ReceivedTradeFeeAccountFunds AS ReceivedTradeFeeAccountFunds_post, t2.ReceivableTradeFeeCoupon AS ReceivableTradeFeeCoupon_post, t2.ReceivedTradeFeeCoupon AS ReceivedTradeFeeCoupon_post, t2.PayAmount AS PayAmount_post, t2.PaidAmount AS PaidAmount_post, t2.PayFreight AS PayFreight_post, t2.PaidFreight AS PaidFreight_post, t2.PayTradeFee AS PayTradeFee_post, t2.PaidTradeFee AS PaidTradeFee_post, t2.PayTradeFeeFunds AS PayTradeFeeFunds_post, t2.PaidTradeFeeFunds AS PaidTradeFeeFunds_post, t2.PayTradeFeeCredit AS PayTradeFeeCredit_post, t2.PaidTradeFeeCredit AS PaidTradeFeeCredit_post, t2.PayTradeFeeAccountFunds AS PayTradeFeeAccountFunds_post, t2.PaidTradeFeeAccountFunds AS PaidTradeFeeAccountFunds_post, t2.PayTradeDeposit AS PayTradeDeposit_post, t2.PaidTradeDeposit AS PaidTradeDeposit_post, t2.PayTradeDepositCredit AS PayTradeDepositCredit_post, t2.PaidTradeDepositCredit AS PaidTradeDepositCredit_post, t2.PayTradeDepositFunds AS PayTradeDepositFunds_post, t2.PaidTradeDepositFunds AS PaidTradeDepositFunds_post, t3.KeyID AS KeyID_get, t3.ApplyID AS ApplyID_get, t3.DISABLED AS DISABLED_get, t3.REC_CREATEBY AS REC_CREATEBY_get, t3.REC_CREATETIME AS REC_CREATETIME_get, t3.REC_MODIFYBY AS REC_MODIFYBY_get, t3.REC_MODIFYTIME AS REC_MODIFYTIME_get, t3.DetailType AS DetailType_get, t3.TradeRole AS TradeRole_get, t3.FirmID AS FirmID_get, t3.TraderID AS TraderID_get, t3.TraderName AS TraderName_get, t3.UserCode AS UserCode_get, t3.ReceivableAmount AS ReceivableAmount_get, t3.ReceivedAmount AS ReceivedAmount_get, t3.ReceivableFreight AS ReceivableFreight_get, t3.ReceivedFreight AS ReceivedFreight_get, t3.ReceivableTradeFee AS ReceivableTradeFee_get, t3.ReceivedTradeFee AS ReceivedTradeFee_get, t3.ReceivableTradeFeeFunds AS ReceivableTradeFeeFunds_get, t3.ReceivedTradeFeeFunds AS ReceivedTradeFeeFunds_get, t3.ReceivableTradeFeeCredit AS ReceivableTradeFeeCredit_get, t3.ReceivedTradeFeeCredit AS ReceivedTradeFeeCredit_get, t3.ReceivableTradeFeeAccountFunds AS ReceivableTradeFeeAccountFunds_get, t3.ReceivedTradeFeeAccountFunds AS ReceivedTradeFeeAccountFunds_get, t3.ReceivableTradeFeeCoupon AS ReceivableTradeFeeCoupon_get, t3.ReceivedTradeFeeCoupon AS ReceivedTradeFeeCoupon_get, t3.PayAmount AS PayAmount_get, t3.PaidAmount AS PaidAmount_get, t3.PayFreight AS PayFreight_get, t3.PaidFreight AS PaidFreight_get, t3.PayTradeFee AS PayTradeFee_get, t3.PaidTradeFee AS PaidTradeFee_get, t3.PayTradeFeeFunds AS PayTradeFeeFunds_get, t3.PaidTradeFeeFunds AS PaidTradeFeeFunds_get, t3.PayTradeFeeCredit AS PayTradeFeeCredit_get, t3.PaidTradeFeeCredit AS PaidTradeFeeCredit_get, t3.PayTradeFeeAccountFunds AS PayTradeFeeAccountFunds_get, t3.PaidTradeFeeAccountFunds AS PaidTradeFeeAccountFunds_get, t3.PayTradeDeposit AS PayTradeDeposit_get, t3.PaidTradeDeposit AS PaidTradeDeposit_get, t3.PayTradeDepositCredit AS PayTradeDepositCredit_get, t3.PaidTradeDepositCredit AS PaidTradeDepositCredit_get, t3.PayTradeDepositFunds AS PayTradeDepositFunds_get, t3.PaidTradeDepositFunds AS PaidTradeDepositFunds_get FROM T_CancelContract t1, T_CancelContractDetail t2, T_CancelContractDetail t3 WHERE t1.KeyID \= t2.ApplyID AND t1.KeyID \= t3.ApplyID AND t2.DetailType \= 0 AND t3.DetailType \= 1 AND t1.KeyID \= ? AND t1.DISABLED \= 0 AND t2.DISABLED \= 0 AND t3.DISABLED \= 0
OrderDAO_041=update T_Order set XSSFNumber\= ?, REC_MODIFYBY \=?,REC_MODIFYTIME\=GETDATE()  where orderID \= ?
OrderDAO_042=SELECT count(*) FROM M_User t1, M_User_Role t2, M_Role t3 WHERE t1.ID \= t2.UserID AND t2.RoleID \= t3.id AND t1.Status \= 1 AND t3.Name \= '\u7EBF\u4E0B\u5408\u540C\u7BA1\u7406\u5458' and t1.userid \= ?
OrderDAO_043 = SELECT ts.OrderId as orderId, isnull(ts.FutureContractCode, '--') AS futureContractCode, t1.Name AS sourcePlaceName, t2.BrandName as brandName, ts.TotalQuantity as quantity, ts.Price as price, t3.ValueName AS deliveryDate, CASE WHEN isnull(ts.WHGruopID, 0) = 0 THEN t6.WHAddressSimpleName ELSE ts.WHGruopName END WHName FROM HJOnline.dbo.T_Order ts INNER JOIN HJOnline.dbo.T_Leads l ON ts.LeadsID = l.ID INNER JOIN HJOnline.dbo.T_LeadsExpand_Liner le ON l.ID = le.LeadsID INNER JOIN HJOnline.dbo.VW_Crm_SourcePlace t1 ON ts.SourcePlaceID = t1.ID INNER JOIN HJOnline.dbo.VW_Crm_Brand t2 ON ts.BrandID = t2.ID INNER JOIN HJOnline.dbo.C_Dictionary t3 ON le.DeliveryDateEnum = t3.DictID LEFT JOIN HJOnline.dbo.T_WareHouseAddress t6 ON ts.DeliveryPlaceId = t6.ID WHERE ts.[DISABLED] = 0 AND l.[DISABLED] = 0 AND le.[DISABLED] = 0 AND ts.TradeStatus > 0
OrderDAO_044 = update T_Order SET IsPaySellerMoney = 1,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where OrderId = \u003f
OrderDAO_045=select * from m_mail_config where MailKey \= ?
OrderDAO_046=update T_Order SET IsSendOutMoneyCus\= 1,REC_MODIFYBY \= ?,REC_MODIFYTIME \= getDate() where OrderId \= ?
OrderDAO_047=update T_Order SET IsSendOutMoneyRisk\= 1,REC_MODIFYBY \= ?,REC_MODIFYTIME \= getDate() where OrderId \= ?
OrderPaymentDAO_001 = select * from (SELECT sellFirm.FirmName as sellFirmName,sellFirmDetail.SettingBankID as sellFirmBankID,sellFirmDetail.SettingBkBranch as sellFirmBkBranch,dbo.base64_utf8decode(sellFirmDetail.SettingBkAccount) as sellFirmBkAccount,bank.BankName as sellFirmBankName,sellFirm.IsBinding as sellFirmIsBinding,sellFirmDetail.IsSignState AS sellFirmDetailIsSignState,CAST(crmCat.CategoryName AS VARCHAR)+'-'+CAST(crmBr.BrandName  AS VARCHAR) AS goodName,tempDelivery.DeliveryIDStr as deliveryIDStr,orders.*  FROM  T_Order orders  INNER JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId  INNER JOIN C_FirmDetail sellFirmDetail ON sellFirmDetail.FirmID = sellFirm.FirmID  LEFT JOIN VW_Bank bank ON bank.BankID = sellFirmDetail.SettingBankID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID LEFT JOIN (SELECT a.OrderID,STUFF((SELECT ',' + subTitle.DeliveryID FROM T_Delivery subTitle WHERE subTitle.OrderID = a.OrderID FOR XML PATH('')),1, 1, '') AS DeliveryIDStr FROM T_Delivery a GROUP BY a.OrderID) tempDelivery ON tempDelivery.OrderID = orders.OrderID ) tmp WHERE tmp.PaymentStatus = 10
OrderPaymentDAO_002 = select * from (select tmp.goodsName as goodsName,ISNULL(SUM(tmp.totalQuantity),0) as totalQuantity,ISNULL(SUM(tmp.takenQuantity),0) as takenQuantity,ISNULL(SUM(tmp.tradeFee),0) as tradeFee from (select CAST(crmCat.CategoryName AS VARCHAR)+'-'+CAST(crmBr.BrandName  AS VARCHAR) AS goodsName,orders.TotalQuantity as totalQuantity,(select sum(delivery.TakenQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId) as takenQuantity,(orders.SellTakenTradeFee+orders.BuyTakenTradeFee) as tradeFee from T_Order orders LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID  where convert(char(10),orders.REC_CREATETIME,120) >= ^A and convert(char(10),orders.REC_CREATETIME,120) <= ^B ) tmp group by tmp.goodsName) tmp1 where 1=1
OrderPaymentDAO_003 = select * from (SELECT tmp.sellFirmId as firmId,sellFirm.firmName as firmName,ISNULL(SUM(tmp.totalQuantity), 0) as totalQuantity,ISNULL(SUM(tmp.takenQuantity), 0) as takenQuantity,ISNULL(SUM(tmp.tradeFee), 0) as tradeFee  from ( select orders.SellFirmId as sellFirmId,orders.TotalQuantity as totalQuantity,(select sum(delivery.TakenQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId) as takenQuantity,orders.SellTakenTradeFee as tradeFee from T_Order orders LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID where convert(char(10),orders.REC_CREATETIME,120) >= ^A and convert(char(10),orders.REC_CREATETIME,120) <= ^B) tmp inner join  C_Firm sellFirm on sellFirm.FirmID =  tmp.sellFirmId GROUP BY tmp.sellFirmId,sellFirm.firmName UNION ALL  SELECT tmp.buyFirmId as firmId, buyFirm.firmName as firmName,        ISNULL(SUM(tmp.totalQuantity), 0) as totalQuantity,        ISNULL(SUM(tmp.takenQuantity), 0) as takenQuantity,         ISNULL(SUM(tmp.tradeFee), 0) as tradeFee from (	select  orders.BuyFirmId as buyFirmId,orders.TotalQuantity as totalQuantity,				 (select sum(delivery.TakenQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId) as takenQuantity,orders.BuyTakenTradeFee as tradeFee from T_Order orders  LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID  LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID where convert(char(10),orders.REC_CREATETIME,120) >= ^C and convert(char(10),orders.REC_CREATETIME,120) <= ^D ) tmp inner join  C_Firm buyFirm on buyFirm.FirmID =  tmp.buyFirmId GROUP BY tmp.buyFirmId,buyFirm.firmName ) tmp1 where 1=1
OrderPaymentDAO_004 = select * from (SELECT tmp.sellFirmId as firmId,sellFirm.firmName as firmName,ISNULL(SUM(tmp.totalQuantity), 0) as totalQuantity,ISNULL(SUM(tmp.takenQuantity), 0) as takenQuantity,ISNULL(SUM(tmp.tradeFee), 0) as tradeFee  from ( select orders.SellFirmId as sellFirmId,orders.TotalQuantity as totalQuantity,(select sum(delivery.TakenQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId) as takenQuantity,orders.SellTakenTradeFee as tradeFee from T_Order orders LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID where convert(char(10),orders.REC_CREATETIME,120) >= ^A and convert(char(10),orders.REC_CREATETIME,120) <= ^B) tmp inner join  C_Firm sellFirm on sellFirm.FirmID =  tmp.sellFirmId GROUP BY tmp.sellFirmId,sellFirm.firmName) tmp1 where 1=1
OrderPaymentDAO_005 = select * from ( SELECT tmp.buyFirmId as firmId, buyFirm.firmName as firmName,        ISNULL(SUM(tmp.totalQuantity), 0) as totalQuantity,        ISNULL(SUM(tmp.takenQuantity), 0) as takenQuantity,         ISNULL(SUM(tmp.tradeFee), 0) as tradeFee from (	select  orders.BuyFirmId as buyFirmId,orders.TotalQuantity as totalQuantity,				 (select sum(delivery.TakenQuantity) from T_Delivery delivery where delivery.OrderID = orders.OrderId) as takenQuantity,orders.BuyTakenTradeFee as tradeFee from T_Order orders  LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID  LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID where convert(char(10),orders.REC_CREATETIME,120) >= ^C and convert(char(10),orders.REC_CREATETIME,120) <= ^D ) tmp inner join  C_Firm buyFirm on buyFirm.FirmID =  tmp.buyFirmId GROUP BY tmp.buyFirmId,buyFirm.firmName) tmp1 where 1=1
BanksPaymentDataDAO_001=insert T_Order_Payment (OrderId,FirmId,TraderId,BankID,BkBranch,BkAccount,OverShortAmount,Status,Remarks) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f)
BanksPaymentDataDAO_002=update T_Order_Payment set Remarks =\u003f where OrderId = \u003f
DeliveryFreightFeeDAO_001=update T_DeliveryFreightFee set PaidSellFreight = ShouldPaySellPenalty+ ISNULL(OverloadFreight,0),PaidSellFreightBY = \u003f,PaidSellFreightTime = GETDATE(),REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where OrderID = \u003f and DISABLED = 0 and ShouldPaySellPenalty > 0 
DeliveryFreightFeeDAO_002=select fee.* from T_DeliveryFreightFee fee INNER JOIN T_Delivery delivery ON delivery.DeliveryID =  fee.DeliveryID and delivery.DeliveryStatus >= 17 and delivery.DeliveryStatus not in(70,75) where fee.OrderID = \u003f and fee.DISABLED = 0
DeliveryFreightFeeDAO_003=select fee.* from T_DeliveryFreightFee fee where fee.DeliveryID = \u003f and fee.DISABLED = 0
DeliveryFreightFeeDAO_004=update T_DeliveryFreightFee set BuyShouldPayFreight = \u003f,BuyPaidFreight = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where DeliveryID = \u003f and DISABLED = 0
DeliveryFreightFeeDAO_005=update T_DeliveryFreightFee set DISABLED = 1,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where DeliveryID = \u003f and DISABLED = 0
DeliveryFreightFeeDAO_006=update T_DeliveryFreightFee set OverloadFreight = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where DeliveryID = \u003f and DISABLED = 0
DeliveryFreightFeeDAO_007=select fee.* from T_DeliveryFreightFee fee INNER JOIN T_Delivery delivery ON delivery.DeliveryID =  fee.DeliveryID and delivery.DeliveryStatus >= 17 where fee.OrderID = \u003f and fee.DISABLED = 0
#ExportOrderDAO_001 = SELECT * from (select * from (select t1.TradeUnitNumber * ISNULL(t1.DeliveryQuantity, 0) as orderTotalDeliveryQuantity, t1.OrderId,t1.SellFirmId,t1.BuyFirmId, t1.TradeTmptId, t1.StoreContactName,t1.DeliveryEndDate, t1.SettlementMethod, t1.TotalQuantity, t1.StoreHouseFN, t1.PaymentTime, t1.TradeDate, t1.TradeStatus, t1.IsGoodsController, t1.SellArrivalTime, leads.IsRealName as isRealName, sourcePlace.Name as sourcePlaceName, leads.ConformProduct as conformProduct, leads.ExtraLogisticsCost as extraLogisticsCost, leads.WHAddress as wHAddress, buyerTrader.TraderName as buyTraderName, dbo.base64_utf8decode(buyerUser.Mobile) as buyTraderTelPhone, sellerTrader.TraderName as sellTraderName, dbo.base64_utf8decode(sellerUser.Mobile) as sellTraderTelPhone, isNull(t2.FirmName, '') as sellFirmName, isNull(t3.FirmName, '') as buyFirmName, CAST(t4.CategoryName AS VARCHAR) + '/' + CAST(t5.BrandName AS VARCHAR) as goodName, isNull(t7.Name, '') as deliveryPlaceName from T_Order t1 inner join C_Firm t2 on t1.SellFirmId = t2.FirmID inner join C_Firm t3 on t1.BuyFirmId = t3.FirmID left join VW_Crm_CategorySpecial t4 on t1.CategoryLeafID = t4.ID left join VW_Crm_Brand t5 on t1.BrandID = t5.ID left join VW_Crm_DeliveryPlace t7 on t1.DeliveryPlaceId = t7.ID LEFT JOIN C_Trader buyerTrader ON buyerTrader.TraderID = t1.BuyTraderId LEFT JOIN C_User buyerUser ON buyerUser.UserCode = buyerTrader.UserCode LEFT JOIN C_Trader sellerTrader ON sellerTrader.TraderID = t1.SellTraderId LEFT JOIN C_User sellerUser ON sellerUser.UserCode = sellerTrader.UserCode inner JOIN T_Leads leads ON leads.ID = t1.LeadsID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID = leads.SourcePlaceID) t21 where 1 = 1 and t21.TradeStatus != -1) temp where 1 = 1
ExportOrderDAO_001 = SELECT * FROM ( SELECT t1.TradeUnitNumber * ISNULL(t1.DeliveryQuantity, 0) AS orderTotalDeliveryQuantity, t1.OrderId, t1.SellFirmId, t1.BuyFirmId, t1.TradeTmptId, t1.StoreContactName, t1.DeliveryEndDate, t1.SettlementMethod, t1.TotalQuantity, t1.StoreHouseFN, t1.PaymentTime, t1.TradeDate, t1.TradeStatus, t1.IsGoodsController, t1.SellArrivalTime, leads.IsRealName AS isRealName, sourcePlace.Name AS sourcePlaceName, leads.ConformProduct AS conformProduct, leads.ExtraLogisticsCost AS extraLogisticsCost, leads.WHAddress AS wHAddress, buyerTrader.TraderName AS buyTraderName, dbo.base64_utf8decode (buyerUser.Mobile) AS buyTraderTelPhone, sellerTrader.TraderName AS sellTraderName, dbo.base64_utf8decode (sellerUser.Mobile) AS sellTraderTelPhone, isNull(t2.FirmName, '') AS sellFirmName, isNull(t3.FirmName, '') AS buyFirmName, CAST (t4.CategoryName AS VARCHAR) + '/' + CAST (t5.BrandName AS VARCHAR) AS goodName, isNull(t7.Name, '') AS deliveryPlaceName FROM T_Order t1 INNER JOIN C_Firm t2 ON t1.SellFirmId = t2.FirmID INNER JOIN C_Firm t3 ON t1.BuyFirmId = t3.FirmID LEFT JOIN VW_Crm_CategorySpecial t4 ON t1.CategoryLeafID = t4.ID LEFT JOIN VW_Crm_Brand t5 ON t1.BrandID = t5.ID LEFT JOIN VW_Crm_DeliveryPlace t7 ON t1.DeliveryPlaceId = t7.ID LEFT JOIN C_Trader buyerTrader ON buyerTrader.TraderID = t1.BuyTraderId LEFT JOIN C_User buyerUser ON buyerUser.UserCode = buyerTrader.UserCode LEFT JOIN C_Trader sellerTrader ON sellerTrader.TraderID = t1.SellTraderId LEFT JOIN C_User sellerUser ON sellerUser.UserCode = sellerTrader.UserCode INNER JOIN T_Leads leads ON leads.ID = t1.LeadsID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID = leads.SourcePlaceID ) temp WHERE 1 = 1 AND temp.TradeStatus != - 1
#\u7cfb\u7edf\u540e\u53f0\u7ba1\u7406\u76f8\u5173#
SystemMgrDAO_001 = SELECT mu.id,mu.Name,mu.Description,mu.Status,mu.UserID,mu.REC_CREATEBY as recCreateBy,mu.REC_CREATETIME as recCreateTime,mu.REC_MODIFYBY as recModifyBy,mu.REC_MODIFYTIME as recModifyTime FROM M_User mu  where 1=1
SystemMgrDAO_002 = INSERT INTO M_User(UserID,Name,Password,Description,Status,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
SystemMgrDAO_003 = UPDATE M_User SET Password =\u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME= GETDATE() where id = \u003f
SystemMgrDAO_004 = update M_User SET   Status =\u003f  where id in 
#SystemMgrDAO_005 = SELECT mr.id FROM M_Right mr LEFT JOIN M_User_Right mur ON mur.RightID = mr.id INNER JOIN M_User mu ON mu.id = mur.UserID WHERE mu.id = \u003f UNION ALL SELECT mr.id FROM M_Right mr LEFT JOIN M_Role_Right mrr ON mrr.RightID = mr.id LEFT JOIN M_Role mRole on mRole.id = mrr.RoleID LEFT JOIN M_User_Role mur on mur.RoleID = mRole.id INNER JOIN M_User mu on mu.id = mur.UserID WHERE mu.id = \u003f#
SystemMgrDAO_005 = SELECT mr.id FROM M_Right mr LEFT JOIN M_User_Right mur ON mur.RightID = mr.id INNER JOIN M_User mu ON mu.id = mur.UserID WHERE mu.id = \u003f
SystemMgrDAO_006 = SELECT mr.id FROM M_Right mr LEFT JOIN M_User_Right mur ON mur.RightID = mr.id LEFT JOIN M_User mu ON mu.id = mur.UserID UNION ALL SELECT mr.id  FROM M_Right mr LEFT JOIN M_Role_Right mrr ON mrr.RightID = mr.id LEFT JOIN M_Role mRole on mRole.id = mrr.RoleID LEFT JOIN M_User_Role mur on mur.RoleID = mRole.id LEFT JOIN M_User mu on mu.id = mur.UserID 
SystemMgrDAO_007 = SELECT mr.id,mr.Url as treeUrl,mr.ParentID,mr.Name as treeName,mr.Icon,mr.ModuleID,mr.Seq,mr.IsVisible,mr.Type as treeType  FROM M_Right mr 
SystemMgrDAO_008 = delete from M_User_Right where UserID=\u003f
SystemMgrDAO_009 = insert into M_User_Right (UserID,RightID)VALUES(\u003f,\u003f) 
SystemMgrDAO_010 = SELECT mr.* from M_Role mr where 1=1 
SystemMgrDAO_011 = INSERT INTO M_Role(Name,Description,RoleCode)VALUES(\u003f,\u003f,\u003f)
SystemMgrDAO_012 = DELETE FROM M_Role where id = \u003f
SystemMgrDAO_013 = INSERT INTO M_User_Role(RoleID,UserID)VALUES(\u003f,\u003f)
SystemMgrDAO_014 = SELECT mu.id,mu.UserID,mu.Name,mu.Description,mr.Name as roleName,mr.id as roleID  FROM M_User mu INNER  JOIN M_User_Role mur ON mur.UserID = mu.id INNER  JOIN M_Role mr ON mr.id = mur.RoleID WHERE 1=1
SystemMgrDAO_015 = DELETE from M_User_Role where RoleID=\u003f and UserID =\u003f
SystemMgrDAO_016 = SELECT mu.id,mu.Name,mu.Description,mu.Status,mu.UserID,mu.REC_CREATEBY as recCreateBy,mu.REC_CREATETIME as recCreateTime,mu.REC_MODIFYBY as recModifyBy,mu.REC_MODIFYTIME as recModifyTime FROM M_User mu  WHERE id NOT IN 
SystemMgrDAO_017 = SELECT mr.id  FROM M_Right mr INNER  JOIN M_Role_Right mrr ON mrr.RightID = mr.id INNER JOIN M_Role mRole ON mRole.id = mrr.RoleID WHERE mRole.id = \u003f
SystemMgrDAO_018 = delete from M_Role_Right where RoleID=\u003f
SystemMgrDAO_019 = insert into M_Role_Right (RoleID,RightID)VALUES(\u003f,\u003f) 
SystemMgrDAO_020 = SELECT  mr.Name as roleName FROM M_User mu  LEFT JOIN M_User_Role mur ON mur.UserID = mu.id LEFT JOIN M_Role mr ON mr.id = mur.RoleID  where mu.Status = 1 and mu.id =\u003f
SystemMgrDAO_021 = UPDATE M_User SET Name =\u003f,Description=\u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME= GETDATE() where id = \u003f
SystemMgrDAO_022 = SELECT mr.id  FROM M_Right mr INNER  JOIN M_User_Right mur ON mur.RightID = mr.id INNER JOIN M_User mu ON mu.id = mur.UserID WHERE mu.id =\u003f
#SystemMgrDAO_023 = SELECT mr.id as id,mr.Name as text ,mr.Icon as icon,mr.Url as sref,mr.Type as type FROM M_Right mr INNER JOIN M_User_Right mur ON mur.RightID = mr.id INNER JOIN M_User mu ON mu.id = mur.UserID  WHERE mu.UserID=\u003f and mr.Type in(-2) and mr.IsVisible = 1 ORDER BY mr.Seq ASC
SystemMgrDAO_023 = SELECT distinct(rights.id) as id,rights.Name as text,rights.Icon as icon,rights.Url as sref,rights.Type as type,rights.Seq FROM  M_Right rights INNER JOIN M_Role_Right roleRight on roleRight.RightID = rights.id and roleRight.RoleID in (select userRole.RoleID from M_User users LEFT JOIN M_User_Role userRole on userRole.UserID = users.id where users.UserID =\u003f)  WHERE rights.IsVisible = 1 and rights.Type in (-2) ORDER BY rights.Seq ASC
SystemMgrDAO_024 = SELECT DISTINCT(mr.id) as id,mr.Seq,mr.Name as text,mr.Icon as icon,mr.Url as sref FROM M_Right mr  INNER JOIN M_Role_Right mur ON mur.RightID = mr.id INNER JOIN M_User_Role ur ON ur.RoleID = mur.RoleID  INNER JOIN M_User mu ON mu.id = ur.UserID WHERE mu.UserID = \u003f and mr.ParentID = \u003f and   mr.IsVisible = 1 ORDER BY mr.Seq ASC
SystemMgrDAO_025 = SELECT id from M_User WHERE id IN(SELECT UserID from M_User_Role WHERE RoleID =\u003f)
#SystemMgrDAO_026 = SELECT mr.id as id,mr.Name as text ,mr.Icon as icon,mr.Url as sref,mr.Type as type FROM M_Right mr INNER JOIN M_User_Right mur ON mur.RightID = mr.id INNER JOIN M_User mu ON mu.id = mur.UserID WHERE mu.UserID = \u003f AND mr.IsVisible = 1  and mr.ParentID =\u003f ORDER BY mr.Seq ASC
SystemMgrDAO_026 = SELECT distinct(rights.id) as id, rights.Name as text, rights.Icon as icon, rights.Url as sref, rights.Type as type,rights.Seq FROM M_Right rights INNER JOIN M_Role_Right roleRight on roleRight.RightID = rights.id and roleRight.RoleID in (select userRole.RoleID from M_User users LEFT JOIN M_User_Role userRole on userRole.UserID = users.id where users.UserID =\u003f) WHERE rights.IsVisible = 1 and rights.ParentID = \u003f ORDER BY rights.Seq ASC
SystemMgrDAO_027 = SELECT * FROM M_User where userID =\u003f
SystemMgrDAO_028 = INSERT INTO M_Right(ParentID,Name,Icon,Url,ModuleID,Seq,IsVisible,Type) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
SystemMgrDAO_029 = UPDATE M_Right SET ParentID = \u003f,Name =\u003f,Icon =\u003f,Url=\u003f,ModuleID =\u003f,Seq =\u003f ,IsVisible =\u003f,Type =\u003f where id = \u003f
SystemMgrDAO_030 = select rights.id AS id,rights.ParentID as parentID,rights.[Name] as treeName,rights.Icon as icon,rights.ModuleID as moduleID,rights.Seq as seq,rights.IsVisible as isVisible,rights.[Type] as treeType,rights.[Url] as treeUrl from M_Right  rights  left join M_Role_Right roleRight  ON roleRight.RightID = rights.id where roleRight.RoleID = \u003f and rights.Type = \u003f 
SystemMgrDAO_031 = select rights.id AS id,rights.ParentID as parentID,rights.[Name] as treeName,rights.Icon as icon,rights.ModuleID as moduleID,rights.Seq as seq,rights.IsVisible as isVisible,rights.[Type] as treeType,rights.[Url] as treeUrl from M_Right  rights  where 1=1 order by rights.[Type] ASC
SystemMgrDAO_032 = select rights.id AS id,rights.ParentID as parentID,rights.[Name] as treeName,rights.Icon as icon,rights.ModuleID as moduleID,rights.Seq as seq,rights.IsVisible as isVisible,rights.[Type] as treeType,rights.[Url] as treeUrl from M_Right  rights  where rights.id = \u003f
SystemMgrDAO_033 = select users.* from M_User users inner join M_User_Role ur on ur.UserID = users.id and ur.RoleID in (select roles.id from M_Role roles where roles.RoleCode = \u003f)
SystemMgrDAO_034 = select roles.* from  M_User muser INNER JOIN M_User_Role userRole on userRole.UserID = muser.id INNER join  M_Role roles on roles.id = userRole.RoleID where muser.UserID = \u003f
SystemMgrDAO_035 = insert into C_UserPasswordReset(UserCode,ResetTime,UserFromID,Remark)VALUES(\u003f,GETDATE(),\u003f,\u003f)
SystemMgrDAO_036 = SELECT * FROM (SELECT dbo.base64_utf8decode(cu.Mobile) AS moreMobile, cu.UserCode AS userCode, 0 AS isOpt FROM C_User cu UNION ALL SELECT dbo.base64_utf8decode(cus.MoreMobile) AS moreMobile, cu.UserCode AS userCode, 1 AS isOpt FROM C_User cu LEFT JOIN C_User_SendMobile cus ON cus.UserCode = cu.UserCode WHERE cus.DISABLED = 0) TEMP WHERE 1=1 and TEMP.userCode = \u003f
#\u4ea4\u6536\u670d\u52a1\u76f8\u5173#
DeliveryDAO_001 = SELECT * FROM ( SELECT od.TradeUnitNumber * dl.DeliveryQuantity AS deliveryTotalQuantity, dl.*, dl.DocMarker AS documentMaker, od.DeliveryEndDate AS delievryDate, od.GoodsType, od.TradeTmptId, od.TradeUnitNumber, od.SellFirmId, od.BuyFirmId, od.CategoryLeafID, crmCat.CategoryName, od.BrandID, crmBr.BrandName, od.SourcePlaceID, vcs.Name AS SourcePlaceName, od.DeliveryPlaceId, crmDl.Name AS DeliveryPlaceName, od.Amount, CAST ( crmCat.CategoryName AS VARCHAR ) + '-' + CAST (crmBr.BrandName AS VARCHAR) AS goodName, cfS.FirmName AS sellFirmName, cfB.FirmName AS buyFirmName, CAST (place.CityName AS VARCHAR) + '-' + CAST (crmDl.Name AS VARCHAR) AS deliveryPlace, ttl.TradeTmptName, od.Price AS unitPrice, ( SELECT TOP 1 IsNull(t.License, '') + IsNull(t.DriverIDNumber, '') + IsNull(t.ContactName, '') FROM T_DeliveryDetail t WHERE t.DeliveryID = dl.DeliveryID ) AS DeliveryInfo, ( SELECT COUNT (trf.FileID) FROM T_Receipt tr INNER JOIN T_Receipt_File trf ON trf.ReceiptID = tr.ID WHERE trf.FileID != 0 AND tr.OrderID = dl.OrderID ) AS receiptFileNum, ( SELECT TOP 1 tos.FileUpdateTime FROM T_OrderSinopec tos WHERE tos.DeliveryID = dl.DeliveryID AND tos.UploadType = 0 ) AS fileUpdateTime FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID LEFT JOIN C_Firm cfS ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_DeliveryDetail td1 ON td1.DeliveryID = dl.DeliveryID LEFT JOIN T_TrasferGoodsDetail tt2 ON tt2.DeliveryID = dl.DeliveryID LEFT JOIN T_TradeTemplate ttl ON ttl.TradeTmptId = od.TradeTmptId LEFT JOIN VW_Crm_SourcePlace vcs ON vcs.ID = od.SourcePlaceID WHERE 1 = 1 ) AS TEMP WHERE 1 = 1    
DeliveryDAO_002 = SELECT od.SourcePlaceID AS sourcePlaceID, crmBr.ID AS brandID, [dbo].base64_utf8decode (cu.Mobile) AS sellUserMobile, dl.DeliveryQuantity * od.TradeUnitNumber AS deliveryTotalQuantity, ISNULL( deliveryFreightFee.BuyShouldPayFreight, 0 ) AS buyShouldPayFreight, ISNULL( deliveryFreightFee.BuyPaidFreight, 0 ) AS buyPaidFreight, ( ISNULL(dl.DeliveryQuantity, 0) * ISNULL(od.TradeUnitNumber, 0) - dl.TakenQuantity ) AS overloadQuantity, ISNULL( historyDeliveryFreightFee.BuyPaidFreight, 0 ) AS historyBuyPaidFreight, ISNULL( historyDeliveryFreightFee.BuyShouldPayFreight, 0 ) AS historyBuyShouldPayFreight, historyDeliveryFreightFee.DeliveryID AS historyDeliveryID, dl.*, od.TradeDate, cfS.PayType, od.SellTakenTradeFee, od.SellCreditFee AS sellCreditTradeFee, od.TotalQuantity, od.SellFirmId, od.BuyFirmId, od.TradeUnitNumber AS tradeUnitNumber, od.DeliveryPlaceId, od.CategoryLeafID, CAST ( crmCat.CategoryName AS VARCHAR ) + '-' + CAST (crmBr.BrandName AS VARCHAR) AS goodName, crmBr.BrandName AS brandName, od.sellFeeRate, od.BuyFeeRate, cfS.FirmName AS sellFirmName, cfB.FirmName AS buyFirmName, CAST (place.CityName AS VARCHAR) + '-' + CAST (crmDl.Name AS VARCHAR) AS deliveryPlace, ttl.TradeTmptName AS tradeTmptName,ttl.TradeType, od.Price AS unitPrice, od.GoodsType, crmPlace.Name AS producePlace, od.StoreHouseFN, od.StoreContactName, od.PackageStandard AS packageStandard, od.TradeStatus AS tradeStatus, dl.HistoryDeliveryID AS historySinopecDeliveryID, ct.UserCode AS userCode, ISNULL(delDistributionDetailHistory.SmallFee,0) as smallFeeHistory, ISNULL(delDistributionDetail.SmallFee, 0) as smallFee FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID LEFT JOIN C_Firm cfS ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_TradeTemplate ttl ON ttl.TradeTmptId = od.TradeTmptId LEFT JOIN VW_Crm_SourcePlace crmPlace ON crmPlace.id = od.SourcePlaceID LEFT JOIN C_Trader ct ON od.SellTraderId = ct.TraderID LEFT JOIN C_User cu ON cu.UserCode = ct.UserCode LEFT JOIN T_DeliveryFreightFee deliveryFreightFee ON deliveryFreightFee.DISABLED = 0 AND deliveryFreightFee.DeliveryID = dl.DeliveryID LEFT JOIN T_BreachContractApply breachContractApply ON breachContractApply.DeliveryID = dl.DeliveryID LEFT JOIN T_DeliveryFreightFee historyDeliveryFreightFee ON historyDeliveryFreightFee.DISABLED = 0 AND historyDeliveryFreightFee.DeliveryID = breachContractApply.HistoryDeliveryID LEFT JOIN T_DelDistributionDetail delDistributionDetailHistory on delDistributionDetailHistory.DeliveryID = historyDeliveryFreightFee.DeliveryID LEFT JOIN T_DelDistributionDetail delDistributionDetail on delDistributionDetail.DeliveryID = dl.DeliveryID WHERE dl.DeliveryID = ?
DeliveryDAO_003 = INSERT INTO T_DeliveryOpeLog(DeliveryID,UserID,OpeContent,OpeComment,OpeDateTime)VALUES(\u003f,\u003f,\u003f,\u003f, GETDATE()) 
DeliveryDAO_004 = SELECT dlLog.*,mu.Name as opeUserName FROM T_DeliveryOpeLog dlLog LEFT JOIN M_User mu ON mu.UserID = dlLog.UserID where dlLog.DeliveryID =\u003f ORDER BY dlLog.OpeDateTime DESC
#DeliveryDAO_005 = UPDATE T_Delivery SET Status = 2 where DeliveryID=\u003f
DeliveryDAO_006 = UPDATE T_Delivery SET PayedMoney=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_007 = SELECT * FROM F_FirmFunds ff INNER JOIN T_Order ord ON ord.BuyFirmId = ff.FIRMID INNER JOIN T_Delivery td ON td.OrderID = ord.OrderId WHERE td.DeliveryID =\u003f
DeliveryDAO_008 = UPDATE F_FirmFunds SET BALANCE =\u003f where FIRMID=\u003f
DeliveryDAO_009 = UPDATE T_Delivery SET TakenMoney=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_010 = SELECT ord.*, template.TradeType FROM T_Order ord INNER JOIN T_Delivery td ON td.OrderID \= ord.OrderId LEFT JOIN T_TradeTemplate template ON ord.tradeTmptId \= template.tradeTmptId WHERE td.DeliveryID \= \u003f
DeliveryDAO_011 = UPDATE T_Delivery SET SellCreditDeposit=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_012 = UPDATE T_Delivery SET TakenBSDeposit =\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_013 = UPDATE T_Delivery SET SellPenalty=\u003f ,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_014 = UPDATE T_Delivery SET DeliveryComment=\u003f,OverloadFee=\u003f,TakenQuantity=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f where DeliveryID=\u003f  
DeliveryDAO_015 = UPDATE T_Delivery SET OverloadFee=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_016 = SELECT * FROM F_FirmFunds ff INNER JOIN T_Order ord ON ord.SellFirmId = ff.FIRMID INNER JOIN T_Delivery td ON td.OrderID = ord.OrderId WHERE td.DeliveryID =\u003f
DeliveryDAO_017 = UPDATE T_Delivery SET TakenSellPenalty=\u003f,TakenSSDeposit=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_018 = UPDATE T_Delivery SET TakenBuyPenalty=\u003f,TakenBSDeposit=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f 
DeliveryDAO_019 = UPDATE T_Delivery SET TakenMoney=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_020 = UPDATE T_Delivery SET PayedMoney=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_021 = UPDATE T_Delivery SET SellTakenSSDeposit=\u003f,TakenSellPenalty=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_022 = UPDATE T_Delivery SET TakenBSDeposit=\u003f,TakenBuyPenalty=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_023 = UPDATE T_Delivery SET BuyPenalty=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_024 = UPDATE T_Delivery SET SellTakenSSDeposit=\u003f,SellCreditDeposit=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_025 = SELECT trf.FileID from T_Order od LEFT JOIN T_Receipt recepet on recepet.OrderID = od.OrderId INNER JOIN T_Receipt_File trf ON trf.ReceiptID = recepet.ID where od.OrderId =\u003f and trf.FileID !=0 ORDER BY trf.ID ASC
DeliveryDAO_026 = update T_Order set SignQuantity = (select SignQuantity from T_Order where OrderId=\u003f)+\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f  where  OrderId=\u003f
DeliveryDAO_027 = UPDATE T_Delivery SET ViolationStatus=\u003f where DeliveryID =\u003f 
#DeliveryDAO_028 = UPDATE T_Delivery SET Status = \u003f where DeliveryID =\u003f 
DeliveryDAO_029 = select * from T_Delivery where OrderID =\u003f 
DeliveryDAO_030 = update T_Order set TradeStatus =\u003f where OrderID =\u003f and TradeStatus !=\u003f
DeliveryDAO_031 = update T_DeliveryDetail set SendStatus=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f where DeliveryID =\u003f and SendStatus !=\u003f
DeliveryDAO_032 = update T_Delivery SET LogisticsStatus =\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=\u003f where DeliveryID =\u003f and LogisticsStatus !=\u003f
DeliveryDAO_033 = SELECT  * from (SELECT dl.DeliveryID as deliveryID,dl.TailAdjustStatus as tailAdjustStatus,dl.DeliveryType as deliveryType,dl.DocMarker AS documentMaker,dl.ProcessStatus,od.DeliveryEndDate as delievryDate,od.GoodsType as goodsType,dl.LogisticsStatus,dl.REC_CREATETIME,dl.DeliveryStatus as deliveryStatus, dl.OrderID as OrderID,dl.DeliveryID as recordID,CAST(crmCat.CategoryName AS VARCHAR)+'-'+CAST(crmBr.BrandName  AS VARCHAR) AS goodName ,cfS.FirmName as sellFirmName ,cfB.FirmName as buyFirmName FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID LEFT JOIN C_Firm  cfS ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm  cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN  VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_TradeTemplate ttl ON ttl.TradeTmptId = od.TradeTmptId  LEFT JOIN T_DeliveryDetail  td1 ON td1.DeliveryID = dl.DeliveryID LEFT JOIN T_TrasferGoodsDetail  tt2 ON tt2.DeliveryID = dl.DeliveryID where 1=1) as temp where 1=1
DeliveryDAO_034 = SELECT * from (SELECT dl.*,od.SellFirmId,od.BuyFirmId,od.DeliveryPlaceId,od.CategoryLeafID,CAST(crmCat.CategoryName AS VARCHAR)+'-'+CAST(crmBr.BrandName  AS VARCHAR) AS goodName ,cfS.FirmName as sellFirmName ,cfB.FirmName as buyFirmName,CAST(place.CityName AS VARCHAR)+'-'+CAST(crmDl.Name  AS VARCHAR) AS deliveryPlace,ttl.TradeTmptName,od.Price as unitPrice,( select top 1 IsNull(t.License,'')+IsNull(t.DriverIDNumber,'')+IsNull(t.ContactName,'') from T_DeliveryDetail t where t.DeliveryID = dl.DeliveryID) as DeliveryInfo,(SELECT count(trf.FileID) from  T_Receipt tr inner join T_Receipt_File trf on trf.ReceiptID=tr.ID where trf.FileID!=0 and tr.OrderID=dl.OrderID) as receiptFileNum FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID LEFT JOIN C_Firm  cfS ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm  cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN  VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_TradeTemplate ttl ON ttl.TradeTmptId = od.TradeTmptId where  1=1 and dl.ProcessStatus = 0 ) as temp where 1=1
DeliveryDAO_035 = SELECT  * from (SELECT dl.LogisticsStatus,dl.REC_CREATETIME, dl.OrderID as OrderID,dl.DeliveryID as recordID,CAST(crmCat.CategoryName AS VARCHAR)+'-'+CAST(crmBr.BrandName  AS VARCHAR) AS goodName ,cfS.FirmName as sellFirmName ,cfB.FirmName as buyFirmName FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID LEFT JOIN C_Firm  cfS ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm  cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN  VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_TradeTemplate ttl ON ttl.TradeTmptId = od.TradeTmptId where  1=1  and dl.ProcessStatus = 0 ) as temp where 1=1
DeliveryDAO_036 = SELECT  ISNULL(SUM(PayedMoney)+SUM(TakenBSFee) ,0) as takenMoeny from T_Delivery 
DeliveryDAO_037 = UPDATE T_Delivery SET PaidSellPenalty=\u003f where DeliveryID=\u003f
DeliveryDAO_038 = UPDATE T_Delivery SET PaidBuyPenalty=\u003f where DeliveryID=\u003f
DeliveryDAO_039 = INSERT INTO T_Delivery(DeliveryID,OrderID,LeadsID,DISABLED,DeliveryFirmId,DeliveryTraderId,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,DeliveryQuantity,TakenQuantity,Money,TakenMoney,PayedMoney,OverloadFee,Price,SellSettleDeposit,SellTakenSSDeposit,SellCreditDeposit,TakenBSFee,TakenBSDeposit,SellPenalty,TakenSellPenalty,BuyPenalty,TakenBuyPenalty,DeliveryType,DeliveryAttID,DeliveryStatus,ProcessInstanceID,ProcessStatus,ViolationStatus,LogisticsStatus,DeliveryComment,PaidSellPenalty,PaidBuyPenalty,TailAdjustStatus,DocMarker,DeliveryWeight,HistoryDeliveryID,UpdateLogisticalDetStatus)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
DeliveryDAO_040 = INSERT INTO T_DeliveryDetail(DeliveryID,DISABLED,StartDate,EndDate,LogisticsCorp,DriverIDNumber,License,ContactTel,ContactName,Remark,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,SendStatus)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
DeliveryDAO_041 = INSERT INTO T_TrasferGoodsDetail(DeliveryID,DISABLED,ValidDate,FeesItem,Remark,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,ContactName,ContactTel,StoreHouseNum)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
DeliveryDAO_042 = SELECT * FROM ( SELECT breachContractApplyGroup.*, (SELECT TOP(1) C.REC_CREATETIME FROM T_BreachContractApply C WHERE C.ID = breachContractApplyGroup.ID) AS REC_CREATETIME, (SELECT TOP(1) D.REC_MODIFYTIME FROM T_BreachContractApply D WHERE D.ID = breachContractApplyGroup.ID) AS REC_MODIFYTIME, ( SELECT SUM (b.Quantity) FROM T_BreachContractApply b WHERE b.ID = breachContractApplyGroup.ID AND b.OrderID = breachContractApplyGroup.OrderID ) AS Quantity, ISNULL(users.UserName, 'system') AS createSourceBy, orders.GoodsType AS goodsType, orders.TradeTmptId, buyFirm.FirmID AS buyFirmId, buyFirm.FirmName AS buyFirmName, sellFirm.FirmID AS sellFirmId, sellFirm.FirmName AS sellFirmName, crmCat.CategoryName AS categoryName, crmBr.BrandName AS brandName, CAST (crmCat.CategoryName AS VARCHAR) + '-' + CAST (crmBr.BrandName AS VARCHAR) AS goodsName, orders.TradeStatus AS tradeStatus FROM ( SELECT a.ID, a.OrderID, a.DISABLED, a.Origin, a.Reson, a.Status, a.REC_CREATEBY, a.REC_MODIFYBY, a.BreachType FROM T_BreachContractApply a GROUP BY a.ID, a.OrderID, a.DISABLED, a.Origin, a.Reson, a.Status, a.REC_CREATEBY, a.REC_MODIFYBY, a.BreachType ) breachContractApplyGroup LEFT JOIN T_Order orders ON orders.OrderId = breachContractApplyGroup.OrderID LEFT JOIN C_Firm buyFirm ON buyFirm.FirmID = orders.BuyFirmId LEFT JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID LEFT JOIN C_User users ON users.UserCode = breachContractApplyGroup.REC_CREATEBY ) TEMP WHERE 1 = 1
ExportDeliveryDAO_001=select d.*, o.TradeUnitNumber,o.SellFirmId, sf.FirmName as SellFirmName, o.BuyFirmId, bf.FirmName as BuyFirmName, o.CategoryLeafID, vcc.CategoryName, o.BrandID, vcb.BrandName, o.SourcePlaceID, vcs.Name as SourcePlaceName, o.DeliveryPlaceId, vcd.Name as DeliveryPlaceName, o.Amount from T_Delivery d left join T_Order o on d.OrderID=o.OrderId left join C_Firm sf on sf.FirmID=o.SellFirmId left join C_Firm bf on bf.FirmID=o.BuyFirmId inner join VW_Crm_CategorySpecial vcc on vcc.ID=o.CategoryLeafID inner join VW_Crm_Brand vcb on vcb.ID=o.BrandID inner join VW_Crm_SourcePlace vcs on vcs.ID=o.SourcePlaceID inner join VW_Crm_DeliveryPlace vcd on vcd.ID=o.DeliveryPlaceId where 1=1
ExportDeliveryDetailDAO_001=select t.DeliveryID, t.DISABLED, t.StartDate, t.EndDate, t.LogisticsCorp, t.LogisticsCorpID, t.DriverIDNumber, t.DriverName, t.License, t.ContactTel, t.ContactName,t.Remark, t.REC_CREATEBY, t.REC_CREATETIME, t.REC_MODIFYBY, t.REC_MODIFYTIME from T_DeliveryDetail t where 1=1 and t.DISABLED=0 and t.SendStatus=0
ExportDelDistributionDetailDAO_001=select t.* from T_DelDistributionDetail t where 1=1 and t.DISABLED=0
ExportFirmFundsDAO_001=select f.*, c.FirmName as FirmName, isnull(n.NeedMoney,0) as NeedMoney, isnull(s.LastBalance,0) as SLastBalance, isnull(s.Frozenfunds,0) as SFrozenfunds, isnull(s.Balance,0) as SBalance from F_FIRMFUNDS f left join C_Firm c on c.FirmID=f.FIRMID left join S_FIRMFUNDS s on s.FirmID=f.FIRMID left join (select o.BuyFirmId, sum((o.Quantity-isnull(o.DeliveryQuantity,0))*o.Price) as NeedMoney from T_Order o group by o.BuyFirmId) n on n.BuyFirmId=f.FIRMID where 1=1
DeliveryDetailDAO_001=update T_DeliveryDetail set DISABLED=\u003f, StartDate=\u003f, EndDate=\u003f,LogisticsCorp=\u003f, LogisticsCorpID=\u003f, DriverIDNumber=\u003f,DriverName=\u003f, License=\u003f, ContactTel=\u003f, ContactName=\u003f,  Remark=\u003f, REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate(),SendStatus=\u003f where DeliveryID=\u003f				
TrasferGoodsDetailDAO_001=update T_TrasferGoodsDetail set DISABLED=\u003f,ValidDate=\u003f,FeesItem=\u003f,Remark=\u003f,StoreHouseNum=\u003f,REC_MODIFYBY=\u003f,ContactName=\u003f,ContactTel=\u003f,REC_MODIFYTIME=getDate() where DeliveryID=\u003f
DeliveryDAO_043=SELECT d.DeliveryID, crmD.Name as deliveryPlaceName, sourcePlace.Name AS sourcePlaceName, o.StoreHouseFN as storeHouseFN, f.FirmName FullName, o.OrderId, o.TradeUnitNumber, c.CategoryName, crmBr.BrandName, d.DeliveryQuantity, t.License, t.LogisticsCorp, ISNULL(t.ContactName, '') + '-' + ISNULL(t.DriverIDNumber, '') + '-' + ISNULL(t.ContactTel, '') Detail, t.Remark Remark, t.StartDate, t.EndDate FROM T_Delivery d INNER JOIN T_Order o ON d.OrderID = o.OrderId INNER JOIN C_Firm f ON f.FirmID = o.SellFirmId LEFT JOIN VW_Crm_CategorySpecial c ON o.CategoryLeafID = c.ID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = o.BrandID LEFT JOIN T_DeliveryDetail t ON d.DeliveryID = t.DeliveryID LEFT JOIN VW_Crm_DeliveryPlace crmD ON crmD.ID = o.DeliveryPlaceId LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID = o.SourcePlaceID WHERE d.DeliveryID=\u003f
DeliveryDAO_044=SELECT DeliveryType FROM T_Delivery WHERE DeliveryID=\u003f
DeliveryDAO_045=SELECT o.OrderId, sourcePlace.Name AS sourcePlaceName,crmD.Name as deliveryPlaceName, o.StoreHouseFN as storeHouseFN, o.TradeUnitNumber, f.FirmName as SellName, m.FirmName as BuyName, g.ContactName, g.ContactTel, g.StoreHouseNum, g.FeesItem, c.CategoryName, n.BrandName, o.Quantity, o.TradeDate, o.Remarks FROM T_Delivery d INNER JOIN T_Order o ON d.OrderID = o.OrderId INNER JOIN C_Firm f ON f.FirmID = o.SellFirmId INNER JOIN C_Firm m ON m.FirmID = o.BuyFirmId LEFT JOIN T_TrasferGoodsDetail g ON d.DeliveryID = g.DeliveryID LEFT JOIN VW_Crm_CategorySpecial c ON o.CategoryLeafID = c.ID LEFT JOIN VW_Crm_Brand n ON n.ID = o.BrandID LEFT JOIN VW_Crm_DeliveryPlace crmD ON crmD.ID = o.DeliveryPlaceId LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID = o.SourcePlaceID WHERE d.DeliveryID=\u003f
DeliveryDAO_046=SELECT DeliveryStatus FROM T_Delivery WHERE OrderID=\u003f
#DeliveryDAO_047=update T_Delivery set OperNotes = CONCAT(CONVERT(varchar(100), GETDATE(), 120)+'^'+\u003f+'^'+\u003f,'<br>',OperNotes),REC_MODIFYTIME = getDate(),REC_MODIFYBY = \u003f where DeliveryID = \u003f
DeliveryDAO_047=update T_Delivery set OperNotes = CONCAT(CONVERT(varchar(100), GETDATE(), 120)+'^'+\u003f+'^'+\u003f,'<br>',OperNotes),REC_MODIFYBY = \u003f where DeliveryID = \u003f
DeliveryDAO_048=select OperNotes From T_Delivery where DeliveryID = \u003f
DeliveryDAO_049 = UPDATE T_Delivery SET TakenBSFee =TakenBSFee+\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID=\u003f
DeliveryDAO_057 = SELECT ISNULL(SUM(DeliveryQuantity),0) FROM T_Delivery WHERE OrderID =\u003f AND DeliveryStatus IN(60,65)
DeliveryDAO_058 = select * from T_Delivery where DeliveryID =\u003f AND DeliveryStatus !=70 
DeliveryDAO_059=update T_Delivery set ConfirmReceive\= 1,REC_MODIFYBY \=?,REC_MODIFYTIME\=GETDATE()  where DeliveryID \= ?
STTradeTimeDAO_001=select count(t.SectionId) as isHave from T_TradeTime t where Convert(varchar(8),getDate(),108) between t.StartTime and t.EndTime and t.Status=0
STTmptSectionRlspDAO_001=select count(t.SectionId) as isHave from A_TmptSectionRlsp r left join T_TradeTime t on t.SectionId = r.SectionId where r.TradeTmptId = \u003f and Convert(varchar(8),getDate(),108) between t.StartTime and t.EndTime and t.Status=0 and r.Enabled='Y'
DeliveryInvoiceDAO_001=select d.DeliveryID as deliveryID, d.OrderId as orderId, o.BuyFirmId as buyFirmId, f.FirmName as firmName, fd.TaxNo as taxNo, f.AddressPV as fAddressPV, cPV.ShortName as fPVShortName, f.AddressCT as fAddressCT, cCT.ShortName as fCTShortName, f.AddressDT as fAddressDT, cDT.ShortName as fDTShortName, f.Address as fAddress, fd.ContactTelNo as fContactTelNo, fd.ContactMobile as fContactMobile, v.VatBankID as vatBankID, b.BankName as vBankName, v.VatBkBranch as vatBkBranch, v.VatBkAccount as vatBkAccount, o.CategoryLeafID as categoryLeafID, cs.CategoryName as categoryName, o.BrandID as brandID, cb.BrandName as brandName, isnull(d.DeliveryQuantity,0) as deliveryQuantity, isnull(d.TakenQuantity,0) as takenQuantity, isnull(d.Money,0) as money, isnull(d.TakenMoney,0) as takenMoney, isnull(d.PayedMoney,0) as payedMoney, isnull(d.Price,0) as price, v.VatAddressID as vatAddressID, a.AddPV as addPV, aPV.ShortName as vPVShortName, a.AddCT as addCT, aCT.ShortName as vCTShortName, a.AddDT as addDT, aDT.ShortName as vDTShortName, a.Address as vAddress, a.ContactName as vContactName, a.ContactTelNo as vContactTelNo from T_Delivery d left join T_Order o on o.OrderID=d.OrderId left join C_Firm f on f.FirmID=o.BuyFirmId left join C_FirmDetail fd on fd.FirmID=f.FirmID left join VW_Canton cPV on cPV.ID=f.AddressPV left join VW_Canton cCT on cCT.ID=f.AddressCT left join VW_Canton cDT on cDT.ID=f.AddressDT left join C_FirmVATInfo v on v.FirmID=f.FirmID left join VW_Bank b on b.BankID=v.VatBankID left join C_Address a on a.ID=v.VatAddressID left join VW_Canton aPV on aPV.ID=a.AddPV left join VW_Canton aCT on aCT.ID=a.AddCT left join VW_Canton aDT on aDT.ID=a.AddDT inner join VW_Crm_CategorySpecial cs on cs.ID=o.CategoryLeafID inner join VW_Crm_Brand cb on cb.ID=o.BrandID where 1=1
DeliveryDAO_050=update T_BreachContractApply set Remark = CONCAT(CONVERT(varchar(100), GETDATE(), 120)+'^'+\u003f+'^'+\u003f,'<br>',Remark),REC_MODIFYTIME = getDate(),REC_MODIFYBY = \u003f where ID = \u003f
DeliveryDAO_051=select Remark From T_BreachContractApply where ID = \u003f
DeliveryDAO_052 = update T_Delivery set PayedMoney = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate() where DeliveryID = \u003f
DeliveryDAO_053 = select * from T_BreachContractApply breachContractApply where breachContractApply.ID = \u003f
DeliveryDAO_054 = select breachContractApply.*,orders.TradeUnitNumber as tradeUnitNumber,(ISNULL(breachContractApply.Quantity,0)*orders.TradeUnitNumber) as quantityTon from T_BreachContractApply breachContractApply LEFT JOIN T_Order orders ON orders.OrderId = breachContractApply.OrderID where breachContractApply.DISABLED = 0 and  breachContractApply.ID = \u003f and BreachType = 0
DeliveryDAO_055 = select * from T_BreachContractApply breachContractApply where breachContractApply.DeliveryID = \u003f
DeliveryDAO_056 = update T_Delivery set isGetSinopecNumber = \u003f,REC_MODIFYBY =\u003f,REC_MODIFYTIME=GETDATE()  where DeliveryID = \u003f
ExportDelDistributionDetailDAO_002 = SELECT * FROM (SELECT od.TradeUnitNumber * dl.DeliveryQuantity AS deliveryTotalQuantity, dl.*, dl.DocMarker AS documentMaker, od.DeliveryEndDate AS delievryDate, od.GoodsType, od.TradeUnitNumber, od.SellFirmId, od.BuyFirmId, od.DeliveryPlaceId, od.CategoryLeafID, od.TradeTmptId, od.SourcePlaceID AS sourcePlaceID, sourcePlace.Name AS sourcePlaceName, CAST(crmCat.CategoryName AS VARCHAR) + '-' +CAST(crmBr.BrandName AS VARCHAR) AS goodName, cfS.FirmName AS sellFirmName, cfB.FirmName AS buyFirmName, CAST(place.CityName AS VARCHAR) + '-' +CAST(crmDl.Name AS VARCHAR) AS deliveryPlace, ttl.TradeTmptName, od.Price AS unitPrice, (SELECT top 1 IsNull(t.License, '') + IsNull(t.DriverIDNumber, '') + IsNull(t.ContactName, '') FROM T_DeliveryDetail t WHERE t.DeliveryID = dl.DeliveryID) AS DeliveryInfo, (SELECT count(trf.FileID) FROM T_Receipt tr INNER JOIN T_Receipt_File trf ON trf.ReceiptID = tr.ID WHERE trf.FileID != 0 AND tr.OrderID = dl.OrderID) AS receiptFileNum, (SELECT top 1 tos.FileUpdateTime FROM T_OrderSinopec tos WHERE tos.DeliveryID = dl.DeliveryID and tos.UploadType=0) AS fileUpdateTime, ISNULL(delDistributionDetail.FreightFee, 0) AS distributionFreightFee, delDistributionDetail.ContactName AS distributionContactName, delDistributionDetail.ContactMobile AS distributionContactMobile, delDistributionDetail.ContactTel AS distributionContactTel, delDistributionDetail.AddressDetail AS distributionAddressDetail, delDistributionDetail.Remark AS distributionRemark FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID LEFT JOIN C_Firm cfS ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_DelDistributionDetail delDistributionDetail ON delDistributionDetail.DeliveryID = dl.DeliveryID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID = od.SourcePlaceID LEFT JOIN T_TradeTemplate ttl ON ttl.TradeTmptId = od.TradeTmptId WHERE 1 = 1) AS TEMP WHERE 1 = 1
ExportDeliveryDao_002=SELECT * FROM(SELECT dl.*,(SELECT top 1 tos.FileUpdateTime FROM T_OrderSinopec tos WHERE tos.DeliveryID = dl.DeliveryID and tos.UploadType = 0) AS fileUpdateTime,od.TradeUnitNumber * dl.DeliveryQuantity AS deliveryTotalQuantity,CAST(crmCat.CategoryName AS VARCHAR) + '-' + CAST(crmBr.BrandName AS VARCHAR) AS goodName,cfS.FirmName AS sellFirmName,cfB.FirmName AS buyFirmName,od.DeliveryEndDate AS delievryDate,od.GoodsType,od.TradeUnitNumber,od.SellFirmId,od.BuyFirmId,od.DeliveryPlaceId,CAST(place.CityName AS VARCHAR) + '-' + CAST(crmDl.Name AS VARCHAR) AS deliveryPlace,od.CategoryLeafID,od.TradeTmptId,od.SourcePlaceID AS sourcePlaceID,sourcePlace.Name AS sourcePlaceName,od.StoreHouseFN,leads.WHAddress as wHAddress,od.StoreContactName,leads.ExtraLogisticsCost,deliveryOpeLog1.OpeDateTime as passDateTime,deliveryOpeLog2.OpeDateTime as uploadDateTime,deliveryOpeLog3.OpeDateTime as getSinopecNumberDateTime,deliveryDetail.StartDate as pickedUp_StartDate,deliveryDetail.EndDate as pickedUp_EndDate,deliveryDetail.LogisticsCorp as pickedUp_LogisticsCorp,deliveryDetail.LogisticsCorpID as pickedUp_LogisticsCorpID,deliveryDetail.DriverIDNumber as pickedUp_DriverIDNumber,deliveryDetail.DriverName as pickedUp_DriverName,deliveryDetail.License as pickedUp_License,deliveryDetail.ContactTel as pickedUp_ContactTel,deliveryDetail.ContactName as pickedUp_ContactName,deliveryDetail.Remark as pickedUp_Remark,trasferGoodsDetail.ValidDate as trasferGoods_ValidDate,trasferGoodsDetail.FeesItem as trasferGoods_FeesItem,trasferGoodsDetail.Remark as trasferGoods_Remark,trasferGoodsDetail.StoreHouseNum as trasferGoods_StoreHouseNum,trasferGoodsDetail.ContactName as trasferGoods_ContactName,trasferGoodsDetail.ContactTel as trasferGoods_ContactTel,trasferGoodsDetail.sellProxyFileID as trasferGoods_sellProxyFileID,trasferGoodsDetail.buyProxyFileID as trasferGoods_buyProxyFileID,delDistributionDetail.StartDate as distribution_StartDate,delDistributionDetail.EndDate as distribution_EndDate,delDistributionDetail.LogisticsLeafID as distribution_LogisticsLeafID,delDistributionDetail.LogiisticsName as distribution_LogiisticsName,delDistributionDetail.AddressDetail as distribution_AddressDetail,delDistributionDetail.ContactTel as distribution_ContactTel,delDistributionDetail.ContactName as distribution_ContactName,delDistributionDetail.ContactMobile as distribution_ContactMobile,delDistributionDetail.FreightFee as distribution_FreightFee,delDistributionDetail.SmallFee as distribution_SmallFee,delDistributionDetail.NextApplyID as distribution_NextApplyID,delDistributionDetail.Remark  as distribution_Remark FROM T_Delivery dl INNER JOIN T_Order od ON od.OrderId = dl.OrderID INNER JOIN T_Leads leads ON leads.ID = od.LeadsID LEFT JOIN C_Firm cfS  ON cfS.FirmID = od.SellFirmId LEFT JOIN C_Firm cfB ON cfB.FirmID = od.BuyFirmId LEFT JOIN VW_Crm_DeliveryPlace crmDl ON crmDl.ID = od.DeliveryPlaceId LEFT JOIN VW_Crm_City place ON place.ID = crmDl.CityID LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN VW_Crm_SourcePlace sourcePlace ON sourcePlace.ID = od.SourcePlaceID LEFT JOIN T_DeliveryDetail deliveryDetail ON deliveryDetail.DeliveryID = dl.DeliveryID and deliveryDetail.DISABLED = 0 LEFT JOIN T_TrasferGoodsDetail trasferGoodsDetail ON trasferGoodsDetail.DeliveryID = dl.DeliveryID and trasferGoodsDetail.DISABLED = 0 LEFT JOIN T_DelDistributionDetail delDistributionDetail ON delDistributionDetail.DeliveryID = dl.DeliveryID and trasferGoodsDetail.DISABLED = 0 LEFT JOIN (SELECT distinct log.DeliveryID,log.OpeContent,log.OpeDateTime FROM T_DeliveryOpeLog log where log.OpeContent like '%\u7269\u6D41\u90E8\u95E8\u5BA1\u6838\u901A\u8FC7\u4EA4\u6536\u7533\u8BF7%') deliveryOpeLog1 ON deliveryOpeLog1.DeliveryID = dl.DeliveryID LEFT JOIN (SELECT distinct log.DeliveryID,log.OpeContent,log.OpeDateTime FROM T_DeliveryOpeLog log where log.OpeContent like '%\u4F20\u4E0A\u5BB6\u59D4\u6258\u4E66%') deliveryOpeLog2 ON deliveryOpeLog2.DeliveryID = dl.DeliveryID LEFT JOIN (SELECT distinct log.DeliveryID,log.OpeContent,log.OpeDateTime FROM T_DeliveryOpeLog log where log.OpeContent like '%\u5DF2\u53D6\u5F97\u77F3\u5316\u8BA2\u5355\u53F7%') deliveryOpeLog3 ON deliveryOpeLog3.DeliveryID = dl.DeliveryID ) temp where 1=1
#\u4EA4\u6536\u914D\u9001#
DelDistributionDetail_001 = insert into(DeliveryID,DISABLED,LogisticsID,LogiisticsDetai,AddressID,AddressDetail,ContactTel,ContactName,Remark,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,dbo.base64_utf8encode(\u003f),\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
DelDistributionDetail_002 = insert into(AddPV,AddCT,Address,DISABLED,ContactName,ContactTelNo,CreateTime,UpdateTime)VALUES(\u003f,\u003f,\u003f,0,\u003f,dbo.base64_utf8encode(\u003f),getDate(),getDate())
#\u7279\u6b8a\u6d41\u7a0b\u8bb0\u5f55\u8868#
SpecialOprDAO_001 = insert into T_SpecialOpr (RelationID,RelationType,OprType,Amount,Comment,ApplicantName,ApplicantTime,Status)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
SpecialOprDAO_002 = select * from ( select ts.*,CASE when  ts.RelationType = 3 then ts.RelationID END as delievryId,       td.OrderID as orderID,       cf_sell.FirmID as sellFirmId,       cf_sell.FirmName as sellFirmName,       cf_buy.FirmID as buyFirmId,       cf_buy.FirmName as buyFirmName,(select count(1) from T_SpecialOprDetail specialOprDetail where specialOprDetail.SpecialOprID = ts.ID and specialOprDetail.Status= 2 ) as exeCount from T_SpecialOpr ts     LEFT JOIN T_Delivery td ON td.DeliveryID = ts.RelationID     LEFT JOIN T_Order tdr ON tdr.OrderId = td.OrderID      LEFT JOIN C_Firm cf_sell ON cf_sell.FirmID = tdr.SellFirmId     LEFT JOIN C_Firm cf_buy ON cf_buy.FirmID = tdr.BuyFirmId WHERE ts.RelationType = 3 UNION ALL select ts.*,CASE when  ts.RelationType = 2 then '' END as delievryId, tdr.OrderID as orderID,       cf_sell.FirmID as sellFirmId,       cf_sell.FirmName as sellFirmName,       cf_buy.FirmID as buyFirmId,       cf_buy.FirmName as buyFirmName,(select count(1) from T_SpecialOprDetail specialOprDetail where specialOprDetail.SpecialOprID = ts.ID and specialOprDetail.Status= 2 ) as exeCount from T_SpecialOpr ts     LEFT JOIN T_Order tdr ON tdr.OrderId = ts.RelationID      LEFT JOIN C_Firm cf_sell ON cf_sell.FirmID = tdr.SellFirmId      LEFT JOIN C_Firm cf_buy ON cf_buy.FirmID = tdr.BuyFirmId WHERE ts.RelationType = 2 ) temp where 1=1 
SpecialOprDAO_003 = update T_SpecialOpr SET Status = 2,OprName=\u003f,OprTime=\u003f 
SpecialOprDAO_004 = SELECT * FROM T_SpecialOpr where id =\u003f
SpecialOprDAO_005 = insert into T_SpecialOpr (RelationID,RelationType,OprType,Amount,Comment,ApplicantName,ApplicantTime,OprName,OprTime,Status)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
SpecialOprDAO_006 = insert into T_SpecialOprDetail (SpecialOprID,VoucherModelID,VoucherModelName,PayType,Amount,FirmID,Comment,Status,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
SpecialOprDAO_007 = select * from T_SpecialOprDetail where DISABLED = \u003f and SpecialOprID = \u003f
SpecialOprDAO_008 = UPDATE T_SpecialOprDetail SET REC_CREATEBY = \u003f,REC_MODIFYTIME = getdate(),Status = \u003f WHERE ID = \u003f
SpecialOprDAO_009 = UPDATE T_SpecialOprDetail SET REC_CREATEBY = \u003f,REC_MODIFYTIME = getdate(),DISABLED = \u003f WHERE ID = \u003f
SpecialOprDAO_010 = select * from T_SpecialOprDetail where DISABLED = \u003f and ID = \u003f
SpecialOprDAO_011 = select COUNT(1) from T_SpecialOprDetail where DISABLED = \u003f and SpecialOprID = \u003f and Status = \u003f
SpecialOprDAO_012 = update T_SpecialOpr set Status = \u003f,OprName = \u003f,OprTime = getDate() where ID = \u003f
EnquiryDAO_001 = SELECT * FROM ( SELECT e.EnquiryId AS enquiryId, e.EnquiryCode AS enquiry_serviceNm, l.LeadsCode AS leads_serviceNm, e.PushStatus AS pushStatus, e.LeadsID AS leadsID, e.Price AS price, e.Quantity AS quantity, e.TraderId AS traderId, t.TraderName, e.FirmId AS firmId, f.FirmName AS FirmName, e.EnquiryStatus AS enquiryStatus, e.REC_CREATEBY AS recCreateby, e.REC_CREATETIME AS recCreatetime, e.REC_MODIFYBY AS recModifyby, e.REC_MODIFYTIME AS recModifytime, e.DISABLED AS disabled, e.UserCode AS userCode, u.UserName AS userName, isnull(e.Remarks, '') AS remarks, e.FeeAlgr AS feeAlgr, e.FeeRate AS feeRate, e.DepositAlgr AS depositAlgr, e.DepositRate AS depositRate, e.CreditFee AS creditFee, e.CreditDeposit AS creditDeposit, e.TradeFee AS tradeFee, e.TakenTradeFee AS takenTradeFee, e.TradeDeposit AS tradeDeposit, e.TakenTradeDeposit AS takenTradeDeposit, e.TradeUnitNumber AS tradeUnitNumber, l.UserCode AS userCodeL, ul.UserName AS userNameL, l.TraderId AS traderIdL, tl.TraderName AS traderNameL, l.FirmId AS firmIdL, fl.FirmName AS firmNameL, l.TradeTmptId AS tradeTmptId, tt.TradeTmptName AS tradeTmptName, l.CategoryLeafID AS categoryLeafID, CAST (cs.CategoryName AS VARCHAR) + '-' + CAST (cb.BrandName AS VARCHAR) AS goodName, cs.CategoryName AS categoryName, l.BrandID AS brandID, cb.BrandName AS brandName, l.SourcePlaceID AS sourcePlaceID, sp.Name AS sourcePlaceName, l.Quantity AS quantityL, l.MinQuantity AS minQuantity, l.Price AS priceL, l.LeadsStatus AS leadsStatus, l.DealtQuantity AS dealtQuantity, l.CreditFee AS creditFeeL, l.CreditDeposit AS creditDepositL, l.TradeFee AS tradeFeeL, l.TakenTradeFee AS takenTradeFeeL, l.TradeDeposit AS tradeDepositL, l.TakenTradeDeposit AS takenTradeDepositL, l.REC_CREATEBY AS recCreatebyL, l.REC_CREATETIME AS recCreatetimeL, l.REC_MODIFYBY AS recModifybyL, l.REC_MODIFYTIME AS recModifytimeL, l.SettlementMethod AS settlementMethod,e.NeedInsurance AS needInsurance FROM T_Enquiry e LEFT JOIN T_Leads l ON l.ID = e.LeadsID LEFT JOIN C_Trader t ON t.TraderID = e.TraderId LEFT JOIN C_Firm f ON f.FirmID = e.FirmId LEFT JOIN C_User u ON u.UserCode = e.UserCode LEFT JOIN C_User ul ON ul.UserCode = l.UserCode LEFT JOIN C_Trader tl ON tl.TraderID = l.TraderId LEFT JOIN C_Firm fl ON fl.FirmID = l.FirmId LEFT JOIN T_TradeTemplate tt ON tt.TradeTmptId = l.TradeTmptId LEFT JOIN VW_Crm_CategorySpecial cs ON cs.ID = l.CategoryLeafID LEFT JOIN VW_Crm_Brand cb ON cb.ID = l.BrandID LEFT JOIN VW_Crm_SourcePlace sp ON sp.ID = l.SourcePlaceID WHERE 1 = 1 AND e.EnquiryStatus != - 1 ) TEMP WHERE 1 = 1
EnquiryDAO_002 = SELECT ts.EnquiryId AS enquiryId, isnull(le.FutureContractCode, '--') AS futureContractCode, t1.Name AS sourcePlaceName, t2.BrandName AS brandName, ts.Quantity * ts.TradeUnitNumber AS quantity, ts.Price AS price, t3.ValueName AS deliveryDate, CASE WHEN isnull(l.WHGruopID, 0) = 0 THEN t6.WHAddressSimpleName ELSE l.WHGruopName END WHName FROM HJOnline.dbo.T_Enquiry ts INNER JOIN HJOnline.dbo.T_Leads l ON ts.LeadsID = l.ID INNER JOIN HJOnline.dbo.T_LeadsExpand_Liner le ON l.ID = le.LeadsID INNER JOIN HJOnline.dbo.VW_Crm_SourcePlace t1 ON ts.SourcePlaceID = t1.ID INNER JOIN HJOnline.dbo.VW_Crm_Brand t2 ON ts.BrandID = t2.ID INNER JOIN HJOnline.dbo.C_Dictionary t3 ON le.DeliveryDateEnum = t3.DictID LEFT JOIN HJOnline.dbo.T_WareHouseAddress t6 ON l.DeliveryPlaceId = t6.ID WHERE ts.[DISABLED] = 0 AND l.[DISABLED] = 0 AND le.[DISABLED] = 0
EnquiryCounterDAO_001 = SELECT counterId, goodName, leadsId, sourcePlaceName, price, firmName, traderName, recModifytime, enquiryId, priceQ, quantity, tradeUnitNumber, firmNameQ, enquiryStatus, traderId, firmIdQ, firmId, tradeTmptId, tradeTmptName, userName, enquiry_serviceNm FROM ( SELECT counter.id AS counterId, counter.LeadsID AS leadsId, CAST (cs.CategoryName AS VARCHAR) + '-' + CAST (cb.BrandName AS VARCHAR) AS goodName, sp.Name AS sourcePlaceName, counter.Price AS price, firm.FirmName AS firmName, firm.FirmID AS firmId, trader.TraderName AS traderName, trader.TraderID AS traderId, counter.REC_MODIFYTIME AS recModifytime, counter.EnquiryId AS enquiryId, e.Price AS priceQ, e.Quantity AS quantity, e.tradeUnitNumber AS tradeUnitNumber, firm1.FirmName AS firmNameQ, firm.FirmID AS firmIdQ, e.EnquiryStatus AS enquiryStatus, l.TradeTmptId AS tradeTmptId, tp.TradeTmptName AS tradeTmptName, u.userName AS userName, e.EnquiryCode AS enquiry_serviceNm FROM T_EnquiryCounterOffer counter LEFT JOIN T_Enquiry AS e ON e.EnquiryId = counter.EnquiryId LEFT JOIN T_Leads AS l ON l.ID = e.LeadsID LEFT JOIN T_TradeTemplate AS tp ON l.TradeTmptId = tp.TradeTmptId LEFT JOIN C_User AS u ON u.UserCode = l.UserCode LEFT JOIN C_Trader AS trader ON trader.TraderID = l.TraderId LEFT JOIN VW_Crm_CategorySpecial AS cs ON cs.ID = l.CategoryLeafID LEFT JOIN VW_Crm_Brand AS cb ON cb.ID = l.BrandID LEFT JOIN VW_Crm_SourcePlace AS sp ON sp.ID = l.SourcePlaceID LEFT JOIN C_Firm AS firm ON l.FirmId = firm.FirmID LEFT JOIN C_Firm AS firm1 ON e.FirmId = firm1.FirmID ) AS TEMP WHERE 1 = 1
#\u6D88\u606F\u670D\u52A1#
MessageDao_001 = SELECT t1.*,t2.UserId as userID,t3.Name as userName FROM T_Notification t1 LEFT JOIN T_NotificationRel t2 ON t2.MessageId = t1.Id LEFT JOIN M_User  t3 ON t3.id = t2.UserId where 1=1
MessageDao_002 = update T_Notification SET MsgStatus = 1,ReadTime=\u003f ,REC_MODIFYTIME=\u003f ,REC_MODIFYBY=\u003f  WHERE Id =\u003f
#app\u6D88\u606F\u6A21\u5757
CMessageDAO_001 = select MessageID, MsgCode, ReceiveNumber, MessageContent from C_MessageHistory 
CMessageDAO_002 = insert into C_MessageSendRelation(MessageID, MsgSendType, ReceiveNumber, MsgStatus, ResultStatus, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f, getDate(), \u003f, getDate())
CMessageDAO_003 = insert into C_MessageSendRelation(MessageID, MsgSendType, ReceiveNumber, MsgStatus, ResultStatus, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME) values 
CMessageDAO_004 = select mh.MessageID, mh.MsgCode, mh.MessageContent, mh.ReceiveNumber, mh.MsgStatus,  mh.ResultMsg, Convert(varchar(19),mh.REC_MODIFYTIME,120) as RecModifytime, msr.ResultStatus from C_MessageHistory mh inner join C_MessageSendRelation msr on mh.MessageID = msr.MessageID where 1=1
CMessageDAO_005 = where MsgCode in ('S0007', 'S0008' ,'S0009') and Convert(varchar(10),REC_CREATETIME,120) = Convert(varchar(10),getDate(),120) and IsSend is null and ReceiveNumber in (SELECT [dbo].base64_utf8decode(u.Mobile) ReceiveNumber FROM C_User u inner JOIN C_UserHistory uh on u.UserCode = uh.UserID where uh.LoginFrom = 0 group by u.Mobile)
CMessageDAO_006 = update C_MessageHistory set IsSend = 1, REC_MODIFYTIME = getDate() 
CMessageDAO_007 = update C_MessageSendRelation set ResultStatus = 1, REC_MODIFYTIME = getDate()  where MessageID = \u003f and ResultStatus = 0
CMessageDAO_008 = select count(1) from C_MessageSendRelation where ReceiveNumber = \u003f and ResultStatus = 0
CMessageDAO_009 = update C_MessageSendRelation set ResultStatus = 1, REC_MODIFYTIME = getDate()  where ReceiveNumber = \u003f and ResultStatus = 0
CMessageDAO_010 = update C_MessageHistory set IsSend = 1, REC_MODIFYTIME = getDate() where messageID = \u003f
#\u7528\u6237\u5FAE\u4FE1\u7ED1\u5B9A\u5173\u7CFB\u8868
UserWeiXinDAO_001 = select * from C_User_WeiXin where OpenID = \u003f and Status = \u003f
UserWeiXinDAO_002 = select * from C_User_WeiXin where UserCode = \u003f and Status = \u003f
#UserWeiXinDAO_003 = insert into C_User_WeiXin(UserCode, OpenID, BindingTime, LastLoginTime) values (\u003f, \u003f, getDate(), getDate())
UserWeiXinDAO_003 = insert into C_User_WeiXin(OpenID, appType, nickName, gender, province, city, country, headimgurl, privilege, isSubscribe, subscribeTime, language, unionId, remark, groupId, tagIds, createTime) values (\u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, getDate())
UserWeiXinDAO_004 = select uw.OpenID,uw.gender from C_User_WeiXin uw INNER JOIN C_User u on uw.UserCode = u.UserCode where [dbo].base64_utf8decode(u.Mobile) = \u003f and u.disabled = 0
UserWeiXinDAO_005 = update C_User_WeiXin set UserCode = \u003f, BindingTime = getDate(), LastLoginTime  = getDate()  where OpenID = \u003f and Status = \u003f
UaacUserDAO_001=select LoginName as loginName,Email as email from vw_UaacUser;
#\u4F18\u60E0\u5238
CouponDao_001 = insert into F_CouponApply (ID,ApplyType,Status,FirmID,Amount,Applyer,ApplyTime,Note) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f)
CouponDao_002 = update F_CouponApply set Status = \u003f,Approver = \u003f,ApproveTime = getDate(),RefuseReason = \u003f where ID = \u003f
CouponDao_003 = select firm.FirmName as firmName,coupon.Balance as firmAmount,ca.* from F_CouponApply  ca left join C_Firm firm on firm.FirmID = ca.FirmID left join F_Coupon coupon on coupon.FirmID = ca.FirmID where 1=1
CouponDao_004 = insert into F_Coupon (FirmID,Balance,Frozenfunds,LastBalance,CreditDate) VALUES (\u003f,\u003f,\u003f,\u003f,getDate())
CouponDao_005 = select firm.FirmName as firmName,ca.* from F_Coupon  ca left join C_Firm firm on firm.FirmID = ca.FirmID where 1=1
CouponDao_006 = update F_Coupon set Balance = \u003f,LastBalance = \u003f,CreditDate = getDate() where ID = \u003f
CouponDao_007 = insert into F_CouponFlow (FundFlowID,FirmID,OperCode,Amount,Balance,Createtime,ObjectID,ObjectType,FlowType,Operator) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,\u003f,\u003f,\u003f)
CouponDao_008 = select firm.FirmName as firmName,ca.* from F_CouponFlow  ca left join C_Firm firm on firm.FirmID = ca.FirmID where 1=1
CouponDao_009 = select * from F_Coupon where FirmID = \u003f
CouponDao_010=update F_Coupon set Balance \= Balance + ?, Frozenfunds\= Frozenfunds - ? where FirmID \= ?
#\u7CBE\u5F69\u6D3B\u52A8#
QuizDao_001 = INSERT INTO F_QuizActivity (Category, ContractName, ContractPrice, QuizDate, DISABLED, REC_CREATETIME, REC_CREATEBY, REC_MODIFYTIME, REC_MODIFYBY, status,SettlementPrice,Answer)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f,\u003f,\u003f,\u003f) 
QuizDao_002 = insert into F_QuizMoney(MoneyTerm,Money,QuizDate,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
QuizDao_003 = SELECT ISNULL(SUM(PoolMoney), 0.00) as PoolMoney FROM F_QuizMoneyPool
QuizDao_004 = SELECT * FROM(SELECT qh.*,cu.UserName,qwr.MoneyTerm,qwr.Bonus,qwr.QuizDate,cfi.FirmName,qa.ContractName,qa.ContractPrice,qa.Status as activityStatus FROM F_QuizHistory qh LEFT JOIN F_QuizWinningResult qwr ON qh.ID=QuizHistoryID AND qwr.DISABLED=0 LEFT JOIN C_User cu on qh.REC_CREATEBY=cu.UserCode  LEFT JOIN F_QuizActivity qa ON qh.QuizActivity_ID=qa.ID and qa.DISABLED=0 LEFT JOIN C_Trader cta ON qh.TraderID=cta.TraderID and cta.DISABLED=0 LEFT JOIN C_Firm cfi ON cta.FirmID = cfi.FirmID and cfi.DISABLED=0 WHERE qh.DISABLED=0 ) temp where 1=1
QuizDao_005 = SELECT * FROM F_QuizActivity WHERE DISABLED = 0 and convert(varchar(10),QuizDate,120) = \u003f
QuizDao_006 = SELECT * FROM ( SELECT DISTINCT QuizDate, REC_MODIFYBY, CONVERT (VARCHAR(10), REC_MODIFYTIME, 120) AS REC_MODIFYTIME, status, STUFF((SELECT ',' + ContractName FROM F_QuizActivity A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.QuizDate, 120) = CONVERT(VARCHAR(10), B.QuizDate, 120) FOR XML PATH('')), 1, 1, '') AS ContractName, STUFF((SELECT ',' + CONVERT(nvarchar(100), CAST(ContractPrice AS DECIMAL(18, 2))) FROM F_QuizActivity A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.QuizDate, 120) = CONVERT(VARCHAR(10), B.QuizDate, 120) FOR XML PATH('')), 1, 1, '') AS pp_pe_contractPrice, STUFF((SELECT ',' + CONVERT(nvarchar(100), CAST(SettlementPrice AS DECIMAL(18, 2))) FROM F_QuizActivity A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.QuizDate, 120) = CONVERT(VARCHAR(10), B.QuizDate, 120) FOR XML PATH('')), 1, 1, '') AS pp_pe_settlementPrice FROM F_QuizActivity B WHERE B.DISABLED = 0 GROUP BY QuizDate, ContractPrice, REC_MODIFYBY, CONVERT (VARCHAR(10), REC_MODIFYTIME, 120), status ) temp WHERE 1 = 1
QuizDao_007 = update F_QuizMoneyPool set PoolMoney = 0.00 
QuizDao_008 = update F_QuizActivity set ContractName=\u003f,status=5,ContractPrice =\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=getDate(),SettlementPrice = \u003f where DISABLED = 0 and Category =\u003f and convert(varchar(10),QuizDate,120) = \u003f
QuizDao_009 = DELETE FROM F_QuizActivity where convert(varchar(10),QuizDate,120) 
QuizDao_010 = DELETE FROM F_QuizMoney where convert(varchar(10),QuizDate,120) 
QuizDao_011 = SELECT * FROM F_QuizActivity WHERE DISABLED = 0 and convert(varchar(10),QuizDate,120) IN (\u003f)
QuizDao_012 = update F_QuizMoney set Money = Money+\u003f ,REC_MODIFYBY = \u003f,REC_MODIFYTIME=getDate() where MoneyTerm =\u003f and convert(varchar(10),QuizDate,120) IN (\u003f)
QuizDao_013 = select ISNULL(count(*), 0) from F_QuizMoney where MoneyTerm =\u003f and convert(varchar(10),QuizDate,120) IN (\u003f)
#\u5173\u6CE8\u7BA1\u7406
Attention_001=SELECT * FROM (SELECT attention.*, trader.TraderName AS traderName, firm.FirmName AS firmName FROM C_Attention attention LEFT JOIN C_Trader trader ON trader.TraderID = attention.TraderID LEFT JOIN C_Firm firm ON firm.FirmID = attention.FirmID) attention WHERE 1=1 AND attention.DISABLED=0
Attention_002=SELECT DISTINCT attention.AttentionType AS attentionType FROM C_Attention attention ORDER BY AttentionType ASC
Attention_003=SELECT * FROM(SELECT AttentionType,SearchKeys,sum(1) as followCount,ROW_NUMBER() OVER(partition by AttentionType order BY sum(1) DESC) as ranking FROM C_Attention GROUP By SearchKeys,AttentionType ) as t where t.ranking<=?
QuizDao_014 = select * from F_QuizActivity WHERE convert(varchar(10),QuizDate,120) > \u003f ORDER BY QuizDate ASC
QuizDao_015 = select Money from F_QuizMoney where MoneyTerm =\u003f and convert(varchar(10),QuizDate,120) IN (\u003f)
QuizDao_016 = update F_QuizMoney set Money = \u003f ,REC_MODIFYBY = \u003f,REC_MODIFYTIME=getDate() where MoneyTerm =\u003f and convert(varchar(10),QuizDate,120) IN (\u003f)
QuizDao_017=SELECT * FROM F_QuizActivity WHERE DISABLED \= 0 and convert(varchar(10),QuizDate,120) \= ? and Status \= 5
QuizDao_018=SELECT t11.*, fq.Category\n  FROM F_QuizHistory t11,\n       C_Trader ct,\n       (select t.ContractPrice, t.ID\n          from F_QuizActivity t\n         where t.DISABLED \= 0\n           and t.Status \= 5\n           and t.Category \= 1\n           and CONVERT(CHAR(10), t.QuizDate, 120) \= ?) pp,\n       (select t.ContractPrice, t.ID\n          from F_QuizActivity t\n         where t.DISABLED \= 0\n           and t.Status \= 5\n           and t.Category \= 2\n           and CONVERT(CHAR(10), t.QuizDate, 120) \= ?) pe,\n       F_QuizActivity fq\n where t11.TraderID in\n       (SELECT gh.TraderID\n          FROM F_QuizHistory gh,\n               (select t.ContractPrice, t.ID\n                  from F_QuizActivity t\n                 where t.DISABLED \= 0\n                   and t.Status \= 5\n                   and t.Category \= 1\n                   and CONVERT(CHAR(10), t.QuizDate, 120) \= ?) pp\n         where pp.ID \= gh.QuizActivity_ID\n           and pp.ContractPrice \= gh.QuizPrice\n           and gh.SourceFrom \= 1\n           AND gh.DISABLED \= 0\n           and gh.Status \= 0)\n   and t11.TraderID in\n       (SELECT gh.TraderID\n          FROM F_QuizHistory gh,\n               (select t.ContractPrice, t.ID\n                  from F_QuizActivity t\n                 where t.DISABLED \= 0\n                   and t.Status \= 5\n                   and t.Category \= 2\n                   and CONVERT(CHAR(10), t.QuizDate, 120) \= ?) pe\n         where pe.ID \= gh.QuizActivity_ID\n           and pe.ContractPrice \= gh.QuizPrice\n           and gh.SourceFrom \= 1\n           AND gh.DISABLED \= 0\n           and gh.Status \= 0)\n   and t11.SourceFrom \= 1\n   AND t11.DISABLED \= 0\n   and t11.Status \= 0\n   and ct.DISABLED \= 0\n   and ct.TraderID \= t11.TraderID\n   and ct.FirmID not in\n       (select DISTINCT t3.FirmID\n          from F_QuizWinningResult t1, F_QuizHistory t2, C_Trader t3\n         where (t1.MoneyTerm \= 10 or t1.MoneyTerm \= 20)\n           and t1.QuizHistoryID \= t2.ID\n           and t2.TraderID \= t3.TraderID\n           and t1.DISABLED \= 0\n           and t2.DISABLED \= 0\n           and t3.DISABLED \= 0)      \n   and ((t11.QuizActivity_ID \= pp.ID and t11.QuizPrice \= pp.ContractPrice) or\n       (t11.QuizActivity_ID \= pe.ID and t11.QuizPrice \= pe.ContractPrice))\n   and fq.ID \= t11.QuizActivity_ID\n   and fq.DISABLED \= 0\n ORDER BY t11.REC_CREATETIME, t11.TraderID\n
QuizDao_019=SELECT t11.*, fq.Category\n  FROM F_QuizHistory t11,\n       C_Trader ct,\n       (select t.ContractPrice, t.ID\n          from F_QuizActivity t\n         where t.DISABLED \= 0\n           and t.Status \= 5\n           and t.Category \= 1\n           and CONVERT(CHAR(10), t.QuizDate, 120) \= ?) pp,\n       (select t.ContractPrice, t.ID\n          from F_QuizActivity t\n         where t.DISABLED \= 0\n           and t.Status \= 5\n           and t.Category \= 2\n           and CONVERT(CHAR(10), t.QuizDate, 120) \= ?) pe,\n       F_QuizActivity fq\n where t11.SourceFrom \= 1\n   AND t11.DISABLED \= 0\n   and t11.Status \= 0\n   and ct.DISABLED \= 0\n   and ct.TraderID \= t11.TraderID\n   and ct.FirmID not in\n       (select DISTINCT t3.FirmID\n          from F_QuizWinningResult t1, F_QuizHistory t2, C_Trader t3\n         where (t1.MoneyTerm \= 10 or t1.MoneyTerm \= 20)\n           and t1.QuizHistoryID \= t2.ID\n           and t2.TraderID \= t3.TraderID\n           and t1.DISABLED \= 0\n           and t2.DISABLED \= 0\n           and t3.DISABLED \= 0)\n      \n   and ((t11.QuizActivity_ID \= pp.ID and t11.QuizPrice \= pp.ContractPrice) or\n       (t11.QuizActivity_ID \= pe.ID and t11.QuizPrice \= pe.ContractPrice))\n   and fq.ID \= t11.QuizActivity_ID\n   and fq.DISABLED \= 0\n ORDER BY t11.REC_CREATETIME, t11.TraderID\n
QuizDao_020=SELECT gh.*,qa.Category,\n       CASE\n         WHEN (gh.QuizPrice - qa.ContractPrice) < 0 THEN\n          - (gh.QuizPrice - qa.ContractPrice)\n         ELSE\n          (gh.QuizPrice - qa.ContractPrice)\n       END AS floatValueTemp\n  FROM F_QuizHistory gh, F_QuizActivity qa\n WHERE gh.SourceFrom \= 1\n   AND gh.DISABLED \= 0\n   and gh.Status \= 0\n   and gh.QuizActivity_ID \= qa.ID\n   AND CONVERT(CHAR(10), qa.QuizDate, 120) \= ?\n   and qa.DISABLED \= 0\n   and qa.Status \= 5\n   AND (gh.QuizPrice <\= qa.ContractPrice + 25 AND\n       gh.QuizPrice >\= qa.ContractPrice - 25)\n ORDER BY floatValueTemp ASC, REC_CREATETIME ASC\n
QuizDao_021=SELECT\t* FROM\tF_QuizWinningResult t1 WHERE\tt1.DISABLED \= 0
QuizDao_022=SELECT qh.*\n  FROM F_QuizHistory qh, F_QuizActivity qa\n WHERE qh.DISABLED \= 0\n   and qh.Status \!\= 0\n   and qh.SourceFrom \= 1\n   and qh.QuizActivity_ID \= qa.ID\n   and CONVERT(VARCHAR(10), qa.QuizDate, 120) \= ?\n   AND qa.Status \= 5\n   and qa.DISABLED \= 0\n
#\u62B5\u6263\u4F18\u60E0\u5238
CouponActivityDao_001=select nc.* from F_NewCoupon nc where 1=1 and nc.DISABLED=0
CouponActivityDao_002=INSERT INTO F_NewCoupon (CouponName, CouponType, RechargeAmount, DeductionAmount, Amount, Status, Remark, DISABLED, REC_CREATETIME, REC_CREATEBY, REC_MODIFYTIME, REC_MODIFYBY, MinAmount, MinWeight) VALUES (\u003f ,\u003f ,\u003f ,\u003f ,\u003f ,\u003f ,\u003f ,\u003f, getDate() ,\u003f, getDate() ,\u003f ,\u003f ,\u003f)
CouponActivityDao_003=update F_NewCoupon set CouponType = \u003f,RechargeAmount = \u003f,DeductionAmount = \u003f,Amount = \u003f,Status = \u003f,Remark = \u003f,REC_MODIFYTIME = getDate(),REC_MODIFYBY = \u003f,MinAmount = \u003f,MinWeight = \u003f where ID = \u003f
CouponActivityDao_004=update F_NewCoupon set DISABLED =  \u003f where ID =  \u003f
CouponActivityDao_005=SELECT * FROM (SELECT newCouponTrans.*, newCouponActivity.ActivityName AS activityName, newCoupon.CouponName AS couponName, newCoupon.Amount AS amount, newCoupon.CouponType AS couponType, firm.FirmName AS firmName, trader.TraderName AS traderName,cuser.UserName AS userName, dbo.base64_utf8decode(cuser.Mobile) AS userMobile,orders.BuyCouponTradeFee AS buyCouponTradeFee FROM F_NewCouponTrans newCouponTrans LEFT JOIN F_NewCouponActivity newCouponActivity ON newCouponActivity.ID = newCouponTrans.ActivityID LEFT JOIN F_NewCoupon newCoupon ON newCoupon.ID = newCouponTrans.CouponID LEFT JOIN C_Trader trader ON trader.TraderID = newCouponTrans.TraderID LEFT JOIN C_Firm firm ON firm.FirmID = newCouponTrans.FirmID LEFT JOIN C_User cuser ON cuser.UserCode = newCouponTrans.UserCode LEFT JOIN T_Order orders ON orders.OrderId = newCouponTrans.OrderId) ncTrans WHERE 1=1
CouponActivityDao_026=SELECT * FROM (SELECT newCouponTrans.*, newCouponActivity.ActivityName AS activityName, newCoupon.CouponName AS couponName, newCoupon.Amount AS amount, newCoupon.CouponType AS couponType, firm.FirmName AS firmName, trader.TraderName AS traderName,cuser.UserName AS userName, dbo.base64_utf8decode(cuser.Mobile) AS userMobile FROM F_NewCouponTrans newCouponTrans LEFT JOIN F_NewCouponActivity newCouponActivity ON newCouponActivity.ID = newCouponTrans.ActivityID LEFT JOIN F_NewCoupon newCoupon ON newCoupon.ID = newCouponTrans.CouponID LEFT JOIN C_Trader trader ON trader.TraderID = newCouponTrans.TraderID LEFT JOIN C_Firm firm ON firm.FirmID = newCouponTrans.FirmID LEFT JOIN C_User cuser ON cuser.UserCode = newCouponTrans.UserCode WHERE DATEDIFF(DAY, GETDATE(), newCouponTrans.CouponValidEndDate)>=0 ) ncTrans WHERE 1=1
CouponActivityDao_027 = SELECT ISNULL(COUNT(*), 0) FROM F_NewCouponTrans
CouponActivityDao_007=select nca.* from F_NewCouponActivity nca where 1=1 and nca.DISABLED=0
CouponActivityDao_008=insert into F_NewCouponActivity(ActivityName,Remark,AuditStates,ActivityStartDate,ActivityEndDate,States,DISABLED,REC_CREATETIME,REC_CREATEBY,REC_MODIFYTIME,REC_MODIFYBY) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f)
CouponActivityDao_009=insert into F_NewCouponActTemplateRel(ActivityID,TemplateID) VALUES(\u003f,\u003f)
CouponActivityDao_010=insert into F_NewCouponActivityRel(CouponID,ActivityID,MaxQuantity,CouponValidStartDate,CouponValidEndDate,DISABLED,REC_CREATETIME,REC_CREATEBY,REC_MODIFYTIME,REC_MODIFYBY,AuditStates) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f,\u003f)
CouponActivityDao_011=delete from F_NewCouponActTemplateRel where ActivityID = \u003f
CouponActivityDao_012=update F_NewCouponActivity set Remark = \u003f,ActivityStartDate = \u003f,ActivityEndDate = \u003f,States = \u003f,REC_MODIFYTIME = getDate(),REC_MODIFYBY = \u003f, AuditStates = \u003f where ID = \u003f
CouponActivityDao_013=insert into F_NewCouponTrans(ActivityID,CouponID,CouponNumber,CouponValidStartDate,CouponValidEndDate,ExchangeCode,Status,DISABLED,DeductibleAmount,REC_CREATETIME,REC_CREATEBY,REC_MODIFYTIME,REC_MODIFYBY) values(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f)
CouponActivityDao_014=update F_NewCouponActivity set AuditStates = \u003f,AuditTime = getDate(), AuditBy = \u003f where ID = \u003f
CouponActivityDao_015=SELECT ID ,CouponName ,CouponType ,RechargeAmount ,DeductionAmount ,Amount FROM F_NewCoupon where DISABLED = 0 and Status = 1 and ID not in(select DISTINCT CouponID from F_NewCouPonTrans where DISABLED = 0)
CouponActivityDao_006=SELECT DISTINCT coupon.ID ,coupon.CouponName ,coupon.CouponType ,coupon.RechargeAmount ,coupon.DeductionAmount ,coupon.Amount FROM F_NewCoupon coupon LEFT JOIN  F_NewCouponTemplateRel rel on  coupon.ID = rel.NewCouponID where coupon.DISABLED = 0 and coupon.Status = 1
CouponActivityDao_016=select nc.CouponName,nc.CouponType,nc.RechargeAmount,nc.DeductionAmount,nc.Amount,ncar.CouponID,ncar.MaxQuantity,ncar.CouponValidStartDate,ncar.CouponValidEndDate from F_NewCouponActivityRel ncar left join F_NewCoupon nc on nc.ID = ncar.CouponID left join F_NewCouponActivity nca on nca.ID = ncar.ActivityID where ncar.ActivityID = \u003f and nc.DISABLED = \u003f 
CouponActivityDao_017=select distinct nc.CouponName,nc.couponType,nc.RechargeAmount,nc.DeductionAmount,nc.Amount,nc.ID,ncar.CouponID,ncar.MaxQuantity,ncar.CouponValidStartDate,ncar.CouponValidEndDate from F_NewCouponActivityRel ncar left join F_NewCoupon nc on nc.ID = ncar.CouponID left join F_NewCouponActivity nca on nca.ID = ncar.ActivityID where ncar.ActivityID = \u003f and nc.DISABLED = \u003f and nca.AuditStates in(1,10)
CouponActivityDao_018=select * from F_NewCouponActivity where ID = \u003f
CouponActivityDao_019=update F_NewCouponTrans set UserCode = \u003f,Status = \u003f,ReceiveDate = GETDATE(),REC_MODIFYTIME = GETDATE(),REC_MODIFYBY = \u003f,TraderID = \u003f,FirmID = \u003f where ID = \u003f
CouponActivityDao_020=SELECT * FROM F_NewCouponTrans where ID =  \u003f
CouponActivityDao_021=update F_NewCouponTrans set Status = \u003f,ReceiveDate = GETDATE(),REC_MODIFYTIME = GETDATE(),REC_MODIFYBY = \u003f where ID = \u003f
CouponActivityDao_022 =select nc.CouponType,nca.CouponID ,nca.ActivityID,nca.MaxQuantity,nca.CouponValidStartDate,nca.CouponValidEndDate from F_NewCouponActivityRel nca INNER JOIN F_NewCoupon  nc ON nc.ID = nca.CouponID where nca.ActivityID =\u003f
CouponActivityDao_023 = update F_NewCouponActivity set States =  \u003f where ID =  \u003f
CouponActivityDao_024=select distinct nc.CouponName,nc.couponType,nc.RechargeAmount,nc.DeductionAmount,nc.Amount,nc.ID,ncar.ID as relID,ncar.AuditStates,ncar.CouponID,ncar.MaxQuantity,ncar.CouponValidStartDate,ncar.CouponValidEndDate from F_NewCouponActivityRel ncar left join F_NewCoupon nc on nc.ID = ncar.CouponID left join F_NewCouponActivity nca on nca.ID = ncar.ActivityID where ncar.ActivityID = \u003f and nc.DISABLED = \u003f order by ncar.ID desc 
CouponActivityDao_025=update F_NewCouponTrans set Status = \u003f,ReceiveDate = GETDATE(),REC_MODIFYTIME = GETDATE(),REC_MODIFYBY = \u003f where ID = \u003f
CouponActivityDao_030 = delete from F_NewCouponActivityRel where ActivityID= \u003f
CouponActivityDao_031=update F_NewCouponActivity set AuditStates = \u003f,AuditTime = getDate(), AuditBy = \u003f where ID = \u003f and AuditStates = \u003f
CouponActivityDao_032 = delete from F_NewCouponActivityRel where ActivityID= \u003f and AuditStates = \u003f
CouponActivityDao_033 = update F_NewCouponActivityRel set AuditStates = \u003f,REC_MODIFYTIME = getDate(),REC_MODIFYBY = \u003f where ActivityID= \u003f and  AuditStates = \u003f
CouponActivityDao_034=select distinct nc.CouponName,nc.couponType,nc.RechargeAmount,nc.DeductionAmount,nc.Amount,nc.ID,ncar.CouponID,ncar.MaxQuantity,ncar.CouponValidStartDate,ncar.CouponValidEndDate from F_NewCouponActivityRel ncar left join F_NewCoupon nc on nc.ID = ncar.CouponID left join F_NewCouponActivity nca on nca.ID = ncar.ActivityID where nc.DISABLED = 0 and ncar.ActivityID = \u003f and ncar.AuditStates in (3,15)  
CouponActivityDao_035=select nc.CouponType,nca.CouponID ,nca.ActivityID,nca.MaxQuantity,nca.CouponValidStartDate,nca.CouponValidEndDate from F_NewCouponActivityRel nca INNER JOIN F_NewCoupon  nc ON nc.ID = nca.CouponID where nca.DISABLED = 0 and nc.DISABLED = 0  and nca.ActivityID =\u003f and nca.AuditStates IN (3)
CouponActivityDao_036=delete from F_NewCouponTemplateRel where NewCouponID = \u003f
CouponActivityDao_037=select * from F_NewCouponTemplateRel where NewCouponID = \u003f
CouponActivityDao_038=select * from F_NewCoupon where ID = \u003f
CouponActivityDao_039=update F_NewCouponActivity set ActivityStartDate = \u003f,ActivityEndDate = \u003f, REC_MODIFYTIME = getDate(),REC_MODIFYBY = \u003f where ID = \u003f
#\u53D1\u7968\u76F8\u5173
InvoiceDao_001 = INSERT INTO T_InvoiceCollectDetail (InvoiceType,InvoiceNo,InvoiceDate,InvoiceTitle,TaxNo,BankName,BankAccount,InvoiceAddress,InvoiceTel,InvoiceContent,InvoiceQuantity,InvoicePrice,TaxRate,InvoiceMoney,InvoiceTax,InvoiceTotalMoney,CollectDate,Remark,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
InvoiceDao_002 = UPDATE T_InvoiceCollectDetail SET  InvoiceType = \u003f,InvoiceNo = \u003f,InvoiceDate = \u003f,InvoiceTitle = \u003f,TaxNo = \u003f,BankName = \u003f,BankAccount = \u003f,InvoiceAddress = \u003f,InvoiceTel = \u003f,InvoiceContent = \u003f,InvoiceQuantity = \u003f,InvoicePrice = \u003f,TaxRate = \u003f,InvoiceMoney = \u003f,InvoiceTax = \u003f,InvoiceTotalMoney = \u003f,CollectDate = \u003f,Remark = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() WHERE ID = \u003f
InvoiceDao_003 = UPDATE T_InvoiceCollectDetail SET  DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() WHERE ID = \u003f
InvoiceDao_004 = SELECT frim.FirmID,frim.FirmName,invoiceCollectDetailRel.ID as invoiceCollectDetailRelID,invoiceCollectDetailRel.RelationID,invoiceCollectDetailRel.Status,invoiceCollectDetail.* FROM T_InvoiceCollectDetailRel invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail ON invoiceCollectDetail.ID = invoiceCollectDetailRel.DetailID LEFT JOIN T_Order orders ON orders.OrderId = invoiceCollectDetailRel.RelationID LEFT JOIN C_Firm frim ON frim.FirmID = orders.SellFirmId where invoiceCollectDetailRel.DetailID =  \u003f
InvoiceDao_005 = INSERT INTO T_InvoiceCollectDetailRel (DetailID,RelationID,Status,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
InvoiceDao_006 = UPDATE T_InvoiceCollectDetailRel SET DetailID = \u003f,RelationID = \u003f,Status = \u003f,DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() WHERE ID = \u003f
InvoiceDao_007 = UPDATE T_Order SET InvoiceCollectStatus = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() WHERE OrderId = \u003f
InvoiceDao_008 = select ISNULL(sum(invoiceCollectDetail.InvoiceTotalMoney),0) as allInvoiceTotalMoney,ISNULL(sum(invoiceCollectDetail.InvoiceQuantity), 0) as allInvoiceQuantity from T_InvoiceCollectDetailRel  invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail on invoiceCollectDetailRel.DetailID = invoiceCollectDetail.ID where invoiceCollectDetailRel.Status = 1 and invoiceCollectDetailRel.RelationID = \u003f
InvoiceDao_009 = UPDATE T_InvoiceCollectDetailRel SET Status = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() WHERE ID = \u003f
InvoiceDao_010 = SELECT frim.FirmID,frim.FirmName,invoiceCollectDetailRel.ID as invoiceCollectDetailRelID,invoiceCollectDetailRel.RelationID,invoiceCollectDetailRel.Status,invoiceCollectDetail.* FROM T_InvoiceCollectDetailRel invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail ON invoiceCollectDetail.ID = invoiceCollectDetailRel.DetailID LEFT JOIN T_Order orders ON orders.OrderId = invoiceCollectDetailRel.RelationID LEFT JOIN C_Firm frim ON frim.FirmID = orders.SellFirmId where invoiceCollectDetailRel.RelationID =  \u003f
InvoiceDao_011 = SELECT * FROM ( SELECT tmp.*, ( ISNULL( tmp.TotalQuantity - tmp.allInvoiceQuantity, 0 )) AS surplusQuantity, ISNULL( tmp.deliveryTakenQuantity * tmp.price, 0 ) AS signAmount FROM ( SELECT sellFirm.FirmName AS sellFirmName, tradeTemplat.TradeTmptName AS tradeTmptName, invoiceNoTemp.invoiceNoStr, orders.*, ( SELECT ISNULL( SUM (delivery.TakenQuantity), 0 ) FROM T_Delivery delivery WHERE delivery.OrderID = orders.OrderId AND delivery.DeliveryStatus != 70 ) AS deliveryTakenQuantity, ( SELECT ISNULL( SUM ( invoiceCollectDetail.InvoiceTotalMoney ), 0 ) AS allInvoiceTotalMoney FROM T_InvoiceCollectDetailRel invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail ON invoiceCollectDetailRel.DetailID = invoiceCollectDetail.ID WHERE invoiceCollectDetailRel.Status = 1 AND invoiceCollectDetailRel.RelationID = orders.OrderId ) AS allInvoiceTotalMoney, ISNULL( deliveryFreightFeeTemp.ShouldPaySellPenalty, 0 ) AS sellShouldPaySellPenaltyTotal, ISNULL( deliveryFreightFeeTemp.paidSellFreight, 0 ) AS sellPaidSellFreightTotal, ISNULL( deliveryFreightFeeTemp.OverloadFreight, 0 ) AS sellOverloadFreight, ( SELECT ISNULL( SUM ( delDistributionDetail.SmallFee ), 0 ) AS sellSmallFee FROM T_DelDistributionDetail delDistributionDetail LEFT JOIN T_Delivery delivery ON delivery.DeliveryID = delDistributionDetail.DeliveryID AND delivery.DeliveryStatus != 75 WHERE delivery.OrderID = orders.OrderId ) AS sellSmallFee, ( SELECT COUNT (1) FROM T_InvoiceCollectDetailRel invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail ON invoiceCollectDetailRel.DetailID = invoiceCollectDetail.ID WHERE invoiceCollectDetailRel.RelationID = orders.OrderId ) AS invoiceCount, CAST ( crmCat.CategoryName AS VARCHAR ) + '-' + CAST (crmBr.BrandName AS VARCHAR) AS goodName, ( SELECT ISNULL(SUM(b.InvoiceQuantity), 0) AS allInvoiceQuantity FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.ID WHERE a.Status = 1 AND a.RelationID = orders.OrderId ) AS allInvoiceQuantity, ( SELECT TOP 1 b.CollectDate FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.ID WHERE a.Status = 1 AND a.RelationID = orders.OrderId ORDER BY b.CollectDate DESC ) AS invoiceCollectDate FROM T_Order orders LEFT JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID LEFT JOIN ( SELECT a.RelationID, STUFF(( SELECT ',' + subTitle.InvoiceNo FROM ( SELECT DISTINCT a.RelationID, b.InvoiceNo FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.Id AND a.Status = 1 ) subTitle WHERE subTitle.RelationID = a.RelationID FOR XML PATH ('')), 1, 1, '' ) AS invoiceNoStr FROM ( SELECT DISTINCT a.RelationID, b.InvoiceNo FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.Id WHERE a.Status = 1 ) a GROUP BY a.RelationID ) invoiceNoTemp ON invoiceNoTemp.RelationID = orders.OrderId LEFT JOIN T_TradeTemplate tradeTemplat ON tradeTemplat.TradeTmptId = orders.TradeTmptId LEFT JOIN ( SELECT deliveryFreightFee.OrderID, SUM ( ISNULL( deliveryFreightFee.ShouldPaySellPenalty, 0 )) AS ShouldPaySellPenalty, SUM ( ISNULL( deliveryFreightFee.PaidSellFreight, 0 )) AS PaidSellFreight, SUM ( ISNULL( deliveryFreightFee.OverloadFreight, 0 )) AS OverloadFreight FROM T_DeliveryFreightFee deliveryFreightFee WHERE deliveryFreightFee.DISABLED = 0 GROUP BY deliveryFreightFee.OrderID ) deliveryFreightFeeTemp ON deliveryFreightFeeTemp.OrderID = orders.OrderId ) tmp WHERE 1 = 1 ) temp WHERE 1 = 1 and temp.TradeStatus != -1 
InvoiceDao_012 = select * from T_InvoiceCollectDetailRel where ID = \u003f
InvoiceDao_013 = select *  from 	(SELECT 		sellFirm.FirmName as sellFirmName,	tradeTemplat.TradeTmptName as tradeTmptName,	(ISNULL(orders.TotalQuantity - ISNULL(b.InvoiceQuantity,0),0)) as surplusQuantity,	orders.*,	b.CollectDate as InvoiceCollectDate,	(orders.Amount+isNull(deliveryFreightFeeTemp.paidSellFreight,0)+isnull(deliveryFreightFeeTemp.OverloadFreight,0)-isnull(orders.SellTakenTradeFee,0)) as ShouldInvoiceMoney,	ISNULL(b.InvoiceTotalMoney,0) as InvoiceTotalMoney,	ISNULL(b.InvoiceQuantity,0) as InvoiceQuantity,	b.InvoiceNo,b.Remark as InvoiceRemark,	(select ISNULL(sum(delivery.TakenQuantity), 0) from T_Delivery delivery  	where delivery.OrderID = orders.OrderId  and delivery.DeliveryStatus != 70) as deliveryTakenQuantity, CAST(crmCat.CategoryName AS VARCHAR) + '-' + CAST(crmBr.BrandName AS VARCHAR) AS goodName FROM 		T_Order orders 		LEFT JOIN T_InvoiceCollectDetailRel a ON a.RelationID = orders.OrderId 		LEFT JOIN T_InvoiceCollectDetail b ON b.ID = a.DetailID 		LEFT JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId 		LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID 		LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID 		LEFT JOIN T_TradeTemplate tradeTemplat ON tradeTemplat.TradeTmptId = orders.TradeTmptId		LEFT JOIN ( SELECT 			deliveryFreightFee.OrderID, 			SUM ( ISNULL( deliveryFreightFee.ShouldPaySellPenalty, 0 )) AS ShouldPaySellPenalty, 			SUM ( ISNULL( deliveryFreightFee.PaidSellFreight, 0 )) AS PaidSellFreight, 			SUM ( ISNULL( deliveryFreightFee.OverloadFreight, 0 )) AS OverloadFreight 			FROM T_DeliveryFreightFee deliveryFreightFee WHERE deliveryFreightFee.DISABLED = 0 GROUP BY deliveryFreightFee.OrderID ) deliveryFreightFeeTemp ON deliveryFreightFeeTemp.OrderID = orders.OrderId) tmp  where 1 = 1 and tmp.TradeStatus != -1
InvoiceDao_014 = update T_InvoiceApplyRel set DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME =GETDATE() where InvoiceApplyID = \u003f
InvoiceDao_015 = update T_InvoiceDetailRel set DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME =GETDATE() where ApplyRelID = \u003f
InvoiceDao_016 = select * from T_InvoiceApplyRel where InvoiceApplyID = \u003f
InvoiceDao_017 = SELECT * FROM (SELECT cf.FirmID,dbo.base64_utf8decode(firmInvoiceAddress.ContactTelNo) as collectTel,CAST(vwc1_1.FullName AS VARCHAR) + '-' +CAST(vwc2_2.FullName AS VARCHAR) + '-' +CAST(vwc3_3.FullName AS VARCHAR) +'-'+firmInvoiceAddress.Address AS collectInvoiceAddress,firmInvoiceAddress.ContactName as collectInvoicePeople  FROM C_Firm cf INNER JOIN C_FirmInvoice firmInvoice ON firmInvoice.FirmID = cf.FirmID AND firmInvoice.AddressType = 0 INNER JOIN C_Address firmInvoiceAddress ON firmInvoiceAddress.ID = firmInvoice.AddressID INNER JOIN VW_Canton vwc1_1  ON vwc1_1.ID = firmInvoiceAddress.AddPV INNER JOIN VW_Canton vwc2_2 ON vwc2_2.ID = firmInvoiceAddress.AddCT INNER JOIN VW_Canton vwc3_3  ON vwc3_3.ID = firmInvoiceAddress.AddDT ) temp   where 1=1 and temp.collectTel is NOT NULL and temp.collectInvoicePeople is NOT NULL  and temp.collectInvoiceAddress is NOT NULL and temp.FirmID =\u003f 
InvoiceDao_018 = update T_InvoiceApply set InvoiceTitle=\u003f,TaxNo=\u003f,BankAccount=\u003f,BankID=\u003f,BankName=\u003f,InvoiceAddress=\u003f,BranchName=\u003f,InvoiceTel=\u003f,CollectInvoiceAddress=\u003f,CollectTel=\u003f,CollectInvoicePeople=\u003f,TaxRate=\u003f,Remark=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where ID=\u003f
InvoiceDao_019 = SELECT * FROM ( SELECT t1.ID, t1.ApplyType, t1.InvoiceType, t1.InvoiceTitle, t1.TaxNo, t1.FirmId, t1.BankAccount, t1.BankID, t1.BankName, t1.InvoiceAddress, t1.InvoiceTel, t1.TaxRate, CASE WHEN t1.ApplyType = 10 OR t1.ApplyType = 5 THEN 0 ELSE t1.ApplyQuantity END AS ApplyQuantity, CASE WHEN t1.ApplyType = 10 OR t1.ApplyType = 5 THEN t1.ApplyPrice ELSE 0 END AS ApplyPrice, t1.ApplyMoney, t1.Remark, t1.ApplicantName, t1.ApplicantTime, t1.ApproveName, t1.ApproveTime, t1.ApplyStatus, t1.DISABLED, t1.REC_CREATEBY, t1.REC_CREATETIME, t1.REC_MODIFYBY, t1.REC_MODIFYTIME, t1.BranchName, t1.CollectInvoiceAddress, t1.CollectTel, t1.CollectInvoicePeople, t1.ApplyOrigin, t1.IsInvoiceOpen, t2.FirmName, t3.RelationID AS couponNumber, t3.RelationID AS deliveryID, t5.TrackingNo, t5.InvoiceNo, '\u670D\u52A1\u8D39' AS CategoryName, CASE WHEN LEN(t1.TaxNo) > 0 AND LEN(t1.BankAccount) > 0 AND LEN(t1.BankID) > 0 AND LEN(t1.BankName) > 0 AND LEN(t1.InvoiceAddress) > 0 AND LEN(t1.InvoiceTel) > 0 AND LEN(t1.CollectInvoiceAddress) > 0 AND LEN(t1.CollectTel) > 0 AND LEN(t1.BranchName) > 0 AND LEN(t1.CollectInvoicePeople) > 0 THEN 1 WHEN LEN(t1.TaxNo) = 0 OR t1.TaxNo IS NULL OR LEN(t1.BankAccount) > 0 OR t1.BankAccount IS NULL OR LEN(t1.BankID) > 0 OR t1.BankID IS NULL OR LEN(t1.BankName) > 0 OR t1.BankName IS NULL OR LEN(t1.InvoiceAddress) > 0 OR t1.InvoiceAddress IS NULL OR LEN(t1.InvoiceTel) > 0 OR t1.InvoiceTel IS NULL OR LEN(t1.CollectInvoiceAddress) > 0 OR t1.CollectInvoiceAddress IS NULL OR LEN(t1.CollectTel) > 0 OR t1.CollectTel IS NULL OR LEN(t1.BranchName) > 0 OR t1.BankName IS NULL OR LEN(t1.CollectInvoicePeople) > 0 OR t1.CollectInvoicePeople IS NULL THEN 2 END AS isFullDetailed FROM T_InvoiceApply t1 INNER JOIN C_Firm t2 ON t2.FirmID = t1.FirmId AND t1.ApplyType = 10 INNER JOIN T_InvoiceApplyRel t3 ON t3.InvoiceApplyID = t1.ID LEFT JOIN T_InvoiceDetailRel t4 ON t4.ApplyRelID = t3.ID LEFT JOIN T_InvoiceDetail t5 ON t5.ID = t4.InvoiceDetailID ) temp WHERE 1 = 1
InvoiceDao_020 = update T_InvoiceApply set CollectInvoiceAddress=\u003f,CollectTel=\u003f,BranchName=\u003f,CollectInvoicePeople=\u003f,InvoiceType=\u003f,InvoiceTitle=\u003f,TaxNo=\u003f,BankAccount=\u003f,BankID=\u003f,BankName=\u003f,InvoiceAddress=\u003f,InvoiceTel=\u003f,TaxRate=\u003f,Remark=\u003f,ApplicantName=\u003f,ApplyStatus=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=getDate()  where ID =\u003f
InvoiceDao_021 = update T_InvoiceApply set IsInvoiceOpen =\u003f,REC_MODIFYBY=\u003f, REC_MODIFYTIME=getDate() where ID =\u003f
InvoiceDao_022 = SELECT * FROM ( SELECT tmp.*, ( ISNULL( tmp.TotalQuantity - tmp.allInvoiceQuantity, 0 )) AS surplusQuantity, ISNULL( tmp.deliveryTakenQuantity * tmp.price, 0 ) AS signAmount FROM ( SELECT sellFirm.FirmName AS sellFirmName, tradeTemplat.TradeTmptName AS tradeTmptName, invoiceNoTemp.invoiceNoStr, orders.*, ( SELECT ISNULL( SUM (delivery.TakenQuantity), 0 ) FROM T_Delivery delivery WHERE delivery.OrderID = orders.OrderId AND delivery.DeliveryStatus != 70 ) AS deliveryTakenQuantity, ( SELECT ISNULL( SUM ( invoiceCollectDetail.InvoiceTotalMoney ), 0 ) AS allInvoiceTotalMoney FROM T_InvoiceCollectDetailRel invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail ON invoiceCollectDetailRel.DetailID = invoiceCollectDetail.ID WHERE invoiceCollectDetailRel.Status = 1 AND invoiceCollectDetailRel.RelationID = orders.OrderId ) AS allInvoiceTotalMoney, ISNULL( deliveryFreightFeeTemp.ShouldPaySellPenalty, 0 ) AS sellShouldPaySellPenaltyTotal, ISNULL( deliveryFreightFeeTemp.paidSellFreight, 0 ) AS sellPaidSellFreightTotal, ISNULL( deliveryFreightFeeTemp.OverloadFreight, 0 ) AS sellOverloadFreight, ( SELECT ISNULL( SUM ( delDistributionDetail.SmallFee ), 0 ) AS sellSmallFee FROM T_DelDistributionDetail delDistributionDetail LEFT JOIN T_Delivery delivery ON delivery.DeliveryID = delDistributionDetail.DeliveryID AND delivery.DeliveryStatus != 75 WHERE delivery.OrderID = orders.OrderId ) AS sellSmallFee, ( SELECT COUNT (1) FROM T_InvoiceCollectDetailRel invoiceCollectDetailRel LEFT JOIN T_InvoiceCollectDetail invoiceCollectDetail ON invoiceCollectDetailRel.DetailID = invoiceCollectDetail.ID WHERE invoiceCollectDetailRel.RelationID = orders.OrderId ) AS invoiceCount, CAST ( crmCat.CategoryName AS VARCHAR ) + '-' + CAST (crmBr.BrandName AS VARCHAR) AS goodName, ( SELECT ISNULL(SUM(b.InvoiceQuantity), 0) AS allInvoiceQuantity FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.ID WHERE a.Status = 1 AND a.RelationID = orders.OrderId ) AS allInvoiceQuantity, ( SELECT TOP 1 b.CollectDate FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.ID WHERE a.Status = 1 AND a.RelationID = orders.OrderId ORDER BY b.CollectDate DESC ) AS invoiceCollectDate FROM T_Order orders LEFT JOIN C_Firm sellFirm ON sellFirm.FirmID = orders.SellFirmId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = orders.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = orders.BrandID LEFT JOIN ( SELECT a.RelationID, STUFF(( SELECT ',' + subTitle.InvoiceNo FROM ( SELECT DISTINCT a.RelationID, b.InvoiceNo FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.Id AND a.Status = 1 ) subTitle WHERE subTitle.RelationID = a.RelationID FOR XML PATH ('')), 1, 1, '' ) AS invoiceNoStr FROM ( SELECT DISTINCT a.RelationID, b.InvoiceNo FROM T_InvoiceCollectDetailRel a LEFT JOIN T_InvoiceCollectDetail b ON a.DetailID = b.Id WHERE a.Status = 1 ) a GROUP BY a.RelationID ) invoiceNoTemp ON invoiceNoTemp.RelationID = orders.OrderId LEFT JOIN T_TradeTemplate tradeTemplat ON tradeTemplat.TradeTmptId = orders.TradeTmptId LEFT JOIN ( SELECT deliveryFreightFee.OrderID, SUM ( ISNULL( deliveryFreightFee.ShouldPaySellPenalty, 0 )) AS ShouldPaySellPenalty, SUM ( ISNULL( deliveryFreightFee.PaidSellFreight, 0 )) AS PaidSellFreight, SUM ( ISNULL( deliveryFreightFee.OverloadFreight, 0 )) AS OverloadFreight FROM T_DeliveryFreightFee deliveryFreightFee WHERE deliveryFreightFee.DISABLED = 0 GROUP BY deliveryFreightFee.OrderID ) deliveryFreightFeeTemp ON deliveryFreightFeeTemp.OrderID = orders.OrderId ) tmp WHERE 1 = 1 ) temp WHERE 1 = 1 and temp.OrderId = \u003f 
#\u5FAE\u4FE1Api
WeiXinApiDAO_001 = select * from C_WeiXinTemplate where WXCode = \u003f and disabled = \u003f
WeiXinApiDAO_002 = insert into C_WeiXinHistory (WXCode, ChannelType, WeiXinContent, ReceiveNumber, MsgStatus, ReturnMsg, DISABLED, REC_CREATEBY, REC_MODIFYBY) VALUES(\u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f, \u003f)
WeiXinApiDAO_003 = select * from C_WeiXin_KeyWord where KeyWord = \u003f and Status = \u003f
#\u5F00\u7968\u3001\u6536\u7968\u4FE1\u606F#
#FinancialBillsDAO_001 = SELECT temp.* from (SELECT temp.*, ISNULL(temp.ApplyStatus, 0) as financialBillsType from (SELECT tin.ApplyStatus, td.REC_MODIFYTIME, td.DeliveryStatus as deliveryStatus, td.OverloadFee as overloadFee,td.DeliveryWeight, cfd.TaxNo as taxNo, td.DeliveryID, tod.OrderId, cf.firmID, cf.firmName, 1 as applyType, CAST(cs.CategoryName AS VARCHAR) + '-' + CAST(cb.BrandName AS VARCHAR) AS goodName, tod.Price, td.DeliveryQuantity * tod.TradeUnitNumber as deliveryQuantity, td.TakenQuantity as takenQuantity, td.DeliveryQuantity * tod.TradeUnitNumber * tod.Price as deliveryQuantityMoney, 0.00 as commissionCharge, td.TakenQuantity * tod.Price as takenQuantityMoney, [dbo] .base64_utf8decode(cfv.VatBkAccount) vatBkAccount, cfv.VatBkBranch as vatBkBranch, vwb.BankID, vwb.BankName as VatBankName, dbo.base64_utf8decode(cad.ContactTelNo) as invoiceTel, CAST(vwc1.FullName AS VARCHAR) + '-' + CAST(vwc2.FullName AS VARCHAR) + '-' + CAST(vwc3.FullName AS VARCHAR)+ '-' + CAST(cad.Address AS VARCHAR) AS VatBankAddressPlus,cad.Address AS VatBankAddress,td.DeliveryType as  deliveryType ,td.IsInvoiceOpenFee as isInvoiceOpenFee,td.IsInvoiceOpenAmout as isInvoiceOpenAmout,tod.TradeDate as tradeDate from T_Delivery td INNER JOIN T_Order tod ON tod.OrderId = td.OrderID INNER JOIN C_Firm cf ON cf.FirmID = tod.BuyFirmId INNER JOIN T_Leads lead ON tod.LeadsID = lead.ID INNER join VW_Crm_CategorySpecial cs on cs.ID = lead.CategoryLeafID INNER join VW_Crm_Brand cb on cb.ID = lead.BrandID LEFT JOIN C_FirmVATInfo cfv ON cfv.FirmID = cf.FirmID LEFT JOIN VW_Bank vwb ON vwb.BankID = cfv.VatBankID LEFT JOIN C_Address cad ON cad.ID = cfv.VatAddressID LEFT JOIN VW_Canton vwc1 ON vwc1.ID = cad.AddPV LEFT JOIN VW_Canton vwc2 ON vwc2.ID = cad.AddCT LEFT JOIN VW_Canton vwc3 ON vwc3.ID = cad.AddDT LEFT JOIN C_FirmDetail cfd ON cf.FirmID = cfd.FirmID Left join (select a.ApplyStatus, a.ID, b.RelationID from T_InvoiceApply a inner join T_InvoiceApplyRel b on a.id = b.InvoiceApplyID where a.DISABLED = 0 and b.DISABLED = 0 and a.ApplyType = 1) tin on td.DeliveryID = tin.RelationID where td.DISABLED = 0 and td.DeliveryStatus != 70  and td.DeliveryQuantity !=0 UNION ALL SELECT tin.ApplyStatus, td.REC_MODIFYTIME, td.DeliveryStatus as deliveryStatus, td.OverloadFee as overloadFee,td.DeliveryWeight, cfd.TaxNo as taxNo, td.DeliveryID, tod.OrderId, cf.firmID, cf.firmName, 5 as applyType, CAST(cs.CategoryName AS VARCHAR) + '-' + CAST(cb.BrandName AS VARCHAR) AS goodName, tod.Price, td.DeliveryQuantity * tod.TradeUnitNumber as deliveryQuantity, td.TakenQuantity as takenQuantity, 0.00 as deliveryQuantityMoney, td.TakenBSFee as commissionCharge, CASE WHEN td.DeliveryQuantity = 0 THEN 0 else td.TakenQuantity * td.TakenBSFee / (td.DeliveryQuantity * tod.TradeUnitNumber) END as takenQuantityMoney, [dbo] .base64_utf8decode(cfv.VatBkAccount) vatBkAccount, cfv.VatBkBranch as vatBkBranch, vwb.BankID, vwb.BankName as VatBankName, dbo.base64_utf8decode(cad.ContactTelNo) as invoiceTel, CAST(vwc1.FullName AS VARCHAR) + '-' + CAST(vwc2.FullName AS VARCHAR) + '-' + CAST(vwc3.FullName AS VARCHAR)+ '-' + CAST(cad.Address AS VARCHAR) AS VatBankAddressPlus ,cad.Address AS VatBankAddress,td.DeliveryType as  deliveryType,td.IsInvoiceOpenFee as isInvoiceOpenFee,td.IsInvoiceOpenAmout as isInvoiceOpenAmout,tod.TradeDate as tradeDate   from T_Delivery td INNER JOIN T_Order tod ON tod.OrderId = td.OrderID INNER JOIN C_Firm cf  ON cf.FirmID = tod.BuyFirmId INNER JOIN T_Leads lead  ON tod.LeadsID = lead.ID INNER join VW_Crm_CategorySpecial cs  on cs.ID = lead.CategoryLeafID INNER join VW_Crm_Brand cb  on cb.ID = lead.BrandID LEFT JOIN C_FirmVATInfo cfv ON cfv.FirmID = cf.FirmID LEFT JOIN VW_Bank vwb ON vwb.BankID = cfv.VatBankID LEFT JOIN C_Address cad ON cad.ID = cfv.VatAddressID LEFT JOIN VW_Canton vwc1 ON vwc1.ID = cad.AddPV LEFT JOIN VW_Canton vwc2 ON vwc2.ID = cad.AddCT LEFT JOIN VW_Canton vwc3 ON vwc3.ID = cad.AddDT LEFT JOIN C_FirmDetail cfd ON cf.FirmID = cfd.FirmID Left join (select a.ApplyStatus, a.ID, b.RelationID  from T_InvoiceApply a inner join T_InvoiceApplyRel b on a.id = b.InvoiceApplyID where a.DISABLED = 0 and b.DISABLED = 0 and a.ApplyType = 5) tin on td.DeliveryID = tin.RelationID where td.DISABLED = 0 and td.DeliveryStatus != 70  and  td.TakenBSFee !=0) temp) temp  
FinancialBillsDAO_001 = SELECT * FROM ( SELECT temp.REC_MODIFYTIME, temp.DeliveryStatus AS deliveryStatus, temp.OverloadFee AS overloadFee, temp.DeliveryWeight, temp.DeliveryID, temp.TakenQuantity AS takenQuantity, temp.DeliveryType, temp.IsInvoiceOpenFee, temp.IsInvoiceOpenAmout, temp.TakenBSFee, temp.applyType, temp.ApplyStatus, temp.DeliveryQuantityTemp * tod.TradeUnitNumber AS deliveryQuantity, CASE temp.applyType WHEN 1 THEN temp.takenQuantity * tod.Price ELSE 0.00 END AS deliveryQuantityMoney, CASE temp.applyType WHEN 5 THEN temp.TakenBSFee ELSE 0.00 END AS commissionCharge, temp.TakenQuantity * tod.Price AS takenQuantityMoney, cfd.TaxNo AS taxNo, tod.OrderId, cf.firmID, cf.firmName, CAST (cs.CategoryName AS VARCHAR) + '-' + CAST (cb.BrandName AS VARCHAR) AS goodName, tod.Price, [dbo].base64_utf8decode (cfv.VatBkAccount) vatBkAccount, cfv.VatBkBranch AS vatBkBranch, vwb.BankID, vwb.BankName AS VatBankName, dbo.base64_utf8decode (cad.ContactTelNo) AS invoiceTel, CAST (vwc1.FullName AS VARCHAR) + '-' + CAST (vwc2.FullName AS VARCHAR) + '-' + CAST (vwc3.FullName AS VARCHAR) + '-' + CAST (cad.Address AS VARCHAR) AS VatBankAddressPlus, cad.Address AS VatBankAddress, tod.TradeDate AS tradeDate, ISNULL(temp.ApplyStatus, 0) AS financialBillsType FROM ( SELECT td.OrderID, td.REC_MODIFYTIME, td.DeliveryStatus AS deliveryStatus, td.OverloadFee AS overloadFee, td.DeliveryWeight, td.DeliveryID, td.TakenQuantity AS takenQuantity, td.DeliveryQuantity AS DeliveryQuantityTemp, td.DeliveryType, td.IsInvoiceOpenFee, td.IsInvoiceOpenAmout, td.TakenBSFee, 1 AS applyType, tin.ApplyStatus FROM T_Delivery td LEFT JOIN ( SELECT a.ApplyStatus, a.ID, b.RelationID FROM T_InvoiceApply a INNER JOIN T_InvoiceApplyRel b ON a.id = b.InvoiceApplyID WHERE a.DISABLED = 0 AND b.DISABLED = 0 AND a.ApplyType = 1 ) tin ON td.DeliveryID = tin.RelationID WHERE td.DISABLED = 0 AND td.DeliveryStatus != 70 AND td.DeliveryQuantity != 0 UNION ALL SELECT td.OrderID, td.REC_MODIFYTIME, td.DeliveryStatus AS deliveryStatus, td.OverloadFee AS overloadFee, td.DeliveryWeight, td.DeliveryID, td.TakenQuantity AS takenQuantity, td.DeliveryQuantity AS DeliveryQuantityTemp, td.DeliveryType, td.IsInvoiceOpenFee, td.IsInvoiceOpenAmout, td.TakenBSFee, 5 AS applyType, tin.ApplyStatus FROM T_Delivery td LEFT JOIN ( SELECT a.ApplyStatus, a.ID, b.RelationID FROM T_InvoiceApply a INNER JOIN T_InvoiceApplyRel b ON a.id = b.InvoiceApplyID WHERE a.DISABLED = 0 AND b.DISABLED = 0 AND a.ApplyType = 5 ) tin ON td.DeliveryID = tin.RelationID WHERE td.DISABLED = 0 AND td.DeliveryStatus != 70 AND td.TakenBSFee != 0 ) temp INNER JOIN T_Order tod ON tod.OrderId = temp.OrderID INNER JOIN C_Firm cf ON cf.FirmID = tod.BuyFirmId INNER JOIN T_Leads lead ON tod.LeadsID = lead.ID INNER JOIN VW_Crm_CategorySpecial cs ON cs.ID = tod.CategoryLeafID INNER JOIN VW_Crm_Brand cb ON cb.ID \= tod.BrandID LEFT JOIN C_FirmVATInfo cfv ON cfv.FirmID = cf.FirmID LEFT JOIN VW_Bank vwb ON vwb.BankID = cfv.VatBankID LEFT JOIN C_Address cad ON cad.ID = cfv.VatAddressID LEFT JOIN VW_Canton vwc1 ON vwc1.ID = cad.AddPV LEFT JOIN VW_Canton vwc2 ON vwc2.ID = cad.AddCT LEFT JOIN VW_Canton vwc3 ON vwc3.ID = cad.AddDT LEFT JOIN C_FirmDetail cfd ON cf.FirmID = cfd.FirmID ) temp
FinancialBillsDAO_002 = insert into T_InvoiceApply(CollectInvoiceAddress,CollectTel,BranchName,CollectInvoicePeople,ApplyType,InvoiceType,InvoiceTitle,TaxNo,FirmId,BankAccount,BankID,BankName,InvoiceAddress,InvoiceTel,TaxRate,ApplyQuantity,ApplyPrice,ApplyMoney,Remark,ApplicantName,ApplicantTime,ApplyStatus,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,ApplyOrigin)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,\u003f,\u003f,getDate(),\u003f,getDate(),\u003f)
FinancialBillsDAO_003 = insert into T_InvoiceApplyRel(InvoiceApplyID,RelationID,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,getDate(),\u003f,getDate())
FinancialBillsDAO_004 = SELECT count(*) FROM T_InvoiceApplyRel tin1 INNER JOIN T_InvoiceApply tin2 ON tin1.InvoiceApplyID = tin2.ID WHERE tin1.RelationID = \u003f AND tin2.applyType = \u003f and tin1.DISABLED = 0;
FinancialBillsDAO_005 = SELECT cf.FirmID,cf.FirmName,cfv.VatBankID,cfd.TaxNo as taxNo,dbo.base64_utf8decode(cfv.VatBkAccount) as bankAccount,CAST(vwc1.FullName AS VARCHAR)+'-'+CAST(vwc2.FullName  AS VARCHAR)+'-'+CAST(vwc3.FullName AS VARCHAR) AS invoiceAddress from C_Firm cf LEFT JOIN C_FirmVATInfo cfv ON cfv.FirmID = cf.FirmID LEFT JOIN C_FirmDetail cfd ON cfd.FirmID = cf.FirmID LEFT JOIN VW_Bank vwb ON vwb.BankID = cfv.VatBankID LEFT JOIN C_Address cad ON cad.ID = cfv.VatAddressID LEFT JOIN VW_Canton vwc1 ON vwc1.ID = cad.AddPV LEFT JOIN VW_Canton vwc2 ON vwc2.ID = cad.AddCT LEFT JOIN VW_Canton vwc3 ON vwc3.ID = cad.AddDT where cf.FirmID=\u003f
#FinancialBillsDAO_006 = SELECT * from(SELECT tin.*,td.DeliveryWeight as deliveryWeight,cf.FirmName as firmName, od.OrderId as orderId,od.TradeDate,tina.RelationID as deliveryID,tind.InvoiceNo,crmCat.CategoryName,crmBr.BrandName,tind.TrackingNo from T_InvoiceApply tin INNER  JOIN C_Firm  cf ON tin.FirmId =cf.FirmID INNER JOIN T_InvoiceApplyRel tina ON tin.ID = tina.InvoiceApplyID and tina.DISABLED = 0 INNER JOIN T_Delivery td ON tina.RelationID = td.DeliveryID  INNER JOIN T_Order od ON  td.OrderID = od.OrderId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN T_InvoiceApplyRel tinar ON tin.ID = tinar.InvoiceApplyID and tinar.DISABLED =0 LEFT JOIN T_InvoiceDetailRel tindr ON tinar.ID = tindr.ApplyRelID and tindr.DISABLED = 0 LEFT JOIN T_InvoiceDetail tind ON tindr.InvoiceDetailID = tind.ID and tind.DISABLED =0 WHERE 1=1 and tin.ApplyMoney !=0 )temp where 1=1
FinancialBillsDAO_006 = SELECT * FROM ( SELECT tin.ApplicantTime, tin.ApplyStatus, tin.ApplyType, tin.ID, tin.InvoiceType, tin.InvoiceTitle, tin.TaxNo, tin.BankAccount, tin.BankID, tin.BankName, tin.InvoiceAddress, tin.InvoiceTel, tin.TaxRate, CASE WHEN tin.ApplyType = 10 OR tin.ApplyType = 5 THEN tin.ApplyQuantity ELSE tin.ApplyQuantity END AS ApplyQuantity, CASE WHEN tin.ApplyType = 10 OR tin.ApplyType = 5 THEN 0 ELSE tin.ApplyPrice END AS ApplyPrice, tin.applyMoney, tin.remark, tin.BranchName, tin.CollectInvoiceAddress, tin.CollectTel, tin.CollectInvoicePeople, td.DeliveryWeight AS deliveryWeight, cf.FirmName AS firmName, cf.FirmID AS firmId, od.OrderId AS orderId, od.XSSFNumber,TradeDate, tina.RelationID AS deliveryID, temp2.InvoiceNo, CASE WHEN tin.ApplyType = 5 OR tin.ApplyType = 10 THEN '\u670D\u52A1\u8D39' ELSE crmCat.CategoryName END AS CategoryName, CASE WHEN tin.ApplyType = 5 OR tin.ApplyType = 10 THEN '' ELSE '\u5428' END AS goodUnit, crmBr.BrandName, ISNULL(crmSPlace.Name, '') AS SourcePlaceName, temp2.TrackingNo FROM T_InvoiceApply tin INNER JOIN C_Firm cf ON tin.FirmId = cf.FirmID INNER JOIN T_InvoiceApplyRel tina ON tin.ID = tina.InvoiceApplyID AND tina.DISABLED = 0 INNER JOIN T_Delivery td ON tina.RelationID = td.DeliveryID INNER JOIN T_Order od ON td.OrderID = od.OrderId LEFT JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID LEFT JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID LEFT JOIN VW_Crm_SourcePlace crmSPlace ON crmSPlace.ID = od.SourcePlaceID LEFT JOIN ( SELECT a.ID, a.TrackingNo, STUFF(( SELECT ',' + CONVERT (VARCHAR(1000), subTitle.InvoiceNo) FROM ( SELECT apply.ID, detail.TrackingNo, detail.InvoiceNo FROM T_InvoiceApply apply INNER JOIN T_InvoiceApplyRel arel ON arel.InvoiceApplyID = apply.ID LEFT JOIN T_InvoiceDetailRel rel ON rel.ApplyRelID = arel.ID INNER JOIN T_InvoiceDetail detail ON detail.ID = rel.InvoiceDetailID ) subTitle WHERE subTitle.ID = a.ID FOR XML PATH ('')), 1, 1, '' ) AS InvoiceNo FROM ( SELECT apply.ID, detail.TrackingNo, detail.InvoiceNo FROM T_InvoiceApply apply INNER JOIN T_InvoiceApplyRel arel ON arel.InvoiceApplyID = apply.ID LEFT JOIN T_InvoiceDetailRel rel ON rel.ApplyRelID = arel.ID INNER JOIN T_InvoiceDetail detail ON detail.ID = rel.InvoiceDetailID ) a WHERE 1 = 1 GROUP BY a.ID, a.TrackingNo ) temp2 ON temp2.ID = tin.ID WHERE 1 = 1 AND tin.ApplyMoney != 0 AND tin.ApplyStatus != 0 ) temp WHERE 1 = 1
FinancialBillsDAO_007 = UPDATE T_InvoiceApply set ApplyStatus = \u003f where ID =\u003f 
FinancialBillsDAO_008 = INSERT INTO T_InvoiceDetail(InvoiceType,InvoiceNo,InvoiceDate,InvoiceTitle,TaxNo,BankName,BankAccount,InvoiceAddress,InvoiceTel,InvoiceContent,InvoiceQuantity,InvoicePrice,TaxRate,InvoiceMoney,InvoiceTax,InvoiceTotalMoney,TrackingNo,Remark,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,GETDATE(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
FinancialBillsDAO_009 = INSERT INTO T_InvoiceDetailRel(InvoiceDetailID,ApplyRelID,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE()) 
#\u7269\u6D41\u914D\u9001\u76F8\u5173#
LogisticsRateDao_001 = insert into T_LogisticsTemplate(LogisticsID,TemplateBigName,TemplateName,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
LogisticsRateDao_002 = insert into T_LogisticsTemplateCategory(TemplateID,CategoryLeafID,BrandID,SourcePlaceID,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
LogisticsRateDao_003 = SELECT vw1.ID as tagID,vw1.Name as text FROM VW_Crm_SourcePlace  vw1 INNER JOIN VW_Crm_Source_Brand_Relation vw2 ON vw1.ID = vw2.SourcePlaceID INNER JOIN VW_Crm_Brand vw3 ON vw2.BrandID = vw3.ID  WHERE vw3.ID =\u003f and vw2.DISABLED = 0
LogisticsRateDao_004 = select * from(SELECT t1.*,t2.TemplateBigName,t2.TemplateName,t3.Name as sourcePlaceName, CAST(cs.CategoryName AS VARCHAR)+'-'+CAST(cb.BrandName  AS VARCHAR) AS goodName FROM T_LogisticsTemplateCategory t1 INNER JOIN T_LogisticsTemplate t2 ON t1.TemplateID = t2.ID INNER join VW_Crm_CategorySpecial cs on cs.ID= t1.CategoryLeafID INNER join VW_Crm_Brand cb on cb.ID= t1.BrandID INNER JOIN VW_Crm_SourcePlace t3 ON t3.ID = t1.SourcePlaceID )temp where 1=1
LogisticsRateDao_005 = update T_LogisticsTemplateCategory set TemplateID =\u003f,CategoryLeafID=\u003f,BrandID=\u003f,SourcePlaceID=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where TemplateID =\u003f and CategoryLeafID=\u003f and BrandID=\u003f and SourcePlaceID=\u003f
LogisticsRateDao_006 = insert into T_LogisticsArea(LogisticsID,AreaNo,Name,ParentID,AreaLevel,Sort,IsLeaf,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
LogisticsRateDao_007 = update T_LogisticsArea set Path =\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME =GETDATE() where ID =\u003f
LogisticsRateDao_008 = select * from T_LogisticsArea where ParentID =\u003f and AreaLevel=\u003f and Name=\u003f
LogisticsRateDao_009 = update T_LogisticsArea set Path =\u003f,AreaNo=\u003f,Name=\u003f,ParentID=\u003f,AreaLevel=\u003f,Sort=\u003f,IsLeaf=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME =GETDATE() where  ID =\u003f
LogisticsRateDao_010 = SELECT * from(SELECT t1.*,t2.Name as provinceArea,t2.ID as provinceAreaID,t3.Name as provinceName,t3.ID as provinceID FROM T_LogisticsArea t1 INNER JOIN T_LogisticsArea t2 ON t1.ParentID = t2.ID INNER JOIN T_LogisticsArea t3 ON t2.ParentID = t3.ID) temp where 1=1
LogisticsRateDao_011 = insert into T_LogisticsTemplatePrice(TemplateID,EndAreaID,EndAreaName,MinWeight,MaxWeight,Price,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
LogisticsRateDao_012 = update T_LogisticsTemplatePrice set TemplateID=\u003f,EndAreaID=\u003f,EndAreaName=\u003f,MinWeight=\u003f,MaxWeight=\u003f,Price=\u003f,DISABLED=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where ID =\u003f 
LogisticsRateDao_013 = SELECT * from(SELECT t3.ID as sequenceNum,t1.*,t4.Path,CAST(cs.CategoryName AS VARCHAR)+'-'+CAST(cb.BrandName  AS VARCHAR) AS goodName,t2.TemplateBigName,t2.TemplateName,t3.EndAreaName,t4.AreaNo as endAreaNo,t3.Price,t5.Name as sourcePlaceName FROM T_LogisticsTemplateCategory t1 INNER JOIN T_LogisticsTemplate t2 ON t1.TemplateID = t2.ID INNER JOIN T_LogisticsTemplatePrice t3 ON t3.TemplateID = t2.ID INNER JOIN T_LogisticsArea t4 ON t4.ID = t3.EndAreaID INNER join VW_Crm_CategorySpecial cs on cs.ID= t1.CategoryLeafID INNER join VW_Crm_Brand cb on cb.ID= t1.BrandID INNER JOIN VW_Crm_SourcePlace t5 ON t5.ID = t1.SourcePlaceID )temp where 1=1
LogisticsRateDao_014 = select * from T_LogisticsArea where ParentID =\u003f and AreaLevel=\u003f and AreaNo=\u003f
LogisticsRateDao_015 = select * from T_LogisticsArea where AreaNo=\u003f and Name=\u003f
LogisticsRateDao_016 = select * from T_LogisticsTemplate where TemplateBigName =\u003f  and TemplateName =\u003f 
LogisticsRateDao_017 = select * from T_LogisticsArea where  AreaLevel=\u003f and AreaNo=\u003f
#\u4EA4\u6536\u914D\u9001#
DistributionDao_001 = insert into T_DelDistributionDetail(DeliveryID,DISABLED,LogisticsLeafID,LogiisticsName,AddressDetail,ContactTel,ContactName,ContactMobile,FreightFee,SmallFee,Remark,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
DistributionDao_002 = insert into T_DeliveryFreightFee(DISABLED,REC_CREATEBY,REC_MODIFYBY,OrderID,DeliveryID,BuyShouldPayFreight,BuyPaidFreight,ShouldPaySellPenalty,PaidSellFreight,REC_CREATETIME,REC_MODIFYTIME)VALUES(\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),GETDATE())
DistributionDao_003 = update T_DelDistributionDetail set LogisticsLeafID=\u003f,LogiisticsName=\u003f,AddressDetail=\u003f,ContactTel=\u003f,ContactName=\u003f,ContactMobile=\u003f,FreightFee=\u003f,Remark=\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID =\u003f
DistributionDao_004 = update T_DeliveryFreightFee set BuyShouldPayFreight =\u003f,REC_MODIFYBY=\u003f,REC_MODIFYTIME=GETDATE() where DeliveryID =\u003f
DistributionDao_005 = SELECT od.OrderId as orderId,tl.SourcePlaceID as sourcePlaceID,od.MinQuantity,crmCat.CategoryName as CategoryLeaf,crmCat.ID as categoryLeafID,crmBr.BrandName as Brand,crmBr.ID as brandID,td.DeliveryQuantity as totalDeliveryQuantity,tl.ID as leadsID, od.TradeUnitNumber as tradeUnitNumber FROM T_Order od INNER JOIN T_Delivery td ON td.OrderID = od.OrderId INNER JOIN VW_Crm_Brand crmBr ON crmBr.ID = od.BrandID INNER JOIN VW_Crm_CategorySpecial crmCat ON crmCat.ID = od.CategoryLeafID INNER JOIN T_Leads tl ON tl.ID = od.LeadsID where td.DeliveryID=\u003f
#\u4ED3\u5E93\u5730\u5740\u4EA4\u6613\u573A\u5173\u7CFB\u8868
WHAddrTemplateRlspDao_001 = insert into T_WHAddrTemplateRlsp(WareHouseAddressID,WareHouseID,TradeTmptId,DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,0,\u003f,GETDATE(),\u003f,GETDATE())
WHAddrTemplateRlspDao_002 = update T_WHAddrTemplateRlsp set WareHouseAddressID = \u003f,WareHouseID = \u003f,TradeTmptId = \u003f,DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where Id = \u003f
WHAddrTemplateRlspDao_003 = SELECT * FROM ( SELECT template.TradeTmptName, wh.CompanyName AS wareHouseCompanyName, wh.WareHouseFN, wha.DeliveryPlaceId AS deliveryPlaceId, dp.Name AS deliveryPlaceName, wha.AddPV, wha.AddCT, wha.AddDT, wha.WHAddress AS whAddress, canton_1.ShortName AS AddPVName, canton_2.ShortName AS AddCTName, canton_3.ShortName AS AddDTName, CAST (canton_1.ShortName AS VARCHAR) + CAST (canton_2.ShortName AS VARCHAR) + CAST (canton_3.ShortName AS VARCHAR) + CAST (wha.WHAddress AS VARCHAR) AS wareHouseAddressName, rlsp.*,whg.WHGroupName,whg.ID  as whGroupID FROM T_WHAddrTemplateRlsp rlsp LEFT JOIN T_WareHouseAddress wha ON wha.Id \= rlsp.WareHouseAddressID AND wha.DISABLED \= 0 LEFT JOIN T_WareHouseGroup whg ON wha.WHGroupID \= whg.Id AND whg.DISABLED = 0 LEFT JOIN VW_Canton canton_1 ON canton_1.ID = wha.AddPV LEFT JOIN VW_Canton canton_2 ON canton_2.ID = wha.AddCT LEFT JOIN VW_Canton canton_3 ON canton_3.ID = wha.AddDT LEFT JOIN VW_Crm_DeliveryPlace dp ON dp.ID = wha.DeliveryPlaceId LEFT JOIN T_WareHouse wh ON wh.Id = rlsp.WareHouseID LEFT JOIN T_TradeTemplate template ON template.TradeTmptId = rlsp.TradeTmptId ) temp WHERE 1 = 1 AND temp.DISABLED = 0
WHAddrTemplateRlspDao_004 = select * from (select template.TradeTmptName,wh.CompanyName as wareHouseCompanyName,wh.WareHouseFN,wha.DeliveryPlaceId as deliveryPlaceId,dp.Name as deliveryPlaceName,wha.AddPV,wha.AddCT,wha.AddDT,wha.WHAddress as whAddress,canton_1.ShortName as AddPVName,canton_2.ShortName as AddCTName,canton_3.ShortName as AddDTName,CAST(canton_1.ShortName AS VARCHAR) + CAST(canton_2.ShortName AS VARCHAR)+CAST(canton_3.ShortName AS VARCHAR)+CAST(wha.WHAddress AS VARCHAR) as wareHouseAddressName,rlsp.* from T_WHAddrTemplateRlsp rlsp LEFT JOIN T_WareHouseAddress wha ON wha.Id = rlsp.WareHouseAddressID LEFT JOIN VW_Canton canton_1 ON canton_1.ID = wha.AddPV LEFT JOIN VW_Canton canton_2 ON canton_2.ID = wha.AddCT LEFT JOIN VW_Canton canton_3 ON canton_3.ID = wha.AddDT LEFT JOIN VW_Crm_DeliveryPlace dp ON dp.ID = wha.DeliveryPlaceId LEFT JOIN T_WareHouse wh ON wh.Id = rlsp.WareHouseID LEFT JOIN T_TradeTemplate template ON template.TradeTmptId = rlsp.TradeTmptId) temp where 1=1 and temp.DISABLED = 0 and temp.Id =\u003f 
WHAddrTemplateRlspDao_005 = update T_WHAddrTemplateRlsp set DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where  WareHouseAddressID = \u003f and WareHouseID = \u003f and TradeTmptId = \u003f and DISABLED = \u003f 
WHAddrTemplateRlspDao_006 = update T_WHAddrTemplateRlsp set DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where  WareHouseAddressID = \u003f and TradeTmptId = \u003f and DISABLED = \u003f
WHAddrTemplateRlspDao_007 = select wha.*, dp.Name as deliveryPlaceName,canton_1.ShortName as addPVName,canton_2.ShortName as addCTName,canton_3.ShortName as addDTName from T_WareHouseAddress wha LEFT JOIN VW_Crm_DeliveryPlace dp ON dp.ID = wha.DeliveryPlaceId LEFT JOIN VW_Canton canton_1 ON canton_1.ID = wha.AddPV LEFT JOIN VW_Canton canton_2 ON canton_2.ID = wha.AddCT LEFT JOIN VW_Canton canton_3 ON canton_3.ID = wha.AddDT where 1=1
WHAddrTemplateRlspDao_008 = select wareHouse.* from T_WareHouse  wareHouse where 1=1
WHAddrTemplateRlspDao_009 = update T_WHAddrTemplateRlsp set DISABLED = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where Id = \u003f
WHAddrTemplateRlspDao_010=select * from T_WareHouseGroup temp where temp.DISABLED \= 0
KPI_001=select  isnull(sum(o.TotalQuantity),0) as TotalQuantity,isnull(sum(o.Amount),0) as sumAmount,count(o.OrderId) as sumNumber from HJOnline.dbo.T_Order o where o.[DISABLED]=0 and o.TradeStatus>=0
KPI_00101=SELECT CASE WHEN t1.TradeTmptName = '\u73B0\u8D27\u5546\u57CE' THEN '\u73B0\u8D27' WHEN t1.TradeTmptName = '\u8FDC\u671F\u5546\u57CE' THEN '\u9884\u552E' WHEN t1.TradeTmptName = '\u4E2D\u77F3\u5316' THEN '\u4E2D\u77F3\u5316\u914D\u9001' END AS tradeTmptName, SUM (t.TotalQuantity) AS TotalQuantity, SUM (t.Amount) AS sumAmount , count (t.OrderId) AS sumNumber FROM HJOnline.dbo.T_Order t INNER JOIN HJOnline.dbo.T_TradeTemplate t1 ON t.TradeTmptId = t1.TradeTmptId WHERE t.[DISABLED]=0 and t.TradeStatus >= 0 GROUP BY t1.TradeTmptName
KPI_002=select  isnull(sum(o.TotalQuantity),0) as TotalQuantity,isnull(sum(o.Amount),0) as sumAmount,count(o.OrderId) as sumNumber from HJOnline.dbo.T_Order o where o.[DISABLED]=0 and o.TradeStatus>=0 and DATEDIFF(DAY,o.TradeDate,getdate())=0;
KPI_00201=SELECT CASE WHEN t1.TradeTmptName = '\u73B0\u8D27\u5546\u57CE' THEN '\u73B0\u8D27' WHEN t1.TradeTmptName = '\u8FDC\u671F\u5546\u57CE' THEN '\u9884\u552E' WHEN t1.TradeTmptName = '\u4E2D\u77F3\u5316' THEN '\u4E2D\u77F3\u5316\u914D\u9001' END AS tradeTmptName, SUM (t.TotalQuantity) AS TotalQuantity, SUM (t.Amount) AS sumAmount , count (t.OrderId) AS sumNumber FROM HJOnline.dbo.T_Order t INNER JOIN HJOnline.dbo.T_TradeTemplate t1 ON t.TradeTmptId = t1.TradeTmptId WHERE t.TradeStatus >= 0 AND DATEDIFF(DAY, t.TradeDate, getdate()) = 0 GROUP BY t1.TradeTmptName
KPI_003=select case when ts.TradeStatus=1  then 'WaitBuyerPay' when ts.TradeStatus=5  then 'BuyerPayed' when ts.TradeStatus=10 then 'Delivering' when ts.TradeStatus=15 then 'BidToSeller' when ts.TradeStatus=20 then 'ReceiverUploaded' when ts.TradeStatus=25 then 'DeliveryConfirmed' when ts.TradeStatus=30 then 'WaitRiskConfirm' when ts.TradeStatus=35 then 'RiskDenied' when ts.TradeStatus=40 then 'WaitSellerConfirm' when ts.TradeStatus=45 then 'MoreOrLess' when ts.TradeStatus=50 then 'Finished' when ts.TradeStatus=55 then 'BuyerBreak' when ts.TradeStatus=60 then 'SellerBreak' end as TradeStatus, count(*) as numbers from HJOnline.dbo.T_Order ts where ts.[DISABLED]=0 and ts.TradeStatus>0 and DATEDIFF(DAY,ts.TradeDate,getdate())=0 group by TradeStatus
KPI_004=select case when t1.TradeAuthority=0 then 'SellerTrader' when t1.TradeAuthority=1 then 'BuyerTrader' when t1.TradeAuthority=2 then 'BothTrader' end as TradeAuthority, count(*) as numbers from HJOnline.dbo.C_Firm t1 inner join HJOnline.dbo.C_FirmApp t2 on t1.FirmID=t2.FirmID where t1.[DISABLED]=0 and t2.[DISABLED]=0 and t1.FirmStatus=2 and t2.AppType=1 group by t1.TradeAuthority union select 'User',count(*) as numbers from HJOnline.dbo.C_User t1 inner join HJOnline.dbo.C_UserApp t2 on t1.UserCode=t2.UserCode where t1.[DISABLED]=0 and t2.[DISABLED]=0 and t1.UserAvailable=0 and t2.AppType=1
KPI_00401=select t1.FirmId as FirmID, t1.FirmName as FirmName, t1.REC_CREATETIME as createTime from HJOnline.dbo.C_Firm t1 inner join HJOnline.dbo.C_FirmApp t2 on t1.FirmID=t2.FirmID where t1.[DISABLED]=0 and t2.[DISABLED]=0 and t1.FirmStatus=2 and t2.AppType=1 and t1.TradeAuthority=0 order by t1.REC_CREATETIME desc
KPI_005=select case when t1.TradeAuthority=0 then 'SellerTrader' when t1.TradeAuthority=1 then 'BuyerTrader' when t1.TradeAuthority=2 then 'BothTrader' end as TradeAuthority, count(*) as numbers from HJOnline.dbo.C_Firm t1 inner join HJOnline.dbo.C_FirmApp t2 on t1.FirmID=t2.FirmID where t1.[DISABLED]=0 and t2.[DISABLED]=0 and t1.FirmStatus=2 and t2.AppType=1 and DATEDIFF(DAY,t1.REC_CREATETIME,getdate())=0 group by t1.TradeAuthority union select 'User',count(*) as numbers from HJOnline.dbo.C_User t1 inner join HJOnline.dbo.C_UserApp t2 on t1.UserCode=t2.UserCode where t1.[DISABLED]=0 and t2.[DISABLED]=0 and t1.UserAvailable=0 and t2.AppType=1 and DATEDIFF(DAY,t1.REC_CREATETIME,getdate())=0
KPI_00501=SELECT CASE WHEN t1.TradeAuthority = 0 THEN 'SellerTrader' WHEN t1.TradeAuthority = 1 THEN 'BuyerTrader' WHEN t1.TradeAuthority = 2 THEN 'BothTrader' END AS TradeAuthority, COUNT (*) AS numbers, CONVERT ( CHAR (10), t1.REC_CREATETIME, 120 ) AS date FROM HJOnline.dbo.C_Firm t1 INNER JOIN HJOnline.dbo.C_FirmApp t2 ON t1.FirmID = t2.FirmID WHERE t1.[DISABLED] = 0 AND t2.[DISABLED] = 0 AND t1.FirmStatus = 2 AND t2.AppType = 1 AND DATEDIFF( DAY, t1.REC_CREATETIME, getdate()) < \u003f GROUP BY t1.TradeAuthority, CONVERT ( CHAR (10), t1.REC_CREATETIME, 120 ) UNION SELECT 'User', COUNT (*) AS numbers , CONVERT ( CHAR (10), t1.REC_CREATETIME, 120 ) AS date FROM HJOnline.dbo.C_User t1 INNER JOIN HJOnline.dbo.C_UserApp t2 ON t1.UserCode = t2.UserCode WHERE t1.[DISABLED] = 0 AND t2.[DISABLED] = 0 AND t1.UserAvailable = 0 AND t2.AppType = 1 AND DATEDIFF( DAY, t1.REC_CREATETIME, getdate()) < \u003f GROUP BY CONVERT ( CHAR (10), t1.REC_CREATETIME, 120 ) order by CONVERT ( CHAR (10), t1.REC_CREATETIME, 120 )
KPI_00601=select c.FirmID,c.FirmName,'deal' as reason from (select t.BuyFirmId as firmID from HJOnline.dbo.T_Order t where t.[DISABLED]=0 and t.TradeStatus>=5 and DATEDIFF(MONTH,t.TradeDate,getdate())=0 group by t.BuyFirmId union select t.SellFirmId as firmID from HJOnline.dbo.T_Order t where t.[DISABLED]=0 and t.TradeStatus>=5 and DATEDIFF(MONTH,t.TradeDate,getdate())=0 group by t.SellFirmId ) ts inner join HJOnline.dbo.C_Firm c on ts.firmID=c.FirmID and c.[DISABLED]=0 inner join HJOnline.dbo.C_FirmApp d on ts.firmID=d.FirmID and d.AppType=1 and d.[DISABLED]=0  
KPI_00602=select c.FirmID,c.FirmName,'request' as reason from (select t.FirmId from HJOnline.dbo.T_Enquiry t where t.[DISABLED]=0 and DATEDIFF(MONTH,t.REC_CREATETIME,getdate())=0 group by t.FirmId) ts inner join HJOnline.dbo.C_Firm c on ts.firmID=c.FirmID and c.[DISABLED]=0 inner join HJOnline.dbo.C_FirmApp d on ts.firmID=d.FirmID and d.AppType=1 and d.[DISABLED]=0
KPI_00603=select c.FirmID,c.FirmName,'login' as reason from (select t2.FirmID from (select UserID,count(*) as loginTimes from HJOnline.dbo.C_UserHistory t where t.ActionType=0 and DATEDIFF(MONTH,t.LoginTime,getdate())=0 group by UserID) t1 inner join HJOnline.dbo.C_Trader t2 on t1.UserID=t2.UserCode where t2.[DISABLED]=0 and t1.loginTimes>10 group by t2.FirmID) ts inner join HJOnline.dbo.C_Firm c on ts.firmID=c.FirmID and c.[DISABLED]=0 inner join HJOnline.dbo.C_FirmApp d on ts.firmID=d.FirmID and d.AppType=1 and d.[DISABLED]=0
KPI_007=select  convert(char(10),o.TradeDate,120) as date,isnull(sum(o.TotalQuantity),0) as TotalQuantity,isnull(sum(o.Amount),0) as sumAmount,count(o.OrderId) as sumNumber from HJOnline.dbo.T_Order o where o.[DISABLED]=0 and o.TradeStatus>=0 and DATEDIFF(DAY,o.TradeDate,getdate()) < \u003f and DATEDIFF(DAY,o.TradeDate,getdate()) >= 0 group by convert(char(10),o.TradeDate,120) order by convert(char(10),o.TradeDate,120)
#KPI_008=select  isnull(sum(o.TotalQuantity),0) as totalQuantity from HJOnline.dbo.T_Order o where o.[DISABLED]=0 and o.TradeStatus>=0 and o.TradeStatus<>55 and o.TradeStatus<>60 and DATEPART(yyyy, o.TradeDate) = \u003f and DATEPART(mm,o.TradeDate) =\u003f
KPI_008=select  isnull(sum(o.TotalQuantity),0) as totalQuantity from HJOnline.dbo.T_Order o where o.[DISABLED]=0 and o.TradeStatus>=5 and o.TradeStatus<>55 and o.TradeStatus<>60 and DATEDIFF(MONTH,o.TradeDate,getdate())=0
KPI_009=SELECT COUNT (*) AS buyFirmNums FROM ( SELECT t.BuyFirmId FROM HJOnline.dbo.T_Order t WHERE t.TradeStatus >= 5 AND DATEDIFF( MONTH, t.TradeDate, getdate()) = 0 GROUP BY t.BuyFirmId ) z
KPI_010=SELECT COUNT (*) AS rptBuyFirmNums FROM ( SELECT f.BuyFirmId FROM ( SELECT t.BuyFirmId, ROW_NUMBER () OVER ( partition BY t.BuyFirmId ORDER BY tradedate DESC ) AS nums FROM HJOnline.dbo.T_Order t WHERE t.TradeStatus >= 5 AND DATEDIFF( MONTH, t.TradeDate, getdate()) = 0 ) f WHERE nums > 1 GROUP BY f.BuyFirmId ) z
KPI_011=SELECT Convert(decimal(10,2) ,COUNT (EnquiryId) * 1.0 / \u003f) AS avgEnquiryNums FROM HJOnline.dbo.T_Enquiry t WHERE EnquiryStatus > 0 AND DATEPART(yyyy, t.REC_CREATETIME) = \u003f AND DATEPART(mm,t.REC_CREATETIME) =\u003f
KPI_012=select TargetType, TargetMoney as TargetValue from T_DingMonthDealTarget where DISABLED = 0 and ChannelType = \u003f and Year = \u003f and Month = \u003f and TargetType in (1,2,3,4,5,6)
#KPI_020=(select replace(t2.name,'\u5B58\u6B3E') as bankName, to_char( t1.createtime,'yyyy-mm-dd') as createtime, sum(t1.Amount) as inMoneyAmount,count(t1.Amount) as inMoneyCount from gl_admin.f_fundflow t1 inner join gl_admin.f_account t2 on t1.commodityid=t2.code where t1.oprcode in ('103') group by t2.name ,to_char( t1.createtime,'yyyy-mm-dd') ) union select replace(t2.name,'\u5B58\u6B3E') as bankName,  to_char( t1.createtime,'yyyy-mm-dd') as createtime, sum(t1.Amount) as inMoneyAmount,count(t1.Amount) as inMoneyCount from gl_admin.f_h_fundflow t1 inner join gl_admin.f_account t2 on t1.commodityid=t2.code where t1.oprcode in ('103') and ROUND(TO_NUMBER(sysdate - t1.createtime))<7 group by t2.name ,to_char( t1.createtime,'yyyy-mm-dd') order by createtime
KPI_020=select replace(t3.bankName,'\u5B58\u6B3E') as bankName, sum(t3.inMoneyAmount) as inMoneyAmount,count(t3.inMoneyAmount) as inMoneyCount   from ((select t2.name as bankName, t1.Amount as inMoneyAmount from gl_admin.f_fundflow t1 inner join gl_admin.f_account t2 on t1.commodityid=t2.code where t1.oprcode in ('103') ) union all select t2.name as bankName, t1.Amount as inMoneyAmount from gl_admin.f_h_fundflow t1 inner join gl_admin.f_account t2 on t1.commodityid=t2.code where t1.oprcode in ('103') and to_char(t1.createtime,'yyyymmdd') >= '20161010') t3 group by t3.bankName
KPI_021=select tbl2.bankname as bankName, tbl1.counts as openCounts from (select t1.bankid, count(t1.firmid) as counts from gl_admin.F_B_firmidandaccount t1  where t1.isopen = 1 group by t1.bankid) tbl1 inner join gl_admin.F_B_banks  tbl2 on tbl1.bankid = tbl2.bankid
#select count(firmid) inMoneyFirmNums from (select a.firmid as firmid from gl_admin.m_firm a inner join (select firmid from gl_admin.f_h_fundflow t1 where t1.oprcode in ('101','103')  and to_char(t1.createtime,'yyyymm')=to_char(sysdate,'yyyymm') group by firmid) b on a.firmid=b.firmid where a.status='N' union select a.firmid as firmid from gl_admin.m_firm a inner join ( select firmid from gl_admin.f_fundflow t1 where t1.oprcode in ('101','103') and to_char(t1.createtime,'yyyy-mm-dd')=to_char(sysdate,'yyyy-mm-dd') group by firmid) b on a.firmid=b.firmid where a.status='N')
KPI_022=select c.ShortName as pvName, count(1) as whNums from T_WareHouse wh,T_WareHouseAddress wha,VW_Canton c where  wh.WHAddressID = wha.Id and  wha.AddPV = c.ID and  wh.DISABLED = 0 group by c.ShortName order by whNums desc
KPI_023=select ca.DeliveryType as deliveryType, count(ID) as caNums from T_CargoAgent ca group by ca.DeliveryType
Market_001=SELECT gh.TraderID, gh.ID AS quizHistoryId, gh.Status AS quizHistoryStatus, gh.QuizActivity_ID AS quizActivityID, qa.Status AS quizActivityStatus, qa.QuizDate AS quizDate, gh.QuizPrice, qa.Category, qa.ContractName, qa.ContractPrice, (gh.QuizPrice - qa.ContractPrice) AS floatValue, CASE WHEN (gh.QuizPrice - qa.ContractPrice) < 0 THEN - (gh.QuizPrice - qa.ContractPrice) ELSE (gh.QuizPrice - qa.ContractPrice) END AS floatValueTemp FROM F_QuizHistory gh INNER JOIN F_QuizActivity qa ON qa.ID = gh.QuizActivity_ID WHERE gh.SourceFrom = 1 AND gh.DISABLED = 0 AND CONVERT (CHAR(10), qa.QuizDate, 120) = \u003f AND (gh.QuizPrice <= qa.ContractPrice + \u003f AND gh.QuizPrice >= qa.ContractPrice - \u003f) ORDER BY floatValueTemp ASC, quizDate ASC
Market_002=insert into F_QuizWinningResult(DISABLED,QuizHistoryID,MoneyTerm,Bonus,QuizDate) VALUES(\u003f,\u003f,\u003f,\u003f,\u003f)
Market_003=SELECT * from F_QuizMoneyPool
Market_004=insert into F_QuizMoney(MoneyTerm,Money,QuizDate,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
Market_005=SELECT * from F_QuizMoney where CONVERT ( CHAR (10), QuizDate, 120 ) = \u003f
Market_006=insert into F_QuizMoneyPool(PoolMoney,MoneyTerm,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME) VALUES(\u003f,\u003f,\u003f,GETDATE(),\u003f,GETDATE())
Market_007=update F_QuizMoney set Money = Money + \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where MoneyTerm = \u003f and  CONVERT(CHAR (10), QuizDate, 120) = \u003f
Market_008=SELECT * from F_QuizMoney where CONVERT ( CHAR (10), QuizDate, 120 ) = \u003f and MoneyTerm = \u003f
Market_009=SELECT * from F_QuizActivity where CONVERT ( CHAR (10), QuizDate, 120 ) = \u003f and Status = 5
Market_010=update F_QuizMoneyPool set PoolMoney= PoolMoney +  \u003f where MoneyTerm = \u003f
Market_011=update F_QuizHistory set Status = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getDate()  where Status = 0 and SourceFrom = 1 
Market_012=select count(1) as counts from F_QuizHistory where  CONVERT ( CHAR (10), REC_CREATETIME, 120 ) = \u003f
Market_013=SELECT top 1 qm.QuizDate FROM F_QuizActivity qm where qm.QuizDate > \u003f GROUP BY  qm.QuizDate ORDER BY qm.QuizDate asc
Market_014=SELECT top 1 qm.QuizDate FROM F_QuizMoney qm where qm.QuizDate > \u003f  GROUP BY  qm.QuizDate ORDER BY qm.QuizDate asc
Market_015=update F_QuizActivity set Answer = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE() where  CONVERT(VARCHAR(10), QuizDate, 120) = \u003f 
Market_016=SELECT TOP 1 * FROM F_QuizActivity where  DISABLED = 0 and CONVERT (varchar (10), QuizDate, 120 ) = \u003f
Market_017=insert into F_QuizHistory (DISABLED,REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,TraderID,TraderName,Mobile,QuizPrice,Status,QuizActivity_ID,SourceFrom) VALUES (\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,\u003f)
#\u4FDD\u5355\u76F8\u5173
InsurancePolicyDao_001=INSERT INTO F_Insurance_Policy_Price (DISABLED, REC_CREATEBY, REC_CREATETIME, REC_MODIFYBY, REC_MODIFYTIME, PolicyDate, CategoryName, CategoryType, SettlementPrice,AverageDeltaPrice,Status) VALUES (\u003f, \u003f, GETDATE(), \u003f, GETDATE(), \u003f, \u003f, \u003f, \u003f,\u003f,\u003f)
InsurancePolicyDao_002=SELECT * FROM ( SELECT DISTINCT ipp.PolicyDate, ipp.REC_MODIFYBY AS rec_modifyby, ipp.Status, (SELECT TOP 1 fipp.REC_MODIFYTIME FROM F_Insurance_Policy_Price fipp WHERE fipp.DISABLED = 0 AND CONVERT(VARCHAR(10), fipp.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120)) AS rec_modifytime, STUFF((SELECT ',' + A.CategoryName FROM F_Insurance_Policy_Price A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120) FOR XML PATH('')), 1, 1, '') AS CategoryNameStr, STUFF((SELECT ',' + CONVERT(VARCHAR(10), A.CategoryType) FROM F_Insurance_Policy_Price A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120) FOR XML PATH('')), 1, 1, '') AS CategoryTypeStr, STUFF((SELECT ',' + CONVERT(VARCHAR(100), A.SettlementPrice) FROM F_Insurance_Policy_Price A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120) FOR XML PATH('')), 1, 1, '') AS SettlementPriceStr FROM F_Insurance_Policy_Price ipp WHERE ipp.DISABLED = 0 GROUP BY ipp.PolicyDate, ipp.REC_MODIFYBY, ipp.Status ) temp WHERE 1 = 1
InsurancePolicyDao_003=SELECT * FROM ( SELECT DISTINCT ipp.PolicyDate, ipp.REC_MODIFYBY AS rec_modifyby, ipp.Status, (SELECT TOP 1 fipp.REC_MODIFYTIME FROM F_Insurance_Policy_Price fipp WHERE fipp.DISABLED = 0 AND CONVERT(VARCHAR(10), fipp.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120)) AS rec_modifytime, STUFF((SELECT ',' + A.CategoryName FROM F_Insurance_Policy_Price A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120) FOR XML PATH('')), 1, 1, '') AS CategoryNameStr, STUFF((SELECT ',' + CONVERT(VARCHAR(10), A.CategoryType) FROM F_Insurance_Policy_Price A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120) FOR XML PATH('')), 1, 1, '') AS CategoryTypeStr, STUFF((SELECT ',' + CONVERT(VARCHAR(100), A.SettlementPrice) FROM F_Insurance_Policy_Price A WHERE A.DISABLED = 0 AND CONVERT(VARCHAR(10), A.PolicyDate, 120) = CONVERT(VARCHAR(10), ipp.PolicyDate, 120) FOR XML PATH('')), 1, 1, '') AS SettlementPriceStr FROM F_Insurance_Policy_Price ipp WHERE ipp.DISABLED = 0 GROUP BY ipp.PolicyDate, ipp.REC_MODIFYBY, ipp.Status ) temp WHERE 1 = 1 and CONVERT(VARCHAR(10), temp.PolicyDate, 120) = \u003f 
InsurancePolicyDao_004=update F_Insurance_Policy_Price set REC_MODIFYBY = \u003f,REC_MODIFYTIME =  GETDATE(),SettlementPrice = \u003f,AverageDeltaPrice = \u003f,Status = \u003f where DISABLED = 0 and CONVERT(VARCHAR(10), PolicyDate, 120) = \u003f and CategoryType = \u003f 
InsurancePolicyDao_005=SELECT top 1 iip.PolicyDate FROM F_Insurance_Policy_Price iip where CONVERT(VARCHAR(10), iip.PolicyDate, 120) < CONVERT(VARCHAR(10), \u003f, 120) GROUP BY  iip.PolicyDate  order by iip.PolicyDate DESC
InsurancePolicyDao_006=SELECT * FROM F_Insurance_Policy_Price iip where CONVERT(VARCHAR(10), iip.PolicyDate, 120) =  CONVERT(VARCHAR(10), \u003f, 120) and DISABLED = 0
InsurancePolicyDao_007 = SELECT * FROM F_Insurance_Policy_Price WHERE DISABLED = 0 and convert(varchar(10),PolicyDate,120) IN (\u003f)
InsurancePolicyDao_008=update F_Insurance_Policy set Status = \u003f,REC_MODIFYTIME = GETDATE(),REC_MODIFYBY = \u003f WHERE DISABLED = 0 and CONVERT(VARCHAR(10), PolicyDate, 120) = \u003f and  FirmType = \u003f and CategoryType = \u003f and Status = \u003f
InsurancePolicyDao_009=select * from F_Insurance_Policy_Type where DISABLED = 0
InsurancePolicyDao_010=update F_Insurance_Policy_Price SET DISABLED = \u003f,REC_MODIFYTIME = GETDATE(),REC_MODIFYBY =  \u003f  where CONVERT(VARCHAR(10), PolicyDate, 120) = \u003f
InsurancePolicyDao_011=delete from F_Insurance_Policy_Price where CONVERT(VARCHAR(10), PolicyDate, 120) =  \u003f
InsurancePolicyDao_012=select * from F_Insurance_Back where DISABLED = 0 and ID = \u003f
InsurancePolicyDao_013=update F_Insurance_Back set REC_MODIFYBY = \u003f,REC_MODIFYTIME = GETDATE(), RealBackAmount = \u003f,Reviewer = \u003f,AuditTime = GETDATE(),Status = \u003f where DISABLED = 0 and ID = \u003f and Status = \u003f
InsurancePolicyDao_014=select * from F_Insurance_Policy where DISABLED = 0 and ID = \u003f
InsurancePolicyDao_015=select * from F_Insurance_Policy where DISABLED = 0 and CONVERT(VARCHAR(10), PolicyDate, 120) = \u003f and CategoryType = \u003f
InsurancePolicyDao_016=select * from F_Insurance_Policy_Type where DISABLED = 0 and ID = \u003f
InsurancePolicyDao_017=update F_Insurance_Policy set Status = \u003f,REC_MODIFYBY = \u003f,REC_MODIFYTIME = getdate()  where DISABLED = 0 and ID = \u003f
InsurancePolicyDao_00101=SELECT * FROM ( SELECT c.DeliveryID,b.OrderId,b.TradeDate,a.ID as PolicyId,a.FirmID,a.FirmType,a.Status as  PolicyStatus,e.FirmName,d.TypeName,f.AverageDeltaPrice,c.TakenQuantity,b.Price,a.PaidAmount,g.ShouldBackAmount,g.RealBackAmount,d.Premium,d.DeltaPrice,BackStatus=(case when(g.Status is null) then 0 when(g.Status=1) then 5 when (g.Status=5) then 10 else 0 end),g.Applicant,g.ApplicationTime,g.ID as backId,g.remarks FROM F_Insurance_Policy a	INNER JOIN T_Order b on a.ObjectID=b.OrderId	INNER JOIN T_Delivery c on b.OrderId=c.OrderID	LEFT JOIN F_Insurance_Policy_Type d on a.InsurancePolicyTypeID=d.ID LEFT JOIN C_Firm e on a.FirmID=e.FirmID	LEFT JOIN F_Insurance_Policy_Price f on (select top 1 PolicyDate from F_Insurance_Policy_Price where PolicyDate>a.PolicyDate order by PolicyDate asc)=f.PolicyDate and a.CategoryType=f.CategoryType	LEFT JOIN F_Insurance_Back g on a.ID=g.InsurancePolicyID and g.DeliveryID=c.DeliveryID where 1=1 and b.TradeStatus=50 and c.DeliveryStatus=55) as temp where 1=1
InsurancePolicyDao_00102=SELECT a.*,b.PayAmount,b.TypeName,b.Premium,b.DeltaPrice,b.DeltaPriceType,c.CategoryName,c.SettlementPrice,c.AverageDeltaPrice FROM F_Insurance_Policy a  INNER JOIN F_Insurance_Policy_Type b ON a.InsurancePolicyTypeID=b.ID INNER JOIN F_Insurance_Policy_Price c ON (select top 1 PolicyDate from F_Insurance_Policy_Price where PolicyDate>a.PolicyDate order by PolicyDate asc)=c.PolicyDate and a.CategoryType=c.CategoryType WHERE a.ID=\u003f
InsurancePolicyDao_00103=INSERT INTO F_Insurance_Back(REC_CREATEBY,REC_CREATETIME,REC_MODIFYBY,REC_MODIFYTIME,InsurancePolicyTypeID,InsurancePolicyID,PolicyDate,ShouldBackAmount,RealBackAmount,Applicant,ApplicationTime,DeliveryID,Remarks) VALUES(\u003f,GETDATE(),\u003f,GETDATE(),\u003f,\u003f,\u003f,\u003f,\u003f,\u003f,GETDATE(),\u003f,\u003f);
InsurancePolicyDao_00104 = SELECT * FROM F_Insurance_Policy WHERE DISABLED = 0 AND ObjectID = \u003f AND FirmType = \u003f AND Status = \u003f
InsurancePolicyDao_00105 = SELECT Back.* FROM F_Insurance_Back Back WHERE Back.DISABLED = 0 AND Back.DeliveryID = \u003f AND Back.InsurancePolicyID= \u003f AND Back.Status = \u003f 
InsurancePolicyDao_00106 = SELECT Back.* FROM F_Insurance_Back Back WHERE Back.DISABLED = 0 AND Back.InsurancePolicyID= \u003f AND Back.Status = \u003f 
InsurancePolicyDao_00107=update F_Insurance_Policy set PayStatus = \u003f,REC_MODIFYTIME = GETDATE(),REC_MODIFYBY = \u003f WHERE ID = \u003f 
InsurancePolicyDao_00108=SELECT Back.* FROM F_Insurance_Back Back WHERE Back.DISABLED = 0 AND Back.DeliveryID = \u003f